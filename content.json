{"meta":{"title":"Hexo","subtitle":"","description":"","author":"jia","url":"https://blog.jiascu.top","root":"/"},"pages":[{"title":"Repositories","date":"2022-03-04T02:51:09.450Z","updated":"2022-03-04T02:51:09.450Z","comments":false,"path":"repository/index.html","permalink":"https://blog.jiascu.top/repository/index.html","excerpt":"","text":""}],"posts":[{"title":"å¤šçº¿ç¨‹","slug":"å¤šçº¿ç¨‹","date":"2022-03-04T07:02:48.860Z","updated":"2022-03-04T07:03:25.026Z","comments":true,"path":"2022/03/04/å¤šçº¿ç¨‹/","link":"","permalink":"https://blog.jiascu.top/2022/03/04/%E5%A4%9A%E7%BA%BF%E7%A8%8B/","excerpt":"","text":"å¤šçº¿ç¨‹ç¬”è®°ï¼š ç‹‚ç¥è¯´Javaå¤šçº¿ç¨‹è¯¦è§£ - NotYourferry - åšå®¢å›­ (cnblogs.com) https://blog.csdn.net/weixin_44517301/article/details/121714319ï¼ˆè¡¥å……ï¼‰ æ ¸å¿ƒæ¦‚å¿µ çº¿ç¨‹åˆ›å»º ä¸‰ç§åˆ›å»ºæ–¹å¼ Thread ä¾‹ï¼š 12345678910111213141516171819202122232425public class TestThread1 extends Thread&#123; @Override public void run() &#123; //runæ–¹æ³•çº¿ç¨‹æ–¹æ³•ä½“ for (int i = 0; i &lt; 20; i++) &#123; System.out.println(&quot;æˆ‘åœ¨çœ‹ä»£ç ----&quot; + i); &#125; &#125; public static void main(String[] args) &#123; //åˆ›å»ºä¸€ä¸ªçº¿ç¨‹å¯¹è±¡ TestThread1 testThread = new TestThread1(); //startå¼€å¯çº¿ç¨‹ testThread.start(); //ä¸»çº¿ç¨‹ for (int i = 0; i &lt; 200; i++) &#123; System.out.println(&quot;æˆ‘åœ¨å­¦ä¹ å¤šçº¿ç¨‹-----&quot; + i); &#125; &#125;&#125; å®ç°Runnableï¼ˆæ¨èä½¿ç”¨ï¼ï¼ï¼ï¼‰å®ç°åŸç†ï¼šé™æ€ä»£ç† ä¾‹ï¼š 123456789101112131415161718192021222324public class TestRunable implements Runnable&#123; @Override public void run() &#123; //runæ–¹æ³•çº¿ç¨‹æ–¹æ³•ä½“ for (int i = 0; i &lt; 20; i++) &#123; System.out.println(&quot;æˆ‘åœ¨çœ‹ä»£ç ----&quot; + i); &#125; &#125; public static void main(String[] args) &#123; //åˆ›å»ºä¸€ä¸ªçº¿ç¨‹å¯¹è±¡ TestRunable testRunable = new TestRunable(); new Thread(testRunable).start(); //name1:çº¿ç¨‹åå­— new Thread(testRunable,&quot;name1&quot;).start(); //ä¸»çº¿ç¨‹ for (int i = 0; i &lt; 200; i++) &#123; System.out.println(&quot;æˆ‘åœ¨å­¦ä¹ å¤šçº¿ç¨‹-----&quot; + i); &#125; &#125;&#125; ä¸¤ç§æ–¹æ³•çš„æ¯”è¾ƒ ç»§æ‰¿ Thread ç±» å­ç±»ç»§æ‰¿ Thread ç±»å…·å¤‡å¤šçº¿ç¨‹èƒ½åŠ› å¯åŠ¨çº¿ç¨‹ï¼šå­ç±»å¯¹è±¡ .start() ä¸å»ºè®®ä½¿ç”¨ï¼šé¿å… OOP å•ç»§æ‰¿å±€é™æ€§ å®ç° Runnable æ¥å£ å®ç°æ¥å£ Runnable å…·æœ‰å¤šçº¿ç¨‹èƒ½åŠ› å¯åŠ¨çº¿ç¨‹ï¼šä¼ å…¥ç›®æ ‡å¯¹è±¡ + Threadå¯¹è±¡.start() æ¨èä½¿ç”¨ï¼šé¿å…å•ç»§æ‰¿å±€é™æ€§ï¼Œæ–¹ä¾¿åŒä¸€ä¸ªå¯¹è±¡è¢«å¤šä¸ªçº¿ç¨‹ä½¿ç”¨ã€‚ å®ç°Callableæ¥å£ï¼ˆäº†è§£å³å¯ï¼‰å®ç°Callableæ¥å£ï¼Œé‡å†™callæ–¹æ³•ã€‚ å®ç° Callable æ¥å£ï¼Œéœ€è¦è¿”å›å€¼ç±»å‹ é‡å†™ call æ–¹æ³•ï¼Œéœ€è¦æŠ›å‡ºå¼‚å¸¸ åˆ›å»ºç›®æ ‡å¯¹è±¡ åˆ›å»ºæ‰§è¡ŒæœåŠ¡ï¼šExecutorService &#x3D; Executor.newFixedThreadPool(1); æäº¤æ‰§è¡Œï¼šFuture result1 &#x3D; ser.submit(1); è·å–ç»“æœï¼šboolean r1 &#x3D; result.get() å…³é—­æœåŠ¡ï¼šser.shutdownNow() ä¾‹ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455public class TestCallable implements Callable&lt;Boolean&gt; &#123; private String url; //ç½‘ç»œå›¾ç‰‡åœ°å€ private String name; // ä¿å­˜çš„æ–‡ä»¶å public TestCallable(String url, String name) &#123; this.name = name; this.url = url; &#125; //ä¸‹è½½å›¾ç‰‡çº¿ç¨‹çš„æ‰§è¡Œä½“ @Override public Boolean call() &#123; WebDownloader webDownloader = new WebDownloader(); webDownloader.downloader(url, name); System.out.println(&quot;ä¸‹è½½äº†æ–‡ä»¶åä¸ºï¼š&quot; + name); return true; &#125; public static void main(String[] args) throws ExecutionException, InterruptedException &#123; TestCallable testThread1 = new TestCallable(&quot;https://img-blog.csdnimg.cn/20210531145950543.png&quot;, &quot;2.png&quot;); TestCallable testThread2 = new TestCallable(&quot;https://img-blog.csdnimg.cn/20210531145950543.png&quot;, &quot;3.png&quot;); TestCallable testThread3 = new TestCallable(&quot;https://img-blog.csdnimg.cn/20210531145950543.png&quot;, &quot;4.png&quot;); TestCallable testThread4 = new TestCallable(&quot;https://img-blog.csdnimg.cn/20210531145950543.png&quot;, &quot;5.png&quot;); //åˆ›å»ºæ‰§è¡ŒæœåŠ¡: ExecutorService service = Executors.newFixedThreadPool(4); //æäº¤æ‰§è¡Œ: Future&lt;Boolean&gt; r1 = service.submit(testThread1); Future&lt;Boolean&gt; r2 = service.submit(testThread2); Future&lt;Boolean&gt; r3 = service.submit(testThread3); Future&lt;Boolean&gt; r4 = service.submit(testThread4); // è·å–ç»“æœ: boolean rs1 = r1.get(); boolean rs2 = r2.get(); boolean rs3 = r3.get(); boolean rs4 = r4.get(); //å…³é—­æœåŠ¡: service.shutdownNow(); &#125; class WebDownloader &#123; //ä¸‹è½½æ–¹æ³• public void downloader(String url, String name) &#123; try &#123; FileUtils.copyURLToFile(new URL(url), new File(name)); &#125; catch (IOException e) &#123; e.printStackTrace(); System.out.println(&quot;IOå¼‚å¸¸ï¼Œdownleræ–¹æ³•å‡ºç°é—®é¢˜&quot;); &#125; &#125; &#125;&#125; Lambdaè¡¨è¾¾å¼Lambda è¡¨è¾¾å¼å±äºå‡½æ•°å¼ç¼–ç¨‹çš„æ¦‚å¿µ Î» å¸Œè…Šå­—æ¯è¡¨ä¸­æ’åºç¬¬åä¸€ä½çš„å­—æ¯ï¼Œè‹±è¯­åç§°ä¸º Lambda é¿å…åŒ¿åå†…éƒ¨ç±»å®šä¹‰è¿‡å¤š å…¶å®è´¨å±äºå‡½æ•°å¼ç¼–ç¨‹çš„æ¦‚å¿µ å»æ‰äº†ä¸€å †æ²¡æœ‰æ„ä¹‰çš„ä»£ç ,åªç•™ä¸‹æ ¸å¿ƒé€»è¾‘ å‡½æ•°å¼æ¥å£çš„å®šä¹‰ 1. ä»»ä½•æ¥å£ï¼Œå¦‚æœåªåŒ…å«å”¯ä¸€ä¸€ä¸ªæŠ½è±¡æ–¹æ³•ï¼Œé‚£ä¹ˆå®ƒå°±æ˜¯ä¸€ä¸ªå‡½æ•°å¼æ¥å£ã€‚ 123public interface Runnable&#123; public abstract void run();&#125; 2. å¯¹äºå‡½æ•°å¼æ¥å£ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡lambda è¡¨è¾¾å¼æ¥åˆ›å»ºè¯¥æ¥å£çš„å¯¹è±¡ã€‚ ä½¿ç”¨ 1234567891011121314151617181920212223242526272829303132333435//ä¾‹1//1.å®šä¹‰ä¸€ä¸ªå‡½æ•°å¼æ¥å£interface ILike1 &#123; void lambda1();&#125;//2.ç”¨lambdaç®€åŒ–ï¼Œ--&gt;å‡½æ•°å¼æ¥å£ILike1 like1 = ()-&gt;&#123; System.out.println(&quot;i like lambda1&quot;);&#125;;like1.lambda1();//ä¾‹2interface ILike2 &#123; void lambda2(int a,int b);&#125;//2.ç”¨lambdaç®€åŒ–ï¼Œ--&gt;å‡½æ•°å¼æ¥å£ILike2 like2 = (a,b)-&gt;&#123; System.out.println(&quot;i like lambda&quot; + a + b);&#125;;like2.lambda2(1,2);//ä¾‹3 æ¨¡æ‹ŸRunnableä½¿ç”¨Thread thread = new Thread(() -&gt; &#123; for (int i = 0; i &lt; 5; i++) &#123; try &#123; System.out.println(i); Thread.sleep(1000); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; &#125; System.out.println(&quot;////&quot;);&#125;);thread.start(); Lambdaè¡¨è¾¾å¼ç®€åŒ–(ç”±æ¥)ï¼š æ¥å£å®ç°ç±» é™æ€å†…éƒ¨ç±» å±€éƒ¨å†…éƒ¨ç±» åŒ¿åå†…éƒ¨ç±»,æ²¡æœ‰ç±»çš„åç§°,å¿…é¡»å€ŸåŠ©æ¥å£æˆ–è€…çˆ¶ç±» lambdaç®€åŒ– 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960public class TestLambda &#123; //3.é™æ€å†…éƒ¨ç±» static class Like2 implements ILike &#123; @Override public void lambda() &#123; System.out.println(&quot;I like Lambda2!&quot;); &#125; &#125; public static void main(String[] args) &#123; ILike like = new Like(); like.lambda(); Like2 like1 = new Like2(); like1.lambda(); //4.å±€éƒ¨å†…éƒ¨ç±» class Like3 implements ILike &#123; @Override public void lambda() &#123; System.out.println(&quot;I like Lambda3!&quot;); &#125; &#125; Like3 like3 = new Like3(); like3.lambda(); //5.åŒ¿åå†…éƒ¨ç±»,æ²¡æœ‰ç±»çš„åç§°,å¿…é¡»å€ŸåŠ©æ¥å£æˆ–è€…çˆ¶ç±» like = new ILike() &#123; @Override public void lambda() &#123; System.out.println(&quot;I like Lambda4!&quot;); &#125; &#125;; like.lambda(); //lambdaç®€åŒ– like = () -&gt; &#123; System.out.println(&quot;I like Lambda5!&quot;); &#125;; like.lambda(); &#125;&#125;//å®šä¹‰ä¸€ä¸ªå‡½æ•°å¼æ¥å£interface ILike &#123; void lambda();&#125;//å®ç°ç±»class Like implements ILike &#123; @Override public void lambda() &#123; System.out.println(&quot;I like Lambda!&quot;); &#125;&#125; çº¿ç¨‹çŠ¶æ€äº”å¤§çŠ¶æ€ï¼š åˆ›å»ºçŠ¶æ€ å°±ç»ªçŠ¶æ€ é˜»å¡çŠ¶æ€ è¿è¡ŒçŠ¶æ€ æ­»äº¡çŠ¶æ€ çº¿ç¨‹çš„ä¸€äº›å¸¸ç”¨æ–¹æ³• åœæ­¢çº¿ç¨‹çš„æ–¹å¼ ä¸æ¨èä½¿ç”¨ JDK æä¾›çš„ stop ()ã€destroy()æ–¹æ³•ã€‚ã€å·²å¼ƒç”¨ã€‘ æ¨èçº¿ç¨‹è‡ªå·±åœæ­¢ä¸‹æ¥ å»ºè®®ä½¿ç”¨ä¸€ä¸ªæ ‡å¿—ä½è¿›è¡Œç»ˆæ­¢å˜é‡ ï¼Œ å½“ flag &#x3D;&#x3D; falseï¼Œåˆ™ç»ˆæ­¢çº¿ç¨‹è¿è¡Œ æ–¹æ³•ï¼š å»ºè®®çº¿ç¨‹æ­£å¸¸åœæ­¢â€”-ã€‹åˆ©ç”¨æ¬¡æ•°ã€‚ä¸å»ºè®®æ­»å¾ªç¯ å»ºè®®ä½¿ç”¨æ ‡å¿—ä½â€”-ã€‹è®¾ç½®ä¸€ä¸ªæ ‡å¿—ä½ ä¸è¦ä½¿ç”¨stopæˆ–destory ç­‰è¿‡æ—¶æˆ–è€…JDK ä¸å»ºè®®ä½¿ç”¨çš„æ–¹æ³• æ¡ˆä¾‹ï¼š 1234567891011121314151617181920212223242526272829303132333435public class TestStop implements Runnable&#123; //1.è®¾ç½®ä¸€ä¸ªæ ‡å¿—ä½ private boolean flag = true; @Override public void run() &#123; int i = 0; while (flag) &#123; System.out.println(&quot;run...Thread-&gt;&quot; + i++); &#125; &#125; //2.è®¾ç½®ä¸€ä¸ªå…¬å¼€çš„æ–¹æ³•åœæ­¢çº¿ç¨‹ï¼Œè½¬æ¢æ ‡å¿—ä½ public void stop() &#123; this.flag = false; &#125; public static void main(String[] args) &#123; TestStop testStop = new TestStop(); //å¼€å¯çº¿ç¨‹ new Thread(testStop).start(); for (int i = 0; i &lt; 1000; i++) &#123; System.out.println(&quot;main&quot; + i); if (i == 900) &#123; //è°ƒç”¨stopæ–¹æ³•åˆ‡æ¢æ ‡å¿—ä½ï¼Œè®©çº¿ç¨‹åœæ­¢ testStop.stop(); System.out.println(&quot;è¯¥çº¿ç¨‹åœæ­¢äº†&quot;); &#125; &#125; &#125;&#125; çº¿ç¨‹ä¼‘çœ â€”â€”sleep() sleepï¼ˆæ—¶é—´ï¼‰æŒ‡å®šå½“å‰çº¿ç¨‹é˜»å¡çš„æ¯«ç§’æ•° sleep å­˜åœ¨å¼‚å¸¸ InterruptedException sleep æ—¶é—´è¾¾åˆ°åçº¿ç¨‹è¿›å…¥å°±ç»ªçŠ¶æ€ sleep å¯ä»¥æ¨¡æ‹Ÿç½‘ç»œå»¶æ—¶ï¼Œå€’è®¡æ—¶ç­‰ ï¼ˆæ•…æ„è®¾ç½®å»¶æ—¶æ”¶ä¼˜åŒ–é’±ğŸ’´ï¼Œä¸é“å¾·ï¼Œæ¯”å¦‚æŸç›˜ï¼‰ sleep æ¯ä¸€ä¸ªå¯¹è±¡éƒ½æœ‰ä¸€ä¸ªé”ï¼Œsleep ä¸ä¼šé‡Šæ”¾é” æ¡ˆä¾‹1ï¼š 123456789101112131415161718// æ¯ä¸€ç§’è·å–å½“å‰æ—¶é—´public class TestSleep2 &#123; public static void main(String[] args) &#123; //è·å–ç³»ç»Ÿå½“å‰æ—¶é—´ Date startTime = new Date(System.currentTimeMillis()); while (true) &#123; try &#123; Thread.sleep(1000); //æ›´æ–°ç³»ç»Ÿæ—¶é—´ System.out.println(new SimpleDateFormat(&quot;HH:mm:ss&quot;).format(startTime)); startTime = new Date(System.currentTimeMillis()); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; &#125; &#125;&#125; æ¡ˆä¾‹2 1234567891011121314151617181920212223242526272829//æ¨¡æ‹Ÿå»¶æ—¶:æ”¾å¤§é—®é¢˜çš„å‘ç”Ÿæ€§public class TestSleep implements Runnable &#123; //ç¥¨æ•° private int ticketNums = 10; @Override public void run() &#123; while (true) &#123; if (ticketNums &lt;= 0) &#123; break; &#125; //æ¨¡æ‹Ÿå»¶æ—¶ try &#123; Thread.sleep(200); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; System.out.println(Thread.currentThread().getName() + &quot;--&gt;æ‹¿åˆ°äº†ç¬¬&quot; + ticketNums-- + &quot;ç¥¨&quot;); &#125; &#125; public static void main(String[] args) &#123; TestSleep ticket = new TestSleep(); new Thread(ticket, &quot;å°æ˜&quot;).start(); new Thread(ticket, &quot;è€å¸ˆ&quot;).start(); new Thread(ticket, &quot;é»„ç‰›&quot;).start(); &#125;&#125; çº¿ç¨‹ç¤¼è®©â€”â€”yield() ç¤¼è®©çº¿ç¨‹ï¼Œè®©å½“å‰æ­£åœ¨æ‰§è¡Œçš„çº¿ç¨‹æš‚åœï¼Œä½†ä¸é˜»å¡ å°†çº¿ç¨‹ä»è¿è¡ŒçŠ¶æ€è½¬ä¸ºå°±ç»ªçŠ¶æ€ è®© CPU ä»æ–°è°ƒåº¦ï¼Œæœ‰å¯èƒ½è¿˜æ˜¯è°ƒåº¦è¯¥ç¤¼è®©çº¿ç¨‹ï¼Œç¤¼è®©ä¸ä¸€å®šæˆåŠŸ æ¡ˆä¾‹ï¼š 123456789101112131415161718192021//çº¿ç¨‹ç¤¼è®©ä¸ä¸€å®šæˆåŠŸï¼Œçœ‹cpuå¿ƒæƒ…public class TestYield &#123; public static void main(String[] args) &#123; MyYield myYield = new MyYield(); new Thread(myYield, &quot;a&quot;).start(); new Thread(myYield, &quot;b&quot;).start(); &#125;&#125;class MyYield implements Runnable &#123; @Override public void run() &#123; System.out.println(Thread.currentThread().getName() + &quot;çº¿ç¨‹å¼€å§‹è¿è¡Œï¼&quot;); Thread.yield();//ç¤¼è®© System.out.println(Thread.currentThread().getName() + &quot;çº¿ç¨‹ç»“æŸè¿è¡Œï¼&quot;); &#125;&#125; åˆå¹¶çº¿ç¨‹â€”â€”Join()Join åˆå¹¶çº¿ç¨‹ï¼Œå¾…æ­¤çº¿ç¨‹æ‰§è¡Œå®Œæˆåï¼Œå†æ‰§è¡Œå…¶ä»–çº¿ç¨‹ï¼Œå…¶ä»–çº¿ç¨‹é˜»å¡ã€‚ å¯ä»¥æƒ³è±¡æˆæ’é˜Ÿã€‚ æ¡ˆä¾‹ï¼šå¤šæ ¸è¾¾ä¸åˆ°é¢„æœŸæ•ˆæœ 12345678910111213141516171819202122232425//æµ‹è¯•joinæ–¹æ³•ï¼Œæƒ³è±¡ä¸ºæ’é˜Ÿpublic class TestJoin implements Runnable &#123; @Override public void run() &#123; for (int i = 0; i &lt; 1000; i++) &#123; System.out.println(&quot;vipçº¿ç¨‹æ¥äº†&quot; + i); &#125; &#125; public static void main(String[] args) throws InterruptedException &#123; //çº¿ç¨‹å¯åŠ¨ TestJoin testJoin = new TestJoin(); Thread thread = new Thread(testJoin); thread.start(); //ä¸»çº¿ç¨‹ for (int i = 0; i &lt; 500; i++) &#123; if (i == 200) &#123; thread.join();//æ’é˜Ÿ &#125; System.out.println(&quot;mainçº¿ç¨‹&quot; + i); &#125; &#125;&#125; çº¿ç¨‹çŠ¶æ€è§‚æµ‹Thread.State çº¿ç¨‹çŠ¶æ€ï¼šçº¿ç¨‹å¯ä»¥å¤„äºä»¥ä¸‹çŠ¶æ€ä¹‹ä¸€ï¼š NEWï¼šå°šæœªå¯åŠ¨çš„çº¿ç¨‹å¤„äºæ­¤çŠ¶æ€ã€‚ åˆ›å»ºçŠ¶æ€ RUNNABLEï¼šåœ¨ Java è™šæ‹Ÿæœºä¸­æ‰§è¡Œçš„çº¿ç¨‹å¤„äºæ­¤çŠ¶æ€ã€‚ è¿è¡ŒçŠ¶æ€ BLOCKEDï¼šè¢«é˜»å¡ç­‰å¾…ç›‘è§†å™¨é”å®šçš„çº¿ç¨‹å¤„äºæ­¤çŠ¶æ€ã€‚ é˜»å¡çŠ¶æ€ WAITINGï¼šæ­£åœ¨ç­‰å¾…å¦ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œç‰¹å®šåŠ¨ä½œçš„çº¿ç¨‹å¤„äºæ­¤çŠ¶æ€ã€‚ å°±ç»ªçŠ¶æ€ TERMINATEDï¼šå·²é€€å‡ºçš„çº¿ç¨‹å¤„äºæ­¤çŠ¶æ€ã€‚ æ­»äº¡çŠ¶æ€ ä¸€ä¸ªçº¿ç¨‹å¯ä»¥åœ¨ç»™å®šæ—¶é—´ç‚¹å¤„äºä¸€ä¸ªçŠ¶æ€ã€‚ è¿™äº›çŠ¶æ€æ˜¯ä¸åæ˜ ä»»ä½•æ“ä½œç³»ç»Ÿçº¿ç¨‹çŠ¶æ€çš„è™šæ‹ŸæœºçŠ¶æ€ã€‚ æ­»äº¡ä¹‹åçš„çº¿ç¨‹ä¸èƒ½å†æ¬¡å¯åŠ¨ï¼Œä¸€ä¸ªçº¿ç¨‹åªèƒ½å¯åŠ¨ä¸€æ¬¡ æ–¹æ³•ï¼šthread.getState() æ¡ˆä¾‹ï¼š 12345678910111213141516171819202122232425262728293031public class TestState &#123; public static void main(String[] args) throws InterruptedException &#123; Thread thread = new Thread(() -&gt; &#123; for (int i = 0; i &lt; 5; i++) &#123; try &#123; System.out.println(i); Thread.sleep(1000); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; &#125; System.out.println(&quot;////&quot;); &#125;); //è§‚å¯Ÿçº¿ç¨‹çŠ¶æ€ Thread.State state = thread.getState(); System.out.println(state); //è§‚å¯Ÿå¯åŠ¨å thread.start(); state = thread.getState(); System.out.println(state); while (state != Thread.State.TERMINATED) &#123; Thread.sleep(100); state = thread.getState(); System.out.println(state); &#125; &#125;&#125; çº¿ç¨‹ä¼˜å…ˆçº§Java æä¾›ä¸€ä¸ªçº¿ç¨‹è°ƒåº¦å™¨æ¥ç›‘æ§ç¨‹åºä¸­å¯åŠ¨åè¿›å…¥å°±ç»ªçŠ¶æ€çš„æ‰€æœ‰çº¿ç¨‹ï¼Œçº¿ç¨‹è°ƒåº¦å™¨æŒ‰ç…§ä¼˜å…ˆçº§å†³å®šåº”è¯¥è°ƒåº¦å“ªä¸ªçº¿ç¨‹æ¥æ‰§è¡Œã€‚ ä¼˜å…ˆçº§é«˜çš„è·å¾—cpuçš„å‡ ç‡æ›´å¤§äº›ï¼Œä¸æ˜¯ä¼˜å…ˆçº§é«˜çš„å°±å…ˆæ‰§è¡Œå®Œï¼Œçº¿ç¨‹ä¼˜å…ˆçº§éšæœºç‰¹æ€§ çº¿ç¨‹çš„ä¼˜å…ˆçº§ç”¨æ•°å­—è¡¨ç¤ºï¼ŒèŒƒå›´ä»1~10 Thread.MIN_PRIORITY&#x3D;1 Thread.MAX_PRIORITY&#x3D;10 Thread.NORM_PRIORITY&#x3D;5 ä½¿ç”¨ä»¥ä¸‹æ–¹å¼æ”¹å˜æˆ–è·å–ä¼˜å…ˆçº§ getPriority().setPriority(int xxx) ä¼˜å…ˆçº§çš„è®¾å®šå»ºè®®åœ¨ start() è°ƒåº¦å‰ æ¡ˆä¾‹ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647//æµ‹è¯•çº¿ç¨‹çš„ä¼˜å…ˆçº§public class TestPriority extends Thread &#123; //ä¸»çº¿ç¨‹é»˜è®¤ä¼˜å…ˆçº§ public static void main(String[] args) &#123; System.out.println(Thread.currentThread().getName() + &quot;---&gt;&quot; + Thread.currentThread().getPriority()); MyPriority myPriority = new MyPriority(); Thread t1 = new Thread(myPriority); Thread t2 = new Thread(myPriority); Thread t3 = new Thread(myPriority); Thread t4 = new Thread(myPriority); Thread t5 = new Thread(myPriority); Thread t6 = new Thread(myPriority); //å…ˆè®¾ç½®ä¼˜å…ˆçº§ï¼Œ å†å¯åŠ¨ t1.start(); t2.setPriority(1); t2.start(); t3.setPriority(4); t3.start(); t4.setPriority(MAX_PRIORITY);//MAX_PRIORITY=10 t4.start();/* t5.setPriority(-1); t5.start(); t6.setPriority(11); t6.start();*/ &#125;&#125;class MyPriority implements Runnable &#123; @Override public void run() &#123; System.out.println(Thread.currentThread().getName() + &quot;---&gt;&quot; + Thread.currentThread().getPriority()); &#125;&#125; å®ˆæŠ¤ï¼ˆdaemonï¼‰çº¿ç¨‹ çº¿ç¨‹åˆ†ä¸ºç”¨æˆ·çº¿ç¨‹å’Œå®ˆæŠ¤çº¿ç¨‹ è™šæ‹Ÿæœºå¿…é¡»ç¡®ä¿ç”¨æˆ·çº¿ç¨‹æ‰§è¡Œå®Œæ¯•ï¼šmain è™šæ‹Ÿæœºä¸ç”¨ç­‰å¾…å®ˆæŠ¤çº¿ç¨‹æ‰§è¡Œå®Œæ¯•ï¼šgcåƒåœ¾å›æ”¶è¿›ç¨‹ å¦‚åå°è®°å½•æ“ä½œæ—¥å¿—ï¼Œç›‘æ§å†…å­˜åƒåœ¾å›æ”¶ç­‰å¾… æ¡ˆä¾‹ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142//æµ‹è¯•å®ˆæŠ¤çº¿ç¨‹//ä¸Šå¸å®ˆæŠ¤ä½ public class TestDaemon &#123; public static void main(String[] args) &#123; God god = new God(); You you = new You(); Thread thread = new Thread(god); thread.setDaemon(true);//é»˜è®¤çº¿ç¨‹æ˜¯ç”¨æˆ·çº¿ç¨‹ thread.start(); new Thread(you).start();//ä½ å¯åŠ¨ &#125;&#125;//ä¸Šå¸class God implements Runnable &#123; @Override public void run() &#123; while (true) &#123; System.out.println(&quot;ä¸Šå¸æ°¸è¿œä¿ä½‘ç€ä½ ï¼&quot;); &#125; &#125;&#125;//ä½ class You implements Runnable &#123; @Override public void run() &#123; for (int i = 0; i &lt; 36500; i++) &#123; System.out.println(&quot;ä½ å¼€å¿ƒçš„ç”Ÿæ´»æ¯ä¸€å¤©ï¼&quot;); &#125; System.out.println(&quot;=========goodbye,world!&quot;); &#125;&#125; çº¿ç¨‹åŒæ­¥ å¹¶å‘ï¼šåŒä¸€å¯¹è±¡è¢«å¤šä¸ªçº¿ç¨‹åŒæ—¶æ“ä½œï¼ˆæŠ¢ç¥¨ï¼‰ çº¿ç¨‹åŒæ­¥æ˜¯ä¸€ä¸ªç­‰å¾…æœºåˆ¶ï¼Œå¤šä¸ªéœ€è¦åŒæ—¶è®¿é—®æ¬¡å¯¹è±¡çš„çº¿ç¨‹è¿›å…¥è¿™ä¸ªå¯¹è±¡çš„ç­‰å¾…æ± å½¢æˆé˜Ÿåˆ—ï¼Œç­‰å¾…å‰ä¸€ä¸ªçº¿ç¨‹ä½¿ç”¨å®Œæ¯•ï¼Œä¸‹ä¸€ä¸ªçº¿ç¨‹æ‰èƒ½ä½¿ç”¨ã€‚ å½¢æˆæ¡ä»¶ï¼šé˜Ÿåˆ—+é” ç”±äºåŒä¸€è¿›ç¨‹çš„å¤šä¸ªçº¿ç¨‹å…±äº«åŒä¸€å—å­˜å‚¨ç©ºé—´ï¼Œåœ¨å¸¦æ¥æ–¹ä¾¿çš„åŒæ—¶ï¼Œä¹Ÿå¸¦æ¥äº†è®¿é—®å†²çªé—®é¢˜ï¼Œä¸ºäº†ä¿è¯æ•°æ®åœ¨æ–¹æ³•ä¸­è¢«è®¿é—®æ—¶çš„æ­£ç¡®æ€§ï¼Œåœ¨è®¿é—®æ—¶åŠ å…¥é”æœºåˆ¶ synchronizedï¼Œå½“ä¸€ä¸ªçº¿ç¨‹è·å¾—å¯¹è±¡çš„æ’å®ƒé”ï¼Œç‹¬å èµ„æºï¼Œå…¶ä»–çº¿ç¨‹å¿…é¡»ç­‰å¾…ï¼Œä½¿ç”¨åé‡Šæ”¾é”å³å¯.å­˜åœ¨ä»¥ä¸‹é—®é¢˜ï¼š ä¸€ä¸ªçº¿ç¨‹æŒæœ‰é”ä¼šå¯¼è‡´å…¶ä»–æ‰€æœ‰éœ€è¦æ­¤é”çš„çº¿ç¨‹æŒ‚èµ·ï¼› åœ¨å¤šçº¿ç¨‹ç«äº‰ä¸‹ï¼ŒåŠ é”ï¼Œé‡Šæ”¾é”ä¼šå¯¼è‡´æ¯”è¾ƒå¤šçš„ä¸Šä¸‹æ–‡åˆ‡æ¢å’Œè°ƒåº¦å»¶æ—¶ï¼Œå¼•èµ·æ€§èƒ½é—®é¢˜ï¼› å¦‚æœä¸€ä¸ªä¼˜å…ˆçº§é«˜çš„çº¿ç¨‹ç­‰å¾…ä¸€ä¸ªä¼˜å…ˆçº§ä½çš„çº¿ç¨‹é‡Šæ”¾é”ä¼šå¯¼è‡´ä¼˜å…ˆçº§å€’ç½®ï¼Œå¼•èµ·æ€§èƒ½é—®é¢˜. çº¿ç¨‹ä¸å®‰å…¨ä¸¾ä¾‹1. ä¸å®‰å…¨çš„å”®ç¥¨(å·²æ ¹æ®4.2æ”¹æˆå®‰å…¨) 1234567891011121314151617181920212223242526272829303132333435363738394041424344//çº¿ç¨‹ä¸å®‰å…¨ï¼Œä¹°ç¥¨é‡å¤public class UnsafeBuyTicket &#123; public static void main(String[] args) &#123; BuyTicket buyTicket = new BuyTicket(); new Thread(buyTicket, &quot;æˆ‘&quot;).start(); new Thread(buyTicket, &quot;ä½ &quot;).start(); new Thread(buyTicket, &quot;ä»–&quot;).start(); &#125;&#125;class BuyTicket implements Runnable &#123; //ç¥¨ private int ticket = 10; //å¤–éƒ¨åœæ­¢æ ‡å¿— boolean flag = true; @Override public void run() &#123; //ä¹°ç¥¨ while (flag) &#123; try &#123; buy(); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; &#125; &#125; //synchronized:åŒæ­¥æ–¹æ³•ï¼Œé”çš„æ˜¯this public synchronized void buy() throws InterruptedException &#123; if (ticket &lt;= 0) &#123; flag = false; return; &#125; //æ¨¡æ‹Ÿå»¶æ—¶ Thread.sleep(1000); System.out.println(Thread.currentThread().getName() + &quot;ä¹°åˆ°&quot; + ticket--); &#125;&#125; 2.ä¸å®‰å…¨å–é’±(å·²æ ¹æ®4.2æ”¹æˆå®‰å…¨) 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980//å–é’±çº¿ç¨‹ä¸å®‰å…¨public class UnsafeBank &#123; public static void main(String[] args) &#123; //è´¦æˆ· Account account = new Account(1000, &quot;ç»“å©šåŸºé‡‘&quot;); Drawing you = new Drawing(account, 50, &quot;ä½ &quot;); Drawing girlFriend = new Drawing(account, 100, &quot;girlFriend&quot;); you.start(); girlFriend.start(); &#125;&#125;class Account &#123; //è´¦æˆ·åç§° String name; //è´¦æˆ·ä½™é¢ int money; public Account(int money, String name) &#123; this.name = name; this.money = money; &#125;&#125;class Drawing extends Thread &#123; Account account;//é“¶è¡Œè´¦æˆ· int drawingMoney;//å–äº†å¤šå°‘é’± int nowMoney;//å‰©ä½™å¤šå°‘é’± public Drawing(Account account, int drawingMoney, String name) &#123; this.account = account; this.drawingMoney = drawingMoney; super.setName(name); &#125; //å–é’± @Override public void run() &#123; //synchronizedå—ï¼šé”çš„æ˜¯å˜åŒ–çš„é‡ synchronized (account) &#123; if (account.money - drawingMoney &lt; 0) &#123; System.out.println(&quot;å¡å†…ä½™é¢ä¸è¶³ï¼Œå–ä¸äº†ï¼&quot;); return; &#125; try &#123; Thread.sleep(1000); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; // å¡å†…ä½™é¢ = ä½™é¢â€“ä½ å–çš„é’± account.money = account.money - drawingMoney; //ä½ æ‰‹é‡Œçš„é’± nowMoney = nowMoney + drawingMoney; System.out.println(account.name + &quot;ä½™é¢ä¸º:&quot; + account.money); //Thread.currentThread().getName() == this.getName() System.out.println(this.getName() + &quot;æ‰‹é‡Œçš„é’±&quot; + nowMoney); &#125; &#125;&#125; 3.ä¸å®‰å…¨çš„é›†åˆ(å·²æ ¹æ®4.2æ”¹æˆå®‰å…¨) 12345678910111213141516171819//çº¿ç¨‹ä¸å®‰å…¨çš„é›†åˆpublic class UnsafeList &#123; public static void main(String[] args) &#123; List&lt;String&gt; list = new ArrayList&lt;&gt;(); for (int i = 0; i &lt; 10000; i++) &#123; new Thread(() -&gt; &#123; synchronized (list) &#123; list.add(Thread.currentThread().getName()); &#125; &#125;).start(); &#125; try &#123; Thread.sleep(3000); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; System.out.println(list.size()); &#125;&#125; åŒæ­¥æ–¹æ³•åŠåŒæ­¥å—ç”±äºæˆ‘ä»¬å¯ä»¥é€šè¿‡å…³é”®å­— private å…³é”®å­—æ¥ä¿è¯æ•°æ®å¯¹è±¡åªèƒ½è¢«æ–¹æ³•è®¿é—®ï¼Œæ‰€ä»¥æˆ‘ä»¬åªè¦é’ˆå¯¹æ–¹æ³•æå‡ºä¸€å¥—æœºåˆ¶ï¼Œè¿™å¥—æœºåˆ¶å°±æ˜¯ synchronized å…³é”®å­—ï¼Œ å®ƒåŒ…æ‹¬ä¸¤ç§æ–¹æ³•ï¼šsynchronized æ–¹æ³•å’Œ synchronized å—. synchronized æ–¹æ³•: 1public synchronized void method(int args)&#123;&#125; synchronized æ–¹æ³•æ§åˆ¶ â€œå¯¹è±¡â€ çš„è®¿é—®ï¼Œæ¯ä¸ªå¯¹è±¡å¯¹åº”ä¸€æŠŠé”ï¼Œæ¯ä¸ª synchronized æ–¹æ³•éƒ½å¿…é¡»è·å¾—è°ƒç”¨è¯¥æ–¹æ³•çš„å¯¹è±¡çš„é”æ‰èƒ½æ‰§è¡Œï¼Œå¦åˆ™çº¿ç¨‹ä¼šé˜»å¡ï¼Œæ–¹æ³•ä¸€æ—¦æ‰§è¡Œï¼Œå°±ç‹¬å è¯¥é”ï¼Œç›´åˆ°è¯¥æ–¹æ³•è¿”å›æ‰é‡Šæ”¾ï¼Œåé¢è¢«é˜»å¡çš„çº¿ç¨‹æ‰èƒ½è·å¾—è¿™ä¸ªé”ï¼Œç»§ç»­æ‰§è¡Œã€‚ ç¼ºé™·ï¼šè‹¥å°†ä¸€ä¸ªå¤§çš„æ–¹æ³•ç”³æ˜ä¸º synchronized å°†ä¼šå½±å“æ•ˆç‡ã€‚ synchronized å—: åŒæ­¥å—ï¼šsynchronized(Obj){} Obj ç§°ä¹‹ä¸ºåŒæ­¥ç›‘è§†å™¨ Obj å¯ä»¥æ˜¯ä»»ä½•å¯¹è±¡ï¼Œä½†æ˜¯æ¨èä½¿ç”¨å…±äº«èµ„æºä½œä¸ºåŒæ­¥ç›‘è§†å™¨ åŒæ­¥æ–¹æ³•ä¸­æ— éœ€æŒ‡å®šåŒæ­¥ç›‘è§†å™¨ï¼Œå› ä¸ºåŒæ­¥æ–¹æ³•çš„åŒæ­¥ç›‘è§†å™¨å°±æ˜¯ this ï¼Œå°±æ˜¯è¿™ä¸ªå¯¹è±¡æœ¬èº«ï¼Œæˆ–è€…æ˜¯ class åŒæ­¥ç›‘è§†å™¨çš„æ‰§è¡Œè¿‡ç¨‹ ç¬¬ä¸€ä¸ªçº¿ç¨‹è®¿é—®ï¼Œé”å®šåŒæ­¥ç›‘è§†å™¨ï¼Œæ‰§è¡Œå…¶ä¸­çš„ä»£ç  ç¬¬äºŒä¸ªçº¿ç¨‹è®¿é—®ï¼Œå‘ç°åŒæ­¥ç›‘è§†å™¨è¢«é”å®šï¼Œæ— æ³•è®¿é—® ç¬¬ä¸€ä¸ªçº¿ç¨‹è®¿é—®å®Œæ¯•ï¼Œè§£é”åŒæ­¥ç›‘è§†å™¨ ç¬¬äºŒä¸ªçº¿ç¨‹è®¿é—®ï¼Œå‘ç°åŒæ­¥ç›‘è§†å™¨æ²¡æœ‰é”ï¼Œç„¶åé”å®šå¹¶è®¿é—® é”çš„æ˜¯å˜åŒ–çš„é‡ JUCå®‰å…¨é›†åˆç±»å‹æ‰©å…… 1234567891011121314151617public class TestJUC &#123; public static void main(String[] args) &#123; CopyOnWriteArrayList&lt;String&gt; list = new CopyOnWriteArrayList&lt;String&gt;(); for (int i = 0; i &lt; 10000; i++) &#123; new Thread(() -&gt; &#123; list.add(Thread.currentThread().getName()); &#125;).start(); &#125; try &#123; Thread.sleep(3000); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; System.out.println(list.size()); &#125;&#125; æ­»é”å’ŒLocké” æ­»é”ï¼š å¤šä¸ªçº¿ç¨‹å„è‡ªå æœ‰ä¸€äº›å…±äº«èµ„æºï¼Œå¹¶ä¸”äº’ç›¸ç­‰å¾…å…¶ä»–çº¿ç¨‹å æœ‰çš„èµ„æºæ‰èƒ½è¿è¡Œï¼Œè€Œå¯¼è‡´ä¸¤ä¸ªæˆ–è€…å¤šä¸ªçº¿ç¨‹éƒ½åœ¨ç­‰å¾…å¯¹æ–¹é‡Šæ”¾èµ„æºï¼Œéƒ½åœæ­¢æ‰§è¡Œçš„æƒ…å½¢ã€‚æŸä¸€ä¸ªåŒæ­¥å—åŒæ—¶æ‹¥â€œä¸¤ä¸ªä»¥ä¸Šå¯¹è±¡çš„é”â€æ—¶ï¼Œå°±å¯èƒ½ä¼šå‘ç”Ÿâ€œæ­»é”â€çš„é—®é¢˜ã€‚ äº§ç”Ÿæ­»é”çš„å››ä¸ªå¿…è¦æ¡ä»¶ï¼š äº’æ–¥æ¡ä»¶ï¼šä¸€ä¸ªèµ„æºæ¯æ¬¡åªèƒ½è¢«ä¸€ä¸ªè¿›ç¨‹ä½¿ç”¨ã€‚ è¯·æ±‚ä¸ä¿æŒæ¡ä»¶ï¼šä¸€ä¸ªè¿›ç¨‹å› è¯·æ±‚èµ„æºè€Œé˜»å¡æ—¶ï¼Œå¯¹å·²è·å¾—çš„èµ„æºä¿æŒä¸æ”¾ã€‚ ä¸å‰¥å¤ºæ¡ä»¶ï¼šè¿›ç¨‹å·²è·å¾—çš„èµ„æºï¼Œåœ¨æœªä½¿ç”¨å®Œä¹‹å‰ï¼Œä¸èƒ½å¼ºè¡Œå‰¥å¤ºã€‚ å¾ªç¯ç­‰å¾…æ¡ä»¶ï¼šè‹¥å¹²è¿›ç¨‹ä¹‹é—´å½¢æˆä¸€ç§å¤´å°¾ç›¸æ¥çš„å¾ªç¯ç­‰å¾…èµ„æºå…³ç³»ã€‚ ä¸Šè¿°å››ä¸ªæ¡ä»¶ï¼Œåªè¦ç ´åå…¶ä»»æ„ä¸€ä¸ªæˆ–å¤šä¸ªæ¡ä»¶å°±å¯é¿å…æ­»é”çš„å‘ç”Ÿã€‚ æ¡ˆä¾‹ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384/** * æ­»é”:å¤šä¸ªçº¿ç¨‹äº’ç›¸æŠ±ç€å¯¹æ–¹éœ€è¦çš„èµ„æº,ç„¶åå½¢æˆåƒµæŒ * è§£å†³:ä¸€ä¸ªé”åªé”ä¸€ä¸ªå¯¹è±¡ */public class DeadLock &#123; public static void main(String[] args) &#123; Makeup makeup = new Makeup(0, &quot;ç°å§‘å¨˜&quot;); Makeup makeup1 = new Makeup(1, &quot;ç™½é›ªå…¬ä¸»&quot;); makeup.start(); makeup1.start(); &#125;&#125;//å£çº¢class Lipstick &#123; &#125;//é•œå­class Mirror &#123; &#125;class Makeup extends Thread &#123; //éœ€è¦çš„èµ„æºåªæœ‰ä¸€ä»½,ç”¨staticä¿è¯åªæœ‰ä¸€ä»½ static Lipstick lipstick = new Lipstick(); static Mirror mirror = new Mirror(); int choice;//é€‰æ‹© String girlName;//ä½¿ç”¨åŒ–å¦†å“çš„äºº public Makeup(int choice, String girlName) &#123; this.choice = choice; this.girlName = girlName; &#125; @Override public void run() &#123; //åŒ–å¦† try &#123; makeup(); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; &#125; private void makeup() throws InterruptedException &#123; if (choice == 0) &#123; synchronized (lipstick) &#123;//è·å¾—å£çº¢çš„é” System.out.println(this.girlName + &quot;è·å¾—å£çº¢çš„é”&quot;); Thread.sleep(1000); synchronized (mirror) &#123;//ä¸€ç§’é’Ÿåæƒ³è·å¾—é•œå­ System.out.println(this.girlName + &quot;è·å¾—é•œå­çš„é”&quot;); &#125; &#125; &#125; else &#123; synchronized (mirror) &#123;//è·å¾—å£çº¢é•œå­ System.out.println(this.girlName + &quot;è·å¾—é•œå­çš„é”&quot;); Thread.sleep(2000); synchronized (lipstick) &#123;//äºŒç§’é’Ÿåæƒ³è·å¾—çš„é” System.out.println(this.girlName + &quot;è·å¾—å£çº¢çš„é”&quot;); &#125; &#125; &#125; &#125;&#125; // è§£å†³:ä¸€ä¸ªé”åªé”ä¸€ä¸ªå¯¹è±¡ private void makeup() throws InterruptedException &#123; if (choice == 0) &#123; synchronized (lipstick) &#123;//è·å¾—å£çº¢çš„é” System.out.println(this.girlName + &quot;è·å¾—å£çº¢çš„é”&quot;); Thread.sleep(1000); &#125; synchronized (mirror) &#123;//ä¸€ç§’é’Ÿåæƒ³è·å¾—é•œå­ System.out.println(this.girlName + &quot;è·å¾—é•œå­çš„é”&quot;); &#125; &#125; else &#123; synchronized (mirror) &#123;//è·å¾—å£çº¢é•œå­ System.out.println(this.girlName + &quot;è·å¾—é•œå­çš„é”&quot;); Thread.sleep(2000); &#125; synchronized (lipstick) &#123;//äºŒç§’é’Ÿåæƒ³è·å¾—çš„é” System.out.println(this.girlName + &quot;è·å¾—å£çº¢çš„é”&quot;); &#125; &#125; &#125; Lock(é”): ä» JDK 5.0 å¼€å§‹ï¼ŒJava æä¾›äº†æ›´å¼ºå¤§çš„çº¿ç¨‹åŒæ­¥æœºåˆ¶â€”â€”é€šè¿‡æ˜¾ç¤ºå®šä¹‰åŒæ­¥é”å¯¹è±¡æ¥å®ç°åŒæ­¥ã€‚åŒæ­¥é”ä½¿ç”¨ Lockå¯¹è±¡å……å½“ java.util.concurrent.locks.Lock æ¥å£æ˜¯æ§åˆ¶å¤šä¸ªçº¿ç¨‹å¯¹å…±äº«èµ„æºè¿›è¡Œè®¿é—®çš„å·¥å…·ã€‚é”æä¾›äº†å¯¹å…±äº«èµ„æºçš„ç‹¬å è®¿é—®ï¼Œæ¯æ¬¡åªèƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹å¯¹ Lock å¯¹è±¡åŠ é”ï¼Œçº¿ç¨‹å¼€å§‹è®¿é—®å…±äº«èµ„æºä¹‹å‰åº”å…ˆè·å¾— Lockå¯¹è±¡ã€‚ ReentrantLock ç±»å®ç°äº† Lock ï¼Œå®ƒæ‹¥æœ‰ä¸ synchronized ç›¸åŒçš„å¹¶å‘æ€§å’Œå†…å­˜è¯­ä¹‰ï¼Œåœ¨å®ç°çº¿ç¨‹å®‰å…¨çš„æ§åˆ¶ä¸­ï¼Œæ¯”è¾ƒå¸¸ç”¨çš„æ˜¯ ReentrantLock ï¼Œå¯ä»¥æ˜¾ç¤ºåŠ é”é‡Šæ”¾é”ã€‚ synchronized ä¸ Lock çš„å¯¹æ¯”: Lock æ˜¯æ˜¾ç¤ºé”ï¼ˆæ‰‹åŠ¨å¼€å¯å’Œå…³é—­ï¼‰ï¼Œsynchronized æ˜¯éšå¼é”ï¼Œå‡ºäº†ä½œç”¨åŸŸè‡ªåŠ¨é‡Šæ”¾ Lock åªæœ‰ä»£ç åŠ é”ï¼Œsynchronized æœ‰ä»£ç å—é”å’Œæ–¹æ³•é” ä½¿ç”¨ Lock é”ï¼ŒJVM å°†èŠ±è´¹è¾ƒå°‘çš„æ—¶é—´æ¥è°ƒåº¦çº¿ç¨‹ï¼Œæ€§èƒ½æ›´å¥½ã€‚å¹¶å…·æœ‰æ›´å¥½çš„æ‰©å±•æ€§ï¼ˆæä¾›æ›´å¤šçš„å­ç±»ï¼‰ Lock &gt; åŒæ­¥ä»£ç å—ï¼ˆå·²ç»è¿›å…¥äº†æ–¹æ³•ä½“ï¼Œåˆ†é…äº†ç›¸åº”èµ„æºï¼‰&gt;åŒæ­¥æ–¹æ³•ï¼ˆåœ¨æ–¹æ³•ä½“ä¹‹å¤–ï¼‰ æ¡ˆä¾‹ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940//æµ‹è¯•Locké”public class TestLock &#123; public static void main(String[] args) &#123; TestLock2 testLock2 = new TestLock2(); new Thread(testLock2).start(); new Thread(testLock2).start(); new Thread(testLock2).start(); &#125;&#125;class TestLock2 implements Runnable &#123; int ticketNums = 10; //å®šä¹‰locké”:å¯é‡å…¥é” private final ReentrantLock lock = new ReentrantLock(); @Override public void run() &#123; while (true) &#123; try &#123; lock.lock();//åŠ é” if (ticketNums &gt; 0) &#123; try &#123; Thread.sleep(1000); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; System.out.println(ticketNums--); &#125; else &#123; break; &#125; &#125; finally &#123; lock.unlock();//è§£é” &#125; &#125; &#125;&#125; çº¿ç¨‹é€šä¿¡åº”ç”¨åœºæ™¯ï¼šç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…é—®é¢˜ å‡è®¾ä»“åº“ä¸­åªèƒ½å­˜æ”¾ä¸€ä»¶äº§å“ï¼Œç”Ÿäº§è€…å°†ç”Ÿäº§å‡ºæ¥çš„äº§å“æ”¾å…¥ä»“åº“ï¼Œæ¶ˆè´¹è€…å°†ä»“åº“ä¸­äº§å“å–èµ°æ¶ˆè´¹ã€‚ å¦‚æœä»“åº“ä¸­æ²¡æœ‰äº§å“ï¼Œåˆ™å°†ç”Ÿäº§è€…å°†äº§å“æ”¾å…¥ä»“åº“ï¼Œå¦åˆ™åœæ­¢ç”Ÿäº§å¹¶ç­‰å¾…ï¼Œç›´åˆ°ä»“åº“ä¸­çš„äº§å“è¢«æ¶ˆè´¹è€…å–èµ°ä¸ºæ­¢ã€‚ å¦‚æœä»“åº“ä¸­æ”¾æœ‰äº§å“ï¼Œåˆ™æ¶ˆè´¹è€…å¯ä»¥å°†äº§å“å–èµ°æ¶ˆè´¹ï¼Œå¦åˆ™åœæ­¢æ¶ˆè´¹ï¼Œç›´åˆ°ä»“åº“ä¸­å†æ¬¡æ”¾å…¥äº§å“ä¸ºæ­¢ã€‚ è¿™æ˜¯ä¸€ä¸ªçº¿ç¨‹åŒæ­¥é—®é¢˜ï¼Œç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…å…±äº«åŒä¸€ä¸ªèµ„æºï¼Œå¹¶ä¸”ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…ä¹‹é—´ç›¸äº’ä¾èµ–ï¼Œäº’ä¸ºæ¡ä»¶ã€‚ å¯¹äºç”Ÿäº§è€…ï¼Œæ²¡æœ‰ç”Ÿäº§äº§å“ä¹‹å‰ï¼Œè¦é€šçŸ¥æ¶ˆè´¹è€…ç­‰å¾….è€Œç”Ÿäº§äº†äº§å“ä¹‹åï¼Œåˆéœ€è¦é©¬ä¸Šé€šçŸ¥æ¶ˆè´¹è€…æ¶ˆè´¹ å¯¹äºæ¶ˆè´¹è€…ï¼Œåœ¨æ¶ˆè´¹ä¹‹åï¼Œè¦é€šçŸ¥ç”Ÿäº§è€…å·²ç»ç»“æŸæ¶ˆè´¹ï¼Œéœ€è¦ç”Ÿäº§æ–°çš„äº§å“ä»¥ä¾›æ¶ˆè´¹. åœ¨ç”Ÿäº§è€…æ¶ˆè´¹è€…é—®é¢˜ä¸­ï¼Œä»…æœ‰synchronizedæ˜¯ä¸å¤Ÿçš„ synchronized ï¼šå¯é˜»æ­¢å¹¶å‘æ›´æ–°åŒä¸€ä¸ªå…±äº«èµ„æºï¼Œå®ç°äº†åŒæ­¥ï¼Œä¸èƒ½ç”¨æ¥å®ç°ä¸åŒçº¿ç¨‹ä¹‹é—´çš„æ¶ˆæ¯ä¼ é€’ï¼ˆé€šä¿¡ï¼‰ è§£å†³çº¿ç¨‹é€šä¿¡çš„å‡ ä¸ªæ–¹æ³•æ³¨æ„ï¼šå‡æ˜¯ Object ç±»çš„æ–¹æ³•ï¼Œéƒ½åªèƒ½åœ¨åŒæ­¥æ–¹æ³•æˆ–è€…åŒæ­¥ä»£ç å—ä¸­ä½¿ç”¨ï¼Œå¦åˆ™ä¼šæŠ›å‡ºå¼‚å¸¸ illegalMonitorStateException è§£å†³çº¿ç¨‹ä¹‹é—´é€šä¿¡çš„æ–¹å¼ç®¡ç¨‹æ³•å¹¶å‘å†™ä½œæ¨¡å‹â€â€ç”Ÿäº§è€…&#x2F;æ¶ˆè´¹è€…æ¨¡å¼â€â€â€“&gt;ç®¡ç¨‹æ³• ç”Ÿäº§è€…ï¼šè´Ÿè´£ç”Ÿäº§æ•°æ®çš„æ¨¡å—ï¼ˆå¯èƒ½æ˜¯æ–¹æ³•ï¼Œå¯¹è±¡ï¼Œçº¿ç¨‹ï¼Œè¿›ç¨‹ï¼‰ æ¶ˆè´¹è€…ï¼šè´Ÿè´£å¤„ç†æ•°æ®çš„æ¨¡å—ï¼ˆå¯èƒ½æ˜¯æ–¹æ³•ï¼Œå¯¹è±¡ï¼Œçº¿ç¨‹ï¼Œè¿›ç¨‹ï¼‰ ç¼“å†²åŒºï¼šæ¶ˆè´¹è€…ä¸èƒ½ç›´æ¥ä½¿ç”¨ç”Ÿäº§è€…çš„æ•°æ®ï¼Œä»–ä»¬ä¹‹é—´æœ‰ä¸ªç¼“å†²åŒº ç”Ÿäº§è€…å°†ç”Ÿäº§å¥½çš„æ•°æ®æ”¾å…¥ç¼“å†²åŒºï¼Œæ¶ˆè´¹è€…ä»ç¼“å†²åŒºæ‹¿å‡ºæ•°æ® æ¡ˆä¾‹ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115//æµ‹è¯•ï¼šç”Ÿäº§è€…æ¶ˆè´¹è€…æ¨¡å‹---ã€‹ç®¡ç¨‹æ³•//æ¶ˆè´¹è€…ï¼Œç”Ÿäº§è€…ï¼Œå•†å“ï¼Œç¼“å†²åŒºpublic class TestPC &#123; public static void main(String[] args) &#123; SyncContainer syncContainer = new SyncContainer(); new Customer(syncContainer).start(); new Producer(syncContainer).start(); &#125;&#125;//æ¶ˆè´¹è€…class Customer extends Thread &#123; //åˆ›å»ºç¼“å†²åŒº private SyncContainer syncContainer; public Customer(SyncContainer syncContainer) &#123; this.syncContainer = syncContainer; &#125; @Override public void run() &#123; for (int i = 0; i &lt; 100; i++) &#123; Product pop = syncContainer.pop(); System.out.println(&quot;æ¶ˆè´¹äº†ç¬¬&quot; + pop.getId() + &quot;å·äº§å“&quot;); &#125; &#125;&#125;//ç”Ÿäº§è€…class Producer extends Thread &#123; //åˆ›å»ºæ–°çš„ç¼“å†²åŒº private SyncContainer syncContainer; public Producer(SyncContainer syncContainer) &#123; this.syncContainer = syncContainer; &#125; @Override public void run() &#123; for (int i = 0; i &lt; 100; i++) &#123; System.out.println(&quot;ç”Ÿäº§äº†&quot; + i + &quot;åªé¸¡ï¼&quot;); syncContainer.push(new Product(i)); &#125; &#125;&#125;//å•†å“class Product &#123; int id;//äº§å“ç¼–å· public Product(int id) &#123; this.id = id; &#125; public int getId() &#123; return id; &#125; public void setId(int id) &#123; this.id = id; &#125;&#125;//ç¼“å†²åŒºclass SyncContainer &#123; //å®šä¹‰å®¹å™¨å¤§å° Product[] products = new Product[10]; //å®¹å™¨è®¡æ•°å™¨ int count = 0; //ç”Ÿäº§è€…æ”¾å…¥äº§å“ public synchronized void push(Product product) &#123; //å¦‚æœå®¹å™¨æ»¡äº†ï¼Œå°±ç­‰å¾…æ¶ˆè´¹è€…æ¶ˆè´¹ if (count == products.length) &#123; //é€šçŸ¥æ¶ˆè´¹è€…æ¶ˆè´¹ï¼Œç”Ÿäº§ç­‰å¾… try &#123; this.wait(); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; &#125; // å¦‚æœæ²¡æœ‰æ»¡ï¼Œæˆ‘ä»¬å°±éœ€è¦ä¸¢å…¥äº§å“ products[count] = product; count++; //é€šçŸ¥æ¶ˆè´¹è€…æ¶ˆè´¹ this.notifyAll(); &#125; //æ¶ˆè´¹è€…æ¶ˆè´¹äº§å“ public synchronized Product pop() &#123; if (count == 0) &#123; //é€šçŸ¥ç”Ÿäº§è€…ç”Ÿäº§ï¼Œæ¶ˆè´¹è€…ç­‰å¾… try &#123; this.wait(); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; &#125; //å¦‚æœå¯ä»¥æ¶ˆè´¹ count--; Product product = products[count]; //é€šçŸ¥ç”Ÿäº§è€…æ¶ˆè´¹ this.notifyAll(); return product; &#125;&#125; ä¿¡å·ç¯æ³•é€šè¿‡æ ‡å¿—ä½è§£å†³ æ¡ˆä¾‹ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283//æµ‹è¯•ç”Ÿäº§è€…æ¶ˆè´¹è€…é—®é¢˜2ï¼šä¿¡å·ç¯æ³•ï¼Œé€šè¿‡æ ‡å¿—ä½è§£å†³public class TestPC2 &#123; public static void main(String[] args) &#123; TV tv = new TV(); new Player(tv).start(); new Watcher(tv).start(); &#125;&#125;//ç”Ÿäº§è€…--&gt;æ¼”å‘˜class Player extends Thread &#123; TV tv; public Player(TV tv) &#123; this.tv = tv; &#125; @Override public void run() &#123; for (int i = 0; i &lt; 20; i++) &#123; if (i % 2 == 0) &#123; this.tv.play(&quot;å¿«ä¹å¤§æœ¬è¥æ’­æ”¾ä¸­&quot;); &#125; else &#123; this.tv.play(&quot;æŠ–éŸ³ï¼šè®°å½•ç¾å¥½ç”Ÿæ´»&quot;); &#125; &#125; &#125;&#125;//æ¶ˆè´¹è€…--&gt;è§‚ä¼—class Watcher extends Thread &#123; TV tv; public Watcher(TV tv) &#123; this.tv = tv; &#125; @Override public void run() &#123; for (int i = 0; i &lt; 20; i++) &#123; tv.watch(); &#125; &#125;&#125;//äº§å“--&gt;èŠ‚ç›®class TV &#123; //æ¼”å‘˜è¡¨æ¼”ï¼Œè§‚ä¼—ç­‰å¾… T //è§‚ä¼—è§‚çœ‹ï¼Œæ¼”å‘˜ç­‰å¾… F String voice; // è¡¨æ¼”çš„èŠ‚ç›® boolean flag = true; //è¡¨æ¼” public synchronized void play(String voice) &#123; if (!flag) &#123; try &#123; this.wait(); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; &#125; System.out.println(&quot;æ¼”å‘˜è¡¨æ¼”äº†ï¼š&quot; + voice); //é€šçŸ¥è§‚ä¼—è§‚çœ‹ this.notifyAll(); this.voice = voice; this.flag = !this.flag; &#125; //è§‚çœ‹ public synchronized void watch() &#123; if (flag) &#123; try &#123; this.wait(); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; &#125; System.out.println(&quot;è§‚çœ‹äº†ï¼š&quot; + voice); //é€šçŸ¥æ¼”å‘˜è¡¨æ¼” this.notifyAll(); this.flag = !this.flag; &#125;&#125; ä½¿ç”¨çº¿ç¨‹æ±  èƒŒæ™¯ï¼šç»å¸¸åˆ›å»ºå’Œé”€æ¯ã€ä½¿ç”¨é‡ç‰¹åˆ«å¤§çš„èµ„æºï¼Œæ¯”å¦‚å¹¶å‘æƒ…å†µä¸‹çš„çº¿ç¨‹ï¼Œå¯¹æ€§èƒ½å½±å“å¾ˆå¤§ã€‚ æ€è·¯ï¼šæå‰åˆ›å»ºå¥½å¤šä¸ªçº¿ç¨‹ï¼Œæ”¾å…¥çº¿ç¨‹æ± ä¸­ï¼Œä½¿ç”¨æ—¶ç›´æ¥è·å–ï¼Œä½¿ç”¨å®Œæ”¾å›æ± ä¸­ã€‚å¯ä»¥é¿å…é¢‘ç¹åˆ›å»ºé”€æ¯ã€å®ç°é‡å¤åˆ©ç”¨ã€‚ç±»ä¼¼ç”Ÿæ´»ä¸­çš„å…¬å…±äº¤é€šå·¥å…·ã€‚ ä¼˜ç‚¹ï¼š æé«˜å“åº”é€Ÿåº¦ï¼ˆå‡å°‘äº†åˆ›å»ºæ–°çº¿ç¨‹çš„æ—¶é—´ï¼‰ é™ä½èµ„æºæ¶ˆè€—ï¼ˆé‡å¤åˆ©ç”¨çº¿ç¨‹æ± ä¸­çº¿ç¨‹ï¼Œä¸éœ€è¦æ¯æ¬¡éƒ½åˆ›å»ºï¼‰ ä¾¿äºçº¿ç¨‹ç®¡ç†â€¦ corePoolSizeï¼šæ ¸å¿ƒæ± çš„å¤§å° maximumPoolSizeï¼šæœ€å¤§çº¿ç¨‹æ•° keepAliveTimeï¼šçº¿ç¨‹æ²¡æœ‰ä»»åŠ¡æ—¶æœ€å¤šä¿æŒå¤šé•¿æ—¶é—´ä¼šç»ˆæ­¢ æ¡ˆä¾‹ï¼š 123456789101112131415161718192021222324252627//æµ‹è¯•çº¿ç¨‹æ± public class TestPool &#123; public static void main(String[] args) &#123; //1.åˆ›å»ºæœåŠ¡ï¼Œåˆ›å»ºçº¿ç¨‹æ±  ExecutorService service = Executors.newFixedThreadPool(10); service.execute(new MyThread()); service.execute(new MyThread()); service.execute(new MyThread()); service.execute(new MyThread()); service.execute(new MyThread()); //2.å…³é—­é“¾æ¥ service.shutdown(); &#125;&#125;class MyThread implements Runnable &#123; @Override public void run() &#123; //for (int i = 0; i &lt; 100; i++) &#123; System.out.println(Thread.currentThread().getName()); //&#125; &#125;&#125; çº¿ç¨‹æ€»ç»“åˆ›å»ºçº¿ç¨‹çš„ä¸‰ç§æ–¹å¼ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546public class ThreadNew &#123; public static void main(String[] args) &#123; new MyThread1().start(); new Thread(new MyThread2()).start(); FutureTask&lt;Integer&gt; futureTask = new FutureTask&lt;Integer&gt;(new MyThread3()); new Thread(futureTask).start(); try &#123; Integer integer = futureTask.get(); System.out.println(integer); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; catch (ExecutionException e) &#123; e.printStackTrace(); &#125; &#125;&#125;//1.ç»§æ‰¿Threadç±»class MyThread1 extends Thread &#123; @Override public void run() &#123; System.out.println(&quot;MyThread1&quot;); &#125;&#125;//å®ç°Runnableæ¥å£class MyThread2 implements Runnable &#123; @Override public void run() &#123; System.out.println(&quot;MyThread2&quot;); &#125;&#125;//å®ç°Callableæ¥å£class MyThread3 implements Callable&lt;Integer&gt; &#123; @Override public Integer call() throws Exception &#123; System.out.println(&quot;MyThread3&quot;); return 100; &#125;&#125;","categories":[],"tags":[]},{"title":"è®¾è®¡æ¨¡å¼","slug":"è®¾è®¡æ¨¡å¼","date":"2022-03-04T06:59:14.547Z","updated":"2022-03-04T06:59:47.654Z","comments":true,"path":"2022/03/04/è®¾è®¡æ¨¡å¼/","link":"","permalink":"https://blog.jiascu.top/2022/03/04/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/","excerpt":"","text":"23ç§è®¾è®¡æ¨¡å¼ï¼ˆGoF 23ï¼‰æœ‰äººæ¨èéŸ©é¡ºå¹³çš„ æ–‡æ¡£ç¬”è®°ï¼š(5æ¡æ¶ˆæ¯) (ç‹‚ç¥)åˆè¯†è®¾è®¡æ¨¡å¼ç¬”è®°_æ„¿ä½ æ‹¥æœ‰å¤§é£ä¸çƒˆé…’,ä¹Ÿèƒ½äº«å—å­¤ç‹¬ä¸è‡ªç”±-CSDNåšå®¢_ç‹‚ç¥è®¾è®¡æ¨¡å¼ç¬”è®° è®¾è®¡æ¨¡å¼åˆ†ç±» åˆ›å»ºå‹æ¨¡å¼ï¼ˆnewå¯¹è±¡ï¼‰ï¼šæè¿°æ€ä¹ˆåˆ›å»ºä¸€ä¸ªå¯¹è±¡ï¼Œå¹¶ä½¿å¾—åˆ›å»ºå¯¹è±¡å’Œä½¿ç”¨å¯¹è±¡åˆ†ç¦»ï¼Œå°±æ˜¯ä¸åœ¨ä¸€ä¸ªä»£ç å—é‡Œé¢ ç»“æ„å‹æ¨¡å¼ï¼šæè¿°æ€ä¹ˆæ¥è®¾è®¡ç±»çš„ç»“æ„ è¡Œä¸ºå‹æ¨¡å¼ï¼šæè¿°ç±»æˆ–å¯¹è±¡ä¹‹é—´æ€ä¹ˆç›¸äº’åä½œï¼Œå»å®Œæˆå•ä¸ªå¯¹è±¡ä¸èƒ½å®Œæˆçš„ä»»åŠ¡ OOPä¸ƒå¤§åŸåˆ™ å•ä¾‹æ¨¡å¼(éœ€è¡¥å……ï¼Œå¹¶å‘ä¸ä¼š) é¥¿æ±‰å¼å•ä¾‹ 1234567891011121314151617181920// é¥¿æ±‰å¼å•ä¾‹public class Hungry &#123; //å¯èƒ½ä¼šæµªè´¹ç©ºé—´ private byte[] data1 = new byte[1024*1024]; private byte[] data2 = new byte[1024*1024]; private byte[] data3 = new byte[1024*1024]; private byte[] data4 = new byte[1024*1024]; private Hungry()&#123; &#125; private final static Hungry HUNGRY = new Hungry(); public static Hungry getInstance()&#123; return HUNGRY; &#125;&#125; åŒé‡æ£€æµ‹é”æ¨¡å¼çš„ æ‡’æ±‰å¼å•ä¾‹ DCLæ‡’æ±‰å¼ 12345678910111213141516171819202122232425262728293031323334353637383940//æ‡’æ±‰å¼å•ä¾‹public class LazyMan &#123; private LazyMan()&#123; //System.out.println(Thread.currentThread().getName() + &quot;ok&quot;); &#125; private volatile static LazyMan lazyMan; //åŒé‡æ£€æµ‹é”æ¨¡å¼çš„ æ‡’æ±‰å¼å•ä¾‹ DCLæ‡’æ±‰å¼ public static LazyMan getInstance()&#123; if (lazyMan == null)&#123; synchronized (LazyMan.class) &#123; if (lazyMan == null) &#123; lazyMan = new LazyMan();//ä¸æ˜¯ä¸€ä¸ªåŸå­æ€§æ“ä½œ &#125; &#125; &#125; return lazyMan; &#125; /** * 1. åˆ†é…å†…å­˜ç©ºé—´ * 2. æ‰§è¡Œæ„é€ æ–¹æ³•ï¼Œåˆå§‹åŒ–å¯¹è±¡ * 3. æŠŠè¿™ä¸ªå¯¹è±¡æŒ‡å‘è¿™ä¸ªç©ºé—´ * * 123 * 132 A * B // æ­¤æ—¶lazyManè¿˜æ²¡æœ‰å®Œæˆæ„é€  */ // // å¤šçº¿ç¨‹å¹¶å‘ // public static void main(String[] args) &#123; // for (int i = 0; i &lt; 10; i++) &#123; // new Thread(()-&gt;&#123; // LazyMan.getInstance(); // &#125;).start(); // &#125; // &#125;&#125; å·¥å‚æ¨¡å¼ ç®€å•(é™æ€)å·¥å‚æ¨¡å¼ ä¸æ»¡è¶³å¼€é—­åŸåˆ™ 123456789101112131415161718192021222324//é™æ€å·¥å‚æ¨¡å¼public class CarFactory &#123; //æ–¹æ³•ä¸€ public static Car getCar(String car)&#123; if (car.equals(&quot;äº”è±&quot;))&#123; return new WuLing(); &#125;else if (car.equals(&quot;ç‰¹æ–¯æ‹‰&quot;))&#123; return new Tesla(); &#125;else &#123; return null; &#125; &#125; //æ–¹æ³•äºŒ public static Car getWuling()&#123; return new WuLing(); &#125; public static Car getTesla()&#123; return new Tesla(); &#125;&#125; å·¥å‚æ–¹æ³•æ¨¡å¼ æ»¡è¶³å¼€é—­åŸåˆ™ ä»£ç ç»“æ„ï¼š æ¯”è¾ƒ ç»“æ„å¤æ‚åº¦: simple ä»£ç å¤æ‚åº¦: simple ç¼–ç¨‹å¤æ‚åº¦: simple ç®¡ç†ä¸Šçš„å¤æ‚åº¦: simple æ ¹æ®è®¾è®¡åŸåˆ™:å·¥å‚æ–¹æ³•æ¨¡å¼! æ ¹æ®å®é™…ä¸šåŠ¡:ç®€å•å·¥å‚æ¨¡å¼! æŠ½è±¡å·¥å‚æ¨¡å¼æŠ½è±¡çš„æŠ½è±¡ å›´ç»•ä¸€ä¸ªè¶…çº§å·¥å‚åˆ›å»ºå…¶ä»–å·¥å‚ï¼Œè¯¥è¶…çº§å·¥å‚åˆç§°ä¸ºå…¶ä»–å·¥å‚çš„å·¥å‚ UMLç±»å›¾ äº§å“æ—ä¸äº§å“ç­‰çº§ å»ºé€ è€…æ¨¡å¼ æ–¹å¼ä¸€ æ–¹å¼äºŒï¼Œç®€åŒ–ï¼šå»é™¤director ä¼˜ç¼ºç‚¹ã€åº”ç”¨åœºæ™¯ã€æ¯”è¾ƒï¼š åŸå‹æ¨¡å¼å…‹éš†ï¼šæµ…å…‹éš†ä¸æ·±å…‹éš† æ·±å…‹éš†ï¼š æ”¹é€ cloneæ–¹æ³• åºåˆ—åŒ–ä¸ååºåˆ—åŒ–ï¼šæ€§èƒ½æ¯”è¾ƒä½ä¸‹ é€‚é…å™¨æ¨¡å¼é€‚é…å™¨ï¼š ç»§æ‰¿ï¼ˆç±»é€‚é…å™¨ï¼Œå•ç»§æ‰¿ï¼‰ 123456public class Adapter extends Adaptee implements NetToUsb&#123; @Override public void handleRequest() &#123; super.request(); //å¯ä»¥ä¸Šç½‘äº† &#125;&#125; ç»„åˆ ï¼ˆå¯¹è±¡é€‚é…å™¨ï¼šå¸¸ç”¨ï¼‰ æ¨èï¼ï¼ï¼ 12345678910public class Adapter2 implements NetToUsb&#123; private Adaptee adaptee; public Adapter2(Adaptee adaptee) &#123; this.adaptee = adaptee; &#125; @Override public void handleRequest() &#123; adaptee.request(); &#125;&#125; ç¤ºä¾‹ï¼šç½‘çº¿â€”â€”è½¬æ¢å™¨â€”â€”ç”µè„‘æ¥å£ ä¼˜ç¼ºç‚¹ æ¡¥æ¥æ¨¡å¼ æ¡¥æ¥æ¨¡å¼ æ¡¥æ¥æ¨¡å¼æ˜¯å°†æŠ½è±¡éƒ¨åˆ†ä¸å®ƒçš„å®ç°éƒ¨åˆ†åˆ†ç¦», ä½¿ä»–ä»¬éƒ½å¯ä»¥ç‹¬ç«‹åœ°å˜åŒ–, å®ƒæ˜¯ä¸€ç§å¯¹è±¡ç»“æ„å‹æ¨¡å¼, åˆç§°ä¸ºæŸ„ä½“(Handle and Body)æ¨¡å¼æˆ–æ¥å£(Interface)æ¨¡å¼ ä¼˜åŠ£ ä»£ç†æ¨¡å¼ é™æ€ä»£ç† è§’è‰²åˆ†æ: æŠ½è±¡è§’è‰²: ä¸€èˆ¬ä¼šä½¿ç”¨æ¥å£æˆ–æŠ½è±¡ç±»æ¥è§£å†³ çœŸå®è§’è‰²: è¢«ä»£ç†çš„è§’è‰² ä»£ç†è§’è‰²: ä»£ç†çœŸå®è§’è‰²,ä»£ç†çœŸå®è§’è‰²å,æˆ‘ä»¬ä¸€èˆ¬ä¼šåšä¸€äº›é™„å±æ“ä½œ å®¢æˆ·: è®¿é—®ä»£ç†å¯¹è±¡çš„äºº ä»£ç æ­¥éª¤ æ¥å£ çœŸå®è§’è‰² ä»£ç†è§’è‰² å®¢æˆ·ç«¯è®¿é—®ä»£ç†è§’è‰² ä¼˜ç¼ºç‚¹ ä»£ç†æ¨¡å¼çš„å¥½å¤„: å¯ä»¥ä½¿çœŸå®è§’è‰²çš„æ“ä½œæ›´åŠ çº¯ç²¹,ä¸ç”¨å»å…³æ³¨ä¸€äº›å…¬å…±çš„ä¸šåŠ¡ å…¬å…±ä¹Ÿå°±äº¤ç»™ä»£ç†è§’è‰²,å®ç°äº†ä¸šåŠ¡çš„åˆ†å·¥ å…¬å…±ä¸šåŠ¡å‘ç”Ÿæ‰©å±•çš„æ—¶å€™,æ–¹ä¾¿é›†ä¸­ç®¡ç† ç¼ºç‚¹: ä¸€ä¸ªçœŸå®è§’è‰²å°±ä¼šäº§ç”Ÿä¸€ä¸ªä»£ç†è§’è‰²,ä»£ç é‡ä¼šç¿»å€,å¼€å‘æ•ˆç‡ä¼šå˜ä½ é™æ€ä»£ç†å†ç†è§£ åŠ¨æ€ä»£ç† åŠ¨æ€ä»£ç†å’Œé™æ€ä»£ç†è§’è‰²ä¸€æ · åŠ¨æ€ä»£ç†çš„ä»£ç†ç±»æ˜¯åŠ¨æ€ç”Ÿæˆçš„,ä¸æ˜¯æˆ‘ä»¬ç›´æ¥å†™å¥½çš„ åŠ¨æ€ä»£ç†åˆ†ä¸ºä¸¤å¤§ç±» : åŸºäºæ¥å£çš„åŠ¨æ€ä»£ç†,åŸºäºç±»çš„åŠ¨æ€ä»£ç† åŸºäºæ¥å£-JDKåŠ¨æ€ä»£ç†ã€æˆ‘ä»¬åœ¨è¿™é‡Œä½¿ç”¨ã€‘ åŸºäºç±»: cglib javaå­—èŠ‚ç å®ç° : javassist éœ€è¦äº†è§£çš„ä¸¤ä¸ªç±»: Proxy: ä»£ç†, InvocationHandler: è°ƒç”¨å¤„ç†ç¨‹åº InvocationHandler(è°ƒç”¨å¤„ç†ç¨‹åº) 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647package com.jia.proxy.demo04;import com.jia.proxy.demo03.Rent;import java.lang.reflect.InvocationHandler;import java.lang.reflect.Method;import java.lang.reflect.Proxy;/** * User: jia * Time: 2022/2/16 19:10 * Description: * Version: *///æˆ–ç”¨è¿™ä¸ªç±»è‡ªåŠ¨ç”Ÿæˆä»£ç†ç±»public class ProxyInvocationHandler implements InvocationHandler &#123; //è¢«ä»£ç†çš„æ¥å£ private Object target; public void setTarget(Object target) &#123; this.target = target; &#125; //ç”Ÿæˆå¾—åˆ°ä»£ç†ç±» public Object getProxy()&#123; return Proxy.newProxyInstance(this.getClass().getClassLoader(), target.getClass().getInterfaces(),this); &#125; // proxy : ä»£ç†ç±» // method : ä»£ç†ç±»çš„è°ƒç”¨å¤„ç†ç¨‹åºçš„æ–¹æ³•å¯¹è±¡. public Object invoke(Object proxy, Method method, Object[] args) throws Throwable &#123; log(method.getName()); //åŠ¨æ€ä»£ç†çš„æœ¬è´¨,å°±æ˜¯ä½¿ç”¨åå°„æœºåˆ¶å®ç° Object result = method.invoke(target, args); return result; &#125; public void log(String methodName)&#123; System.out.println(&quot;æ‰§è¡Œäº†&quot;+methodName+&quot;æ–¹æ³•&quot;); &#125;&#125; å¥½å¤„ é™æ€ä»£ç†æœ‰çš„å®ƒéƒ½æœ‰ï¼Œé™æ€ä»£ç†æ²¡æœ‰çš„ï¼Œå®ƒä¹Ÿæœ‰ï¼ å¯ä»¥ä½¿å¾—æˆ‘ä»¬çš„çœŸå®è§’è‰²æ›´åŠ çº¯ç²¹ . ä¸å†å»å…³æ³¨ä¸€äº›å…¬å…±çš„äº‹æƒ… . å…¬å…±çš„ä¸šåŠ¡ç”±ä»£ç†æ¥å®Œæˆ . å®ç°äº†ä¸šåŠ¡çš„åˆ†å·¥ , å…¬å…±ä¸šåŠ¡å‘ç”Ÿæ‰©å±•æ—¶å˜å¾—æ›´åŠ é›†ä¸­å’Œæ–¹ä¾¿ . ä¸€ä¸ªåŠ¨æ€ä»£ç† , ä¸€èˆ¬ä»£ç†æŸä¸€ç±»ä¸šåŠ¡ ä¸€ä¸ªåŠ¨æ€ä»£ç†å¯ä»¥ä»£ç†å¤šä¸ªç±»ï¼Œä»£ç†çš„æ˜¯æ¥å£ï¼","categories":[],"tags":[]},{"title":"JUCå¹¶å‘ç¼–ç¨‹","slug":"JUCå¹¶å‘ç¼–ç¨‹","date":"2022-03-04T06:49:05.545Z","updated":"2022-03-04T06:49:36.258Z","comments":true,"path":"2022/03/04/JUCå¹¶å‘ç¼–ç¨‹/","link":"","permalink":"https://blog.jiascu.top/2022/03/04/JUC%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/","excerpt":"","text":"JUCå¹¶å‘ç¼–ç¨‹ç¬”è®°ï¼š JUCå¹¶å‘ç¼–ç¨‹ç¬”è®°ï¼ˆç‹‚ç¥è¯´ï¼‰ - ä½ æˆ‘ä¸åœ¨å¹´å°‘ - åšå®¢å›­ (cnblogs.com) https://blog.csdn.net/weixin_44491927/article/details/108560692 https://www.cnblogs.com/futuresky/p/15016732.html ä»€ä¹ˆæ˜¯JUCJUCå°±æ˜¯java.util.concurrentä¸‹é¢çš„ç±»åŒ…ï¼Œä¸“é—¨ç”¨äºå¤šçº¿ç¨‹çš„å¼€å‘ concurrentï¼šåŒæ—¶ï¼Œå¹¶å‘ java.util å·¥å…·åŒ… ä¸šåŠ¡ï¼šæ— æ³•é€šè¿‡æ™®é€šçš„çº¿ç¨‹ä»£ç  Threadå®ç°ã€‚ Runnable æ²¡æœ‰è¿”å›å€¼ã€æ•ˆç‡ç›¸æ¯”äºCallableç›¸å¯¹è¾ƒä½ï¼ ä¼ä¸šå¼€å‘ä¸­Callable ä½¿ç”¨è¾ƒå¤š çº¿ç¨‹å’Œè¿›ç¨‹ è¿›ç¨‹æ˜¯æ“ä½œç³»ç»Ÿä¸­çš„åº”ç”¨ç¨‹åºã€æ˜¯èµ„æºåˆ†é…çš„åŸºæœ¬å•ä½ï¼Œçº¿ç¨‹æ˜¯ç”¨æ¥æ‰§è¡Œå…·ä½“çš„ä»»åŠ¡å’ŒåŠŸèƒ½ï¼Œæ˜¯CPUè°ƒåº¦å’Œåˆ†æ´¾çš„æœ€å°å•ä½ ä¸€ä¸ªè¿›ç¨‹å¾€å¾€å¯ä»¥åŒ…å«å¤šä¸ªçº¿ç¨‹ï¼Œè‡³å°‘åŒ…å«ä¸€ä¸ª è¿›ç¨‹è¿›ç¨‹æ˜¯ç¨‹åºçš„ä¸€æ¬¡æ‰§è¡Œï¼ŒQQ.EXE Music.EXEï¼›ç¨‹åºçš„é›†åˆ ä¸€ä¸ªè¿›ç¨‹å¯ä»¥åŒ…å«å¤šä¸ªçº¿ç¨‹ï¼Œè‡³å°‘åŒ…å«ä¸€ä¸ªçº¿ç¨‹ï¼ Javaé»˜è®¤æœ‰å‡ ä¸ªçº¿ç¨‹ï¼Ÿ2ä¸ªçº¿ç¨‹ï¼ mainçº¿ç¨‹ã€GCçº¿ç¨‹ çº¿ç¨‹å¼€äº†ä¸€ä¸ªè¿›ç¨‹Typoraï¼Œå†™å­—ï¼Œç­‰å¾…å‡ åˆ†é’Ÿä¼šè¿›è¡Œè‡ªåŠ¨ä¿å­˜(çº¿ç¨‹è´Ÿè´£çš„) å¯¹äºJavaè€Œè¨€ï¼šThreadã€Runableã€Callableè¿›è¡Œå¼€å¯çº¿ç¨‹çš„ã€‚ &#x3D;&#x3D;æé—®ï¼ŸJAVAçœŸçš„å¯ä»¥å¼€å¯çº¿ç¨‹å—ï¼Ÿ å¼€ä¸äº†çš„ï¼&#x3D;&#x3D; Javaæ˜¯æ²¡æœ‰æƒé™å»å¼€å¯çº¿ç¨‹ã€æ“ä½œç¡¬ä»¶çš„ï¼Œè¿™æ˜¯ä¸€ä¸ªnativeçš„ä¸€ä¸ªæœ¬åœ°æ–¹æ³•ï¼Œå®ƒè°ƒç”¨çš„åº•å±‚çš„C++ä»£ç ã€‚ å¹¶å‘å¤šçº¿ç¨‹æ“ä½œåŒä¸€ä¸ªèµ„æºã€‚ CPU åªæœ‰ä¸€æ ¸ï¼Œæ¨¡æ‹Ÿå‡ºæ¥å¤šæ¡çº¿ç¨‹ï¼Œå¤©ä¸‹æ­¦åŠŸï¼Œå”¯å¿«ä¸ç ´ã€‚é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨CPUå¿«é€Ÿäº¤æ›¿ï¼Œæ¥æ¨¡æ‹Ÿå¤šçº¿ç¨‹ã€‚ å¹¶å‘ç¼–ç¨‹çš„æœ¬è´¨ï¼šå……åˆ†åˆ©ç”¨CPUçš„èµ„æºï¼ å¹¶è¡Œå¹¶è¡Œï¼š å¤šä¸ªäººä¸€èµ·è¡Œèµ° CPUå¤šæ ¸ï¼Œå¤šä¸ªçº¿ç¨‹å¯ä»¥åŒæ—¶æ‰§è¡Œã€‚ æˆ‘ä»¬å¯ä»¥ä½¿ç”¨çº¿ç¨‹æ± ï¼ è·å–cpuçš„çº¿ç¨‹æ•°ï¼ˆé€»è¾‘å¤„ç†å™¨ï¼‰ 123456public class Test1 &#123; public static void main(String[] args) &#123; //è·å–cpuçš„æ ¸æ•° System.out.println(Runtime.getRuntime().availableProcessors()); &#125;&#125; çº¿ç¨‹çš„çŠ¶æ€12345678910111213141516171819public enum State &#123; //æ–°ç”Ÿ NEW, //è¿è¡Œ RUNNABLE, //é˜»å¡ BLOCKED, //ç­‰å¾… WAITING, //è¶…æ—¶ç­‰å¾… TIMED_WAITING, //ç»ˆæ­¢ TERMINATED;&#125; wait&#x2F;sleep1ã€æ¥è‡ªä¸åŒçš„ç±» wait &#x3D;&gt; Object sleep &#x3D;&gt; Thread ä¸€èˆ¬æƒ…å†µä¼ä¸šä¸­ä½¿ç”¨ä¼‘çœ æ˜¯ï¼š 12TimeUnit.DAYS.sleep(1); //ä¼‘çœ 1å¤©TimeUnit.SECONDS.sleep(1); //ä¼‘çœ 1s 2ã€å…³äºé”çš„é‡Šæ”¾ wait ä¼šé‡Šæ”¾é”ï¼› sleepç¡è§‰äº†ï¼Œä¸ä¼šé‡Šæ”¾é”ï¼› 3ã€ä½¿ç”¨çš„èŒƒå›´æ˜¯ä¸åŒçš„ wait å¿…é¡»åœ¨åŒæ­¥ä»£ç å—ä¸­ï¼› sleep å¯ä»¥åœ¨ä»»ä½•åœ°æ–¹ç¡ï¼› 4ã€æ˜¯å¦éœ€è¦æ•è·å¼‚å¸¸ waitä¹Ÿéœ€è¦æ•è·å¼‚å¸¸ï¼›ï¼ˆç½‘ä¸Šéå¸¸å¤šçš„ä»£ç è¯´ä¸ç”¨æŠ›å‡ºå¼‚å¸¸ï¼Œåº”è¯¥æ˜¯æ²¡å»çœ‹æºç å’Œå°è¯•å§ï¼Œä¸‹é¢é™„å›¾ï¼Œå…¶å®æ–‡ç« ä¸Šä¸€å¼ æºç çš„å›¾ä¹Ÿæ˜¾ç¤ºéœ€è¦æŠ›å‡ºå¼‚å¸¸ï¼‰ï¼Œnotifyå’ŒnotifyAllä¸éœ€è¦æ•è·å¼‚å¸¸ã€‚ï¼‰ä¸­æ–­ sleepå¿…é¡»è¦æ•è·å¼‚å¸¸ï¼› Locké”ï¼ˆé‡ç‚¹ï¼‰ä¼ ç»Ÿçš„ synchronized12345678910111213141516171819202122232425262728293031323334353637383940public class SaleTicketDemo01 &#123; public static void main(String[] args) &#123; // å¹¶å‘ï¼šå¤šçº¿ç¨‹æ“ä½œåŒä¸€ä¸ªèµ„æºç±», æŠŠèµ„æºç±»ä¸¢å…¥çº¿ç¨‹ Ticket ticket = new Ticket(); // @FunctionalInterface å‡½æ•°å¼æ¥å£ï¼Œjdk1.8 lambdaè¡¨è¾¾å¼ (å‚æ•°)-&gt;&#123; ä»£ç  &#125; new Thread(()-&gt;&#123; for (int i = 1; i &lt; 40 ; i++) &#123; ticket.sale(); &#125; &#125;,&quot;A&quot;).start(); new Thread(()-&gt;&#123; for (int i = 1; i &lt; 40 ; i++) &#123; ticket.sale(); &#125; &#125;,&quot;B&quot;).start(); new Thread(()-&gt;&#123; for (int i = 1; i &lt; 40 ; i++) &#123; ticket.sale(); &#125; &#125;,&quot;C&quot;).start(); &#125;&#125;// èµ„æºç±» OOPclass Ticket &#123; // å±æ€§ã€æ–¹æ³• private int number = 30; // å–ç¥¨çš„æ–¹å¼ // synchronized æœ¬è´¨: é˜Ÿåˆ—ï¼Œé” public synchronized void sale()&#123; if (number&gt;0)&#123; System.out.println(Thread.currentThread().getName()+&quot;å–å‡ºäº†&quot;+(number--)+&quot;ç¥¨,å‰©ä½™ï¼š&quot;+number); &#125; &#125;&#125; Lock å…¬å¹³é”ï¼š ååˆ†å…¬å¹³ï¼Œå¿…é¡»å…ˆæ¥ååˆ°~ï¼› éå…¬å¹³é”ï¼š ååˆ†ä¸å…¬å¹³ï¼Œå¯ä»¥æ’é˜Ÿï¼›**(é»˜è®¤ä¸ºéå…¬å¹³é”)** 1234567891011121314151617181920212223242526272829303132333435363738394041424344public class SaleTicketDemo02 &#123; public static void main(String[] args) &#123; final Ticket2 ticket = new Ticket2(); new Thread(() -&gt; &#123; for (int i = 0; i &lt; 40; i++) &#123; ticket.sale(); &#125; &#125;, &quot;A&quot;).start(); new Thread(() -&gt; &#123; for (int i = 0; i &lt; 40; i++) &#123; ticket.sale(); &#125; &#125;, &quot;B&quot;).start(); new Thread(() -&gt; &#123; for (int i = 0; i &lt; 40; i++) &#123; ticket.sale(); &#125; &#125;, &quot;C&quot;).start(); &#125;&#125;//lockä¸‰éƒ¨æ›²//1ã€ Lock lock=new ReentrantLock();//2ã€ lock.lock() åŠ é”//3ã€ finally=&gt; è§£é”ï¼šlock.unlock();class Ticket2 &#123; private int number = 30; // åˆ›å»ºé” Lock lock = new ReentrantLock(); //å–ç¥¨çš„æ–¹å¼ public synchronized void sale() &#123; lock.lock(); // å¼€å¯é” try &#123; if (number &gt; 0) &#123; System.out.println(Thread.currentThread().getName() + &quot;å–å‡ºäº†ç¬¬&quot; + (number--) + &quot;å¼ ç¥¨å‰©ä½™&quot; + number + &quot;å¼ ç¥¨&quot;); &#125; &#125;finally &#123; lock.unlock(); // å…³é—­é” &#125; &#125;&#125; Synchronized ä¸Lock çš„åŒºåˆ« Synchronized å†…ç½®çš„Javaå…³é”®å­—ï¼ŒLockæ˜¯ä¸€ä¸ªJavaç±» Synchronized æ— æ³•åˆ¤æ–­è·å–é”çš„çŠ¶æ€ï¼ŒLockå¯ä»¥åˆ¤æ–­ Synchronized ä¼šè‡ªåŠ¨é‡Šæ”¾é”ï¼Œlockå¿…é¡»è¦æ‰‹åŠ¨åŠ é”å’Œæ‰‹åŠ¨é‡Šæ”¾é”ï¼å¯èƒ½ä¼šé‡åˆ°æ­»é” Synchronized çº¿ç¨‹1(è·å¾—é”-&gt;é˜»å¡)ã€çº¿ç¨‹2(ç­‰å¾…)ï¼›lockå°±ä¸ä¸€å®šä¼šä¸€ç›´ç­‰å¾…ä¸‹å»ï¼Œlockä¼šæœ‰ä¸€ä¸ªtrylockå»å°è¯•è·å–é”ï¼Œä¸ä¼šé€ æˆé•¿ä¹…çš„ç­‰å¾…ã€‚ Synchronized æ˜¯å¯é‡å…¥é”ï¼Œä¸å¯ä»¥ä¸­æ–­çš„ï¼Œéå…¬å¹³çš„ï¼›Lockï¼Œå¯é‡å…¥çš„ï¼Œå¯ä»¥åˆ¤æ–­é”ï¼Œå¯ä»¥è‡ªå·±è®¾ç½®å…¬å¹³é”å’Œéå…¬å¹³é”ï¼› Synchronized é€‚åˆé”å°‘é‡çš„ä»£ç åŒæ­¥é—®é¢˜ï¼ŒLocké€‚åˆé”å¤§é‡çš„åŒæ­¥ä»£ç ï¼› ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…é—®é¢˜é¢è¯•ï¼šå•ä¾‹æ¨¡å¼ã€æ’åºç®—æ³•ã€ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…ã€æ­»é”é—®é¢˜ waitæ–¹æ³•ï¼šä¼šé‡Šæ”¾é”ï¼ Synchronized ç‰ˆ1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162/** * çº¿ç¨‹ä¹‹é—´çš„é€šä¿¡é—®é¢˜ï¼šç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…é—®é¢˜ï¼ ç­‰å¾…å”¤é†’ï¼Œé€šçŸ¥å”¤é†’ * çº¿ç¨‹äº¤æ›¿æ‰§è¡Œ A B æ“ä½œåŒä¸€ä¸ªå˜é‡ num = 0 * A num+1 * B num-1 *///é¡ºåºï¼šåˆ¤æ–­å¾…-&gt;ä¸šåŠ¡-&gt;é€šçŸ¥public class A &#123; public static void main(String[] args) &#123; Data data = new Data(); new Thread(() -&gt; &#123; for (int i = 0; i &lt; 10; i++) &#123; try &#123; data.increment(); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; &#125; &#125;, &quot;A&quot;).start(); new Thread(() -&gt; &#123; for (int i = 0; i &lt; 10; i++) &#123; try &#123; data.decrement(); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; &#125; &#125;,&quot;B&quot;).start(); &#125;&#125;class Data &#123; private int number = 0; //+1 public synchronized void increment() throws InterruptedException &#123; if (number != 0) &#123; //ç­‰å¾… this.wait(); &#125; number++; System.out.println(Thread.currentThread().getName() + &quot;=&gt;&quot; + number); // é€šçŸ¥å…¶ä»–çº¿ç¨‹ï¼Œæˆ‘+1å®Œæ¯•äº† this.notifyAll(); &#125; //-1 public synchronized void decrement() throws InterruptedException &#123; if (number == 0) &#123; //ç­‰å¾… this.wait(); &#125; number--; System.out.println(Thread.currentThread().getName() + &quot;=&gt;&quot; + number); // é€šçŸ¥å…¶ä»–çº¿ç¨‹ï¼Œæˆ‘-1å®Œæ¯•äº† this.notifyAll(); &#125;&#125; å­˜åœ¨é—®é¢˜ï¼ˆè™šå‡å”¤é†’ï¼‰ é—®é¢˜ï¼Œå¦‚æœæœ‰å››ä¸ªçº¿ç¨‹ï¼Œä¼šå‡ºç°è™šå‡å”¤é†’ è§£å†³æ–¹å¼ ï¼Œif æ”¹ä¸ºwhileå³å¯ï¼Œé˜²æ­¢è™šå‡å”¤é†’ ç»“è®ºï¼šå°±æ˜¯ç”¨ifåˆ¤æ–­çš„è¯ï¼Œå”¤é†’åçº¿ç¨‹ä¼šä»waitä¹‹åçš„ä»£ç å¼€å§‹è¿è¡Œï¼Œä½†æ˜¯ä¸ä¼šé‡æ–°åˆ¤æ–­ifæ¡ä»¶ï¼Œç›´æ¥ç»§ç»­è¿è¡Œifä»£ç å—ä¹‹åçš„ä»£ç ï¼Œè€Œå¦‚æœä½¿ç”¨whileçš„è¯ï¼Œä¹Ÿä¼šä»waitä¹‹åçš„ä»£ç è¿è¡Œï¼Œä½†æ˜¯å”¤é†’åä¼šé‡æ–°åˆ¤æ–­å¾ªç¯æ¡ä»¶ï¼Œå¦‚æœä¸æˆç«‹å†æ‰§è¡Œwhileä»£ç å—ä¹‹åçš„ä»£ç å—ï¼Œæˆç«‹çš„è¯ç»§ç»­waitã€‚è¿™ä¹Ÿå°±æ˜¯ä¸ºä»€ä¹ˆç”¨whileè€Œä¸ç”¨ifçš„åŸå› äº†ï¼Œå› ä¸ºçº¿ç¨‹è¢«å”¤é†’åï¼Œæ‰§è¡Œå¼€å§‹çš„åœ°æ–¹æ˜¯waitä¹‹å ä»£ç ï¼šæœ‰é—®é¢˜ï¼Œå››ä¸ªçº¿ç¨‹ä¸èƒ½è·‘å®Œå››ä¸ªå¾ªç¯ï¼ˆè¾“å‡ºçš„ä¸æ˜¯40ä¸ªï¼‰ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677public class A &#123; public static void main(String[] args) &#123; Data data = new Data(); new Thread(() -&gt; &#123; for (int i = 0; i &lt; 10; i++) &#123; try &#123; data.increment(); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; &#125; &#125;, &quot;A&quot;).start(); new Thread(() -&gt; &#123; for (int i = 0; i &lt; 10; i++) &#123; try &#123; data.decrement(); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; &#125; &#125;,&quot;B&quot;).start(); new Thread(() -&gt; &#123; for (int i = 0; i &lt; 10; i++) &#123; try &#123; data.increment(); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; &#125; &#125;, &quot;C&quot;).start(); new Thread(() -&gt; &#123; for (int i = 0; i &lt; 10; i++) &#123; try &#123; data.increment(); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; &#125; &#125;, &quot;D&quot;).start(); &#125;&#125;class Data &#123; private int number = 0; //+1 public synchronized void increment() throws InterruptedException &#123; while (number != 0) &#123; //ç­‰å¾… this.wait(); &#125; number++; System.out.println(Thread.currentThread().getName() + &quot;=&gt;&quot; + number); // é€šçŸ¥å…¶ä»–çº¿ç¨‹ï¼Œæˆ‘-1å®Œæ¯•äº† this.notifyAll(); &#125; //-1 public synchronized void decrement() throws InterruptedException &#123; while (number == 0) &#123; //ç­‰å¾… this.wait(); &#125; number--; System.out.println(Thread.currentThread().getName() + &quot;=&gt;&quot; + number); // é€šçŸ¥å…¶ä»–çº¿ç¨‹ï¼Œæˆ‘-1å®Œæ¯•äº† this.notifyAll(); &#125;&#125; Lockç‰ˆï¼ˆJUCï¼‰ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485public class B &#123; public static void main(String[] args) &#123; Data2 data = new Data2(); new Thread(() -&gt; &#123; for (int i = 0; i &lt; 10; i++) &#123; try &#123; data.increment(); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; &#125; &#125;, &quot;A&quot;).start(); new Thread(() -&gt; &#123; for (int i = 0; i &lt; 10; i++) &#123; try &#123; data.decrement(); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; &#125; &#125;, &quot;B&quot;).start(); new Thread(() -&gt; &#123; for (int i = 0; i &lt; 10; i++) &#123; try &#123; data.increment(); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; &#125; &#125;, &quot;C&quot;).start(); new Thread(() -&gt; &#123; for (int i = 0; i &lt; 10; i++) &#123; try &#123; data.decrement(); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; &#125; &#125;, &quot;D&quot;).start(); &#125;&#125;class Data2 &#123; private int num = 0; Lock lock = new ReentrantLock(); Condition condition = lock.newCondition(); // +1 public void increment() throws InterruptedException &#123; lock.lock(); try &#123; // åˆ¤æ–­ç­‰å¾… while (num != 0) &#123; condition.await(); &#125; num++; System.out.println(Thread.currentThread().getName() + &quot;=&gt;&quot; + num); // é€šçŸ¥å…¶ä»–çº¿ç¨‹ +1 æ‰§è¡Œå®Œæ¯• condition.signalAll(); &#125;finally &#123; lock.unlock(); &#125; &#125; // -1 public void decrement() throws InterruptedException &#123; lock.lock(); try &#123; // åˆ¤æ–­ç­‰å¾… while (num == 0) &#123; condition.await(); &#125; num--; System.out.println(Thread.currentThread().getName() + &quot;=&gt;&quot; + num); // é€šçŸ¥å…¶ä»–çº¿ç¨‹ +1 æ‰§è¡Œå®Œæ¯• condition.signalAll(); &#125;finally &#123; lock.unlock(); &#125; &#125;&#125; Conditionçš„ä¼˜åŠ¿ ç²¾å‡†çš„é€šçŸ¥å’Œå”¤é†’çš„çº¿ç¨‹ï¼ å¦‚æœæˆ‘ä»¬è¦æŒ‡å®šé€šçŸ¥çš„ä¸‹ä¸€ä¸ªè¿›è¡Œé¡ºåºæ€ä¹ˆåŠå‘¢ï¼Ÿ æˆ‘ä»¬å¯ä»¥ä½¿ç”¨Conditionæ¥æŒ‡å®šé€šçŸ¥è¿›ç¨‹~ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091929394959697/** * Descriptionï¼š * A æ‰§è¡Œå®Œ è°ƒç”¨B * B æ‰§è¡Œå®Œ è°ƒç”¨C * C æ‰§è¡Œå®Œ è°ƒç”¨A * * @author jiaoqianjin * Date: 2020/8/11 9:58 **/public class C &#123; public static void main(String[] args) &#123; Data3 data3 = new Data3(); new Thread(() -&gt; &#123; for (int i = 0; i &lt; 10; i++) &#123; data3.printA(); &#125; &#125;,&quot;A&quot;).start(); new Thread(() -&gt; &#123; for (int i = 0; i &lt; 10; i++) &#123; data3.printB(); &#125; &#125;,&quot;B&quot;).start(); new Thread(() -&gt; &#123; for (int i = 0; i &lt; 10; i++) &#123; data3.printC(); &#125; &#125;,&quot;C&quot;).start(); &#125;&#125;class Data3 &#123; private Lock lock = new ReentrantLock(); private Condition condition1 = lock.newCondition(); private Condition condition2 = lock.newCondition(); private Condition condition3 = lock.newCondition(); private int num = 1; // 1A 2B 3C public void printA() &#123; lock.lock(); try &#123; // ä¸šåŠ¡ä»£ç  åˆ¤æ–­ -&gt; æ‰§è¡Œ -&gt; é€šçŸ¥ while (num != 1) &#123; condition1.await(); &#125; System.out.println(Thread.currentThread().getName() + &quot;==&gt; AAAA&quot; ); num = 2; condition2.signal(); &#125;catch (Exception e) &#123; e.printStackTrace(); &#125;finally &#123; lock.unlock(); &#125; &#125; public void printB() &#123; lock.lock(); try &#123; // ä¸šåŠ¡ä»£ç  åˆ¤æ–­ -&gt; æ‰§è¡Œ -&gt; é€šçŸ¥ while (num != 2) &#123; condition2.await(); &#125; System.out.println(Thread.currentThread().getName() + &quot;==&gt; BBBB&quot; ); num = 3; condition3.signal(); &#125;catch (Exception e) &#123; e.printStackTrace(); &#125;finally &#123; lock.unlock(); &#125; &#125; public void printC() &#123; lock.lock(); try &#123; // ä¸šåŠ¡ä»£ç  åˆ¤æ–­ -&gt; æ‰§è¡Œ -&gt; é€šçŸ¥ while (num != 3) &#123; condition3.await(); &#125; System.out.println(Thread.currentThread().getName() + &quot;==&gt; CCCC&quot; ); num = 1; condition1.signal(); &#125;catch (Exception e) &#123; e.printStackTrace(); &#125;finally &#123; lock.unlock(); &#125; &#125;&#125;/*A==&gt; AAAAB==&gt; BBBBC==&gt; CCCCA==&gt; AAAAB==&gt; BBBBC==&gt; CCCC...*/ 8é”ç°è±¡å¦‚ä½•åˆ¤æ–­é”çš„æ˜¯è°ï¼é”åˆ°åº•é”çš„æ˜¯è°ï¼Ÿ é”ä¼šé”ä½ï¼šå¯¹è±¡ã€Class æ·±åˆ»ç†è§£æˆ‘ä»¬çš„é” é—®é¢˜1ä¸¤ä¸ªåŒæ­¥æ–¹æ³•ï¼Œå…ˆæ‰§è¡Œå‘çŸ­ä¿¡è¿˜æ˜¯æ‰“ç”µè¯ 123456789101112131415161718public class Test1 &#123; public static void main(String[] args) throws InterruptedException &#123; Phone phone = new Phone(); new Thread(phone::sendMs).start(); TimeUnit.SECONDS.sleep(1); new Thread(phone::call).start(); &#125;&#125;class Phone &#123; public synchronized void sendMs() &#123; System.out.println(&quot;å‘çŸ­ä¿¡&quot;); &#125; public synchronized void call() &#123; System.out.println(&quot;æ‰“ç”µè¯&quot;); &#125;&#125; ç»“æœï¼šå…ˆå‘çŸ­ä¿¡ï¼Œç„¶åå†æ‰“ç”µè¯ï¼ é—®é¢˜2æˆ‘ä»¬è®©å‘çŸ­ä¿¡ å»¶è¿Ÿ4s 12345678910111213141516171819202122232425public class Test1 &#123; public static void main(String[] args) throws InterruptedException &#123; Phone phone = new Phone(); new Thread(()-&gt;&#123; try &#123; phone.sendMs(); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; &#125;).start(); TimeUnit.SECONDS.sleep(1); new Thread(phone::call).start(); &#125;&#125;class Phone &#123; public synchronized void sendMs() throws InterruptedException &#123; TimeUnit.SECONDS.sleep(4); System.out.println(&quot;å‘çŸ­ä¿¡&quot;); &#125; public synchronized void call() &#123; System.out.println(&quot;æ‰“ç”µè¯&quot;); &#125;&#125; ç»“æœï¼šè¿˜æ˜¯å…ˆå‘çŸ­ä¿¡ï¼Œç„¶åå†æ‰“ç”µè¯ï¼ whyï¼Ÿ åŸå› ï¼šå¹¶ä¸æ˜¯é¡ºåºæ‰§è¡Œï¼Œè€Œæ˜¯synchronized é”ä½çš„å¯¹è±¡æ˜¯æ–¹æ³•çš„è°ƒç”¨è€…ï¼å¯¹äºä¸¤ä¸ªæ–¹æ³•ç”¨çš„æ˜¯åŒä¸€ä¸ªé”ï¼Œè°å…ˆæ‹¿åˆ°è°å…ˆæ‰§è¡Œï¼Œå¦å¤–ä¸€ä¸ªç­‰å¾… é—®é¢˜3åŠ ä¸€ä¸ªæ™®é€šæ–¹æ³•hello 12345678910111213141516171819202122232425262728public class Test2 &#123; public static void main(String[] args) throws InterruptedException &#123; Phone2 phone = new Phone2(); new Thread(() -&gt; &#123; try &#123; phone.sendMs(); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; &#125;).start(); TimeUnit.SECONDS.sleep(1); new Thread(phone::hello).start(); &#125;&#125;class Phone2 &#123; public synchronized void sendMs() throws InterruptedException &#123; TimeUnit.SECONDS.sleep(4); System.out.println(&quot;å‘çŸ­ä¿¡&quot;); &#125; public synchronized void call() &#123; System.out.println(&quot;æ‰“ç”µè¯&quot;); &#125; public void hello() &#123; System.out.println(&quot;hello&quot;); &#125;&#125; ç»“æœï¼šhello å‘çŸ­ä¿¡ åŸå› ï¼šhelloæ˜¯ä¸€ä¸ªæ™®é€šæ–¹æ³•ï¼Œä¸å—synchronizedé”çš„å½±å“ï¼Œä¸ç”¨ç­‰å¾…é”çš„é‡Šæ”¾ é—®é¢˜4å¦‚æœæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯ä¸¤ä¸ªå¯¹è±¡ï¼Œä¸€ä¸ªè°ƒç”¨å‘çŸ­ä¿¡ï¼Œä¸€ä¸ªè°ƒç”¨æ‰“ç”µè¯ï¼Œé‚£ä¹ˆæ•´ä¸ªé¡ºåºæ˜¯æ€ä¹ˆæ ·çš„å‘¢ï¼Ÿ 1234567891011121314151617181920212223242526public class Test2 &#123; public static void main(String[] args) throws InterruptedException &#123; Phone2 phone1 = new Phone2(); Phone2 phone2 = new Phone2(); new Thread(() -&gt; &#123; try &#123; phone1.sendMs(); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; &#125;).start(); TimeUnit.SECONDS.sleep(1); new Thread(phone2::call).start(); &#125;&#125;class Phone2 &#123; public synchronized void sendMs() throws InterruptedException &#123; TimeUnit.SECONDS.sleep(4); System.out.println(&quot;å‘çŸ­ä¿¡&quot;); &#125; public synchronized void call() &#123; System.out.println(&quot;æ‰“ç”µè¯&quot;); &#125;&#125; ç»“æœï¼šæ‰“ç”µè¯ å‘çŸ­ä¿¡ åŸå› ï¼šä¸¤ä¸ªå¯¹è±¡ä¸¤æŠŠé”ï¼Œä¸ä¼šå‡ºç°ç­‰å¾…çš„æƒ…å†µï¼Œå‘çŸ­ä¿¡ç¡äº†4s,æ‰€ä»¥å…ˆæ‰§è¡Œæ‰“ç”µè¯ é—®é¢˜5ï¼Œ6å¦‚æœæˆ‘ä»¬æŠŠsynchronizedçš„æ–¹æ³•åŠ ä¸Šstaticå˜æˆé™æ€æ–¹æ³•ï¼é‚£ä¹ˆé¡ºåºåˆæ˜¯æ€ä¹ˆæ ·çš„å‘¢ï¼Ÿ ï¼ˆ1ï¼‰æˆ‘ä»¬å…ˆæ¥ä½¿ç”¨ä¸€ä¸ªå¯¹è±¡è°ƒç”¨ä¸¤ä¸ªæ–¹æ³•ï¼ ç­”æ¡ˆæ˜¯ï¼šå…ˆå‘çŸ­ä¿¡,åæ‰“ç”µè¯ ï¼ˆ2ï¼‰å¦‚æœæˆ‘ä»¬ä½¿ç”¨ä¸¤ä¸ªå¯¹è±¡è°ƒç”¨ä¸¤ä¸ªæ–¹æ³•ï¼ ç­”æ¡ˆæ˜¯ï¼šè¿˜æ˜¯å…ˆå‘çŸ­ä¿¡ï¼Œåæ‰“ç”µè¯ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950public class Test3 &#123; public static void main(String[] args) &#123; // ä¸¤ä¸ªå¯¹è±¡çš„Classç±»æ¨¡æ¿åªæœ‰ä¸€ä¸ªï¼Œstaticï¼Œé”çš„æ˜¯Class Phone3 phone1 = new Phone3(); Phone3 phone2 = new Phone3(); //é”çš„å­˜åœ¨ new Thread(()-&gt;&#123; phone1.sendSms(); &#125;,&quot;A&quot;).start(); // æ•è· try &#123; TimeUnit.SECONDS.sleep(1); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; new Thread(()-&gt;&#123; phone2.call(); &#125;,&quot;B&quot;).start(); &#125;&#125;// Phone3å”¯ä¸€çš„ä¸€ä¸ª Class å¯¹è±¡class Phone3&#123; // synchronized é”çš„å¯¹è±¡æ˜¯æ–¹æ³•çš„è°ƒç”¨è€…ï¼ // static é™æ€æ–¹æ³• // ç±»ä¸€åŠ è½½å°±æœ‰äº†ï¼é”çš„æ˜¯Class public static synchronized void sendSms()&#123; try &#123; TimeUnit.SECONDS.sleep(4); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; System.out.println(&quot;å‘çŸ­ä¿¡&quot;); &#125; public static synchronized void call()&#123; System.out.println(&quot;æ‰“ç”µè¯&quot;); &#125;&#125; åŸå› æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ ä¸ºä»€ä¹ˆåŠ äº†staticå°±å§‹ç»ˆå‰é¢ä¸€ä¸ªå¯¹è±¡å…ˆæ‰§è¡Œå‘¢ï¼ä¸ºä»€ä¹ˆåé¢ä¼šç­‰å¾…å‘¢ï¼Ÿ åŸå› ï¼šå¯¹äºstaticé™æ€æ–¹æ³•æ¥è¯´ï¼Œå¯¹äºæ•´ä¸ªç±»Classæ¥è¯´åªæœ‰ä¸€ä»½ï¼Œå¯¹äºä¸åŒçš„å¯¹è±¡ä½¿ç”¨çš„æ˜¯åŒä¸€ä»½æ–¹æ³•ï¼Œç›¸å½“äºè¿™ä¸ªæ–¹æ³•æ˜¯å±äºè¿™ä¸ªç±»çš„ï¼Œå¦‚æœé™æ€staticæ–¹æ³•ä½¿ç”¨synchronizedé”å®šï¼Œé‚£ä¹ˆè¿™ä¸ªsynchronizedé”ä¼šé”ä½æ•´ä¸ªå¯¹è±¡ï¼ä¸ç®¡å¤šå°‘ä¸ªå¯¹è±¡ï¼Œå¯¹äºé™æ€çš„é”éƒ½åªæœ‰ä¸€æŠŠé”ï¼Œè°å…ˆæ‹¿åˆ°è¿™ä¸ªé”å°±å…ˆæ‰§è¡Œï¼Œå…¶ä»–çš„è¿›ç¨‹éƒ½éœ€è¦ç­‰å¾…ï¼ é—®é¢˜7ï¼Œ8å¦‚æœæˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªé™æ€åŒæ­¥æ–¹æ³•ã€ä¸€ä¸ªåŒæ­¥æ–¹æ³•ã€ä¸€ä¸ªå¯¹è±¡è°ƒç”¨é¡ºåºæ˜¯ä»€ä¹ˆï¼Ÿ ï¼ˆ1ï¼‰ä¸€ä¸ªå¯¹è±¡ï¼Œå…ˆæ‰“å° å‘çŸ­ä¿¡ï¼Ÿæ‰“ç”µè¯ï¼Ÿ ç­”æ¡ˆæ˜¯ï¼šå…ˆæ‰“ç”µè¯,åå‘çŸ­ä¿¡ ï¼ˆ2ï¼‰ä¸¤ä¸ªå¯¹è±¡ï¼Œå…ˆæ‰“å° å‘çŸ­ä¿¡ï¼Ÿæ‰“ç”µè¯ï¼Ÿ ç­”æ¡ˆæ˜¯ï¼šè¿˜æ˜¯å…ˆå‘çŸ­ä¿¡ï¼Œåæ‰“ç”µè¯ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354import java.util.concurrent.TimeUnit;/** * 1ã€1ä¸ªé™æ€çš„åŒæ­¥æ–¹æ³•ï¼Œ1ä¸ªæ™®é€šçš„åŒæ­¥æ–¹æ³• ï¼Œä¸€ä¸ªå¯¹è±¡ï¼Œå…ˆæ‰“å° å‘çŸ­ä¿¡ï¼Ÿæ‰“ç”µè¯ï¼Ÿ * 2ã€1ä¸ªé™æ€çš„åŒæ­¥æ–¹æ³•ï¼Œ1ä¸ªæ™®é€šçš„åŒæ­¥æ–¹æ³• ï¼Œä¸¤ä¸ªå¯¹è±¡ï¼Œå…ˆæ‰“å° å‘çŸ­ä¿¡ï¼Ÿæ‰“ç”µè¯ï¼Ÿ */public class Test4 &#123; public static void main(String[] args) &#123; // ä¸¤ä¸ªå¯¹è±¡çš„Classç±»æ¨¡æ¿åªæœ‰ä¸€ä¸ªï¼Œstaticï¼Œé”çš„æ˜¯Class Phone4 phone1 = new Phone4(); Phone4 phone2 = new Phone4(); //é”çš„å­˜åœ¨ new Thread(()-&gt;&#123; phone1.sendSms(); &#125;,&quot;A&quot;).start(); // æ•è· try &#123; TimeUnit.SECONDS.sleep(1); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; new Thread(()-&gt;&#123; phone2.call(); &#125;,&quot;B&quot;).start(); &#125;&#125;// Phone3å”¯ä¸€çš„ä¸€ä¸ª Class å¯¹è±¡class Phone4&#123; // é™æ€çš„åŒæ­¥æ–¹æ³• é”çš„æ˜¯ Class ç±»æ¨¡æ¿ public static synchronized void sendSms()&#123; try &#123; TimeUnit.SECONDS.sleep(4); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; System.out.println(&quot;å‘çŸ­ä¿¡&quot;); &#125; // æ™®é€šçš„åŒæ­¥æ–¹æ³• é”çš„è°ƒç”¨è€… public synchronized void call()&#123; System.out.println(&quot;æ‰“ç”µè¯&quot;); &#125;&#125; åŸå› ï¼šä¸¤æŠŠé”é”çš„ä¸æ˜¯åŒä¸€ä¸ªä¸œè¥¿ï¼Œé™æ€çš„åŒæ­¥æ–¹æ³•é”çš„æ˜¯ Class ç±»æ¨¡æ¿ï¼Œæ™®é€šçš„åŒæ­¥æ–¹æ³• é”çš„è°ƒç”¨è€… å°ç»“ é”å¯¹è±¡ï¼šnew this å…·ä½“çš„ä¸€ä¸ªæ‰‹æœºï¼Œå¯¹è±¡å’Œå¯¹è±¡ä¹‹é—´ä¸å…±ç”¨é” é”classï¼šstatic Class å”¯ä¸€çš„ä¸€ä¸ªæ¨¡æ¿ï¼Œå¯¹è±¡å’Œæ¨¡æ¿ä¹‹é—´ä¸å…±ç”¨é” å³ï¼šé”ï¼šstatic Classæ¨¡æ¿ã€å¯¹è±¡1ã€å¯¹è±¡2â€¦ é›†åˆä¸å®‰å…¨List ä¸å®‰å…¨123456789101112public class ListTest &#123; public static void main(String[] args) &#123; List&lt;Object&gt; arrayList = new ArrayList&lt;&gt;(); for(int i=1;i&lt;=10;i++)&#123; new Thread(()-&gt;&#123; arrayList.add(UUID.randomUUID().toString().substring(0,5)); System.out.println(arrayList); &#125;,String.valueOf(i)).start(); &#125; &#125;&#125; ä¼šå¯¼è‡´java.util.ConcurrentModificationException å¹¶å‘ä¿®æ”¹å¼‚å¸¸ ArrayList åœ¨å¹¶å‘æƒ…å†µä¸‹æ˜¯ä¸å®‰å…¨çš„ è§£å†³æ–¹æ¡ˆï¼š 123456789101112131415161718192021public class ListTest &#123; public static void main(String[] args) &#123; /** * è§£å†³æ–¹æ¡ˆ * 1. List&lt;String&gt; list = new Vector&lt;&gt;(); * 2. List&lt;String&gt; list = Collections.synchronizedList(new ArrayList&lt;&gt;()); * 3. List&lt;String&gt; list = new CopyOnWriteArrayList&lt;&gt;(); */ List&lt;String&gt; list = new CopyOnWriteArrayList&lt;&gt;(); for(int i=1;i&lt;=10;i++)&#123; new Thread(()-&gt;&#123; list.add(UUID.randomUUID().toString().substring(0,5)); System.out.println(list); &#125;,String.valueOf(i)).start(); &#125; &#125;&#125; CopyOnWriteArrayListï¼šå†™å…¥æ—¶å¤åˆ¶ï¼ COW è®¡ç®—æœºç¨‹åºè®¾è®¡é¢†åŸŸçš„ä¸€ç§ä¼˜åŒ–ç­–ç•¥ æ ¸å¿ƒæ€æƒ³æ˜¯ï¼Œå¦‚æœæœ‰å¤šä¸ªè°ƒç”¨è€…ï¼ˆCallersï¼‰åŒæ—¶è¦æ±‚ç›¸åŒçš„èµ„æºï¼ˆå¦‚å†…å­˜æˆ–è€…æ˜¯ç£ç›˜ä¸Šçš„æ•°æ®å­˜å‚¨ï¼‰ï¼Œä»–ä»¬ä¼šå…±åŒè·å–ç›¸åŒçš„æŒ‡é’ˆæŒ‡å‘ç›¸åŒçš„èµ„æºï¼Œç›´åˆ°æŸä¸ªè°ƒç”¨è€…è§†å›¾ä¿®æ”¹èµ„æºå†…å®¹æ—¶ï¼Œç³»ç»Ÿæ‰ä¼šçœŸæ­£å¤åˆ¶ä¸€ä»½ä¸“ç”¨å‰¯æœ¬ï¼ˆprivate copyï¼‰ç»™è¯¥è°ƒç”¨è€…ï¼Œè€Œå…¶ä»–è°ƒç”¨è€…æ‰€è§åˆ°çš„æœ€åˆçš„èµ„æºä»ç„¶ä¿æŒä¸å˜ã€‚è¿™è¿‡ç¨‹å¯¹å…¶ä»–çš„è°ƒç”¨è€…éƒ½æ˜¯é€æ˜çš„ï¼ˆtransparentlyï¼‰ã€‚æ­¤åšæ³•ä¸»è¦çš„ä¼˜ç‚¹æ˜¯å¦‚æœè°ƒç”¨è€…æ²¡æœ‰ä¿®æ”¹èµ„æºï¼Œå°±ä¸ä¼šæœ‰å‰¯æœ¬ï¼ˆprivate copyï¼‰è¢«åˆ›å»ºï¼Œå› æ­¤å¤šä¸ªè°ƒç”¨è€…åªæ˜¯è¯»å–æ“ä½œæ—¶å¯ä»¥å…±äº«åŒä¸€ä»½èµ„æºã€‚ è¯»çš„æ—¶å€™ä¸éœ€è¦åŠ é”ï¼Œå¦‚æœè¯»çš„æ—¶å€™æœ‰å¤šä¸ªçº¿ç¨‹æ­£åœ¨å‘CopyOnWriteArrayListæ·»åŠ æ•°æ®ï¼Œè¯»è¿˜æ˜¯ä¼šè¯»åˆ°æ—§çš„æ•°æ®ï¼Œå› ä¸ºå†™çš„æ—¶å€™ä¸ä¼šé”ä½æ—§çš„CopyOnWriteArrayListã€‚ å¤šä¸ªçº¿ç¨‹è°ƒç”¨çš„æ—¶å€™ï¼Œlistï¼Œè¯»å–çš„æ—¶å€™ï¼Œå›ºå®šçš„ï¼Œå†™å…¥ï¼ˆå­˜åœ¨è¦†ç›–æ“ä½œï¼‰ï¼› åœ¨å†™å…¥çš„æ—¶å€™é¿å…è¦†ç›–ï¼Œé€ æˆæ•°æ®é”™ä¹±çš„é—®é¢˜ï¼› è¯»å†™åˆ†ç¦» CopyOnWriteArrayListæ¯”Vectorå‰å®³åœ¨å“ªé‡Œï¼Ÿ Vectoråº•å±‚æ˜¯ä½¿ç”¨synchronizedå…³é”®å­—æ¥å®ç°çš„ï¼šæ•ˆç‡ç‰¹åˆ«ä½ä¸‹ã€‚ CopyOnWriteArrayListä½¿ç”¨çš„æ˜¯Locké”ï¼Œæ•ˆç‡ä¼šæ›´åŠ é«˜æ•ˆï¼ set ä¸å®‰å…¨ Setå’ŒListåŒç†å¯å¾—: å¤šçº¿ç¨‹æƒ…å†µä¸‹ï¼Œæ™®é€šçš„Seté›†åˆæ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„ï¼› è§£å†³æ–¹æ¡ˆè¿˜æ˜¯ä¸¤ç§ï¼š ä½¿ç”¨Collectionså·¥å…·ç±»çš„synchronizedåŒ…è£…çš„Setç±» ä½¿ç”¨CopyOnWriteArraySet å†™å…¥å¤åˆ¶çš„JUCè§£å†³æ–¹æ¡ˆ 1234567891011121314151617public class SetTest &#123; public static void main(String[] args) &#123; /** * 1. Set&lt;String&gt; set = Collections.synchronizedSet(new HashSet&lt;&gt;()); * 2. Set&lt;String&gt; set = new CopyOnWriteArraySet&lt;&gt;(); */// Set&lt;String&gt; set = new HashSet&lt;&gt;(); Set&lt;String&gt; set = new CopyOnWriteArraySet&lt;&gt;(); for (int i = 1; i &lt;= 30; i++) &#123; new Thread(() -&gt; &#123; set.add(UUID.randomUUID().toString().substring(0,5)); System.out.println(set); &#125;,String.valueOf(i)).start(); &#125; &#125;&#125; HashSetåº•å±‚æ˜¯ä»€ä¹ˆï¼Ÿ hashSetåº•å±‚å°±æ˜¯ä¸€ä¸ªHashMapï¼› Mapä¸å®‰å…¨1234//map æ˜¯è¿™æ ·ç”¨çš„å—ï¼Ÿ ä¸æ˜¯ï¼Œå·¥ä½œä¸­ä¸ä½¿ç”¨è¿™ä¸ª//é»˜è®¤ç­‰ä»·ä»€ä¹ˆï¼Ÿ new HashMap&lt;&gt;(16,0.75);Map&lt;String, String&gt; map = new HashMap&lt;&gt;();//åŠ è½½å› å­ã€åˆå§‹åŒ–å®¹é‡ é»˜è®¤åŠ è½½å› å­æ˜¯0.75,é»˜è®¤çš„åˆå§‹å®¹é‡æ˜¯16 åŒæ ·çš„HashMapåŸºç¡€ç±»ä¹Ÿå­˜åœ¨å¹¶å‘ä¿®æ”¹å¼‚å¸¸ï¼ 12345678910111213141516171819public class MapTest &#123; public static void main(String[] args) &#123; //map æ˜¯è¿™æ ·ç”¨çš„å—ï¼Ÿ ä¸æ˜¯ï¼Œå·¥ä½œä¸­ä¸ä½¿ç”¨è¿™ä¸ª //é»˜è®¤ç­‰ä»·ä»€ä¹ˆï¼Ÿ new HashMap&lt;&gt;(16,0.75); /** * è§£å†³æ–¹æ¡ˆ * 1. Map&lt;String, String&gt; map = Collections.synchronizedMap(new HashMap&lt;&gt;()); * Map&lt;String, String&gt; map = new ConcurrentHashMap&lt;&gt;(); */ Map&lt;String, String&gt; map = new ConcurrentHashMap&lt;&gt;(); //åŠ è½½å› å­ã€åˆå§‹åŒ–å®¹é‡ for (int i = 1; i &lt; 100; i++) &#123; new Thread(()-&gt;&#123; map.put(Thread.currentThread().getName(), UUID.randomUUID().toString().substring(0,5)); System.out.println(map); &#125;,String.valueOf(i)).start(); &#125; &#125;&#125; ä½œä¸š:ç ”ç©¶ConcurrentHashMapåº•å±‚åŸç†ï¼š Callable 1ã€å¯ä»¥æœ‰è¿”å›å€¼ï¼› 2ã€å¯ä»¥æŠ›å‡ºå¼‚å¸¸ï¼› 3ã€æ–¹æ³•ä¸åŒï¼Œrun()&#x2F;call() ä»£ç æµ‹è¯• 123456789101112131415161718192021222324252627282930313233import java.util.concurrent.Callable;import java.util.concurrent.ExecutionException;import java.util.concurrent.FutureTask;public class CallableTest &#123; public static void main(String[] args) throws ExecutionException, InterruptedException &#123; //new Thread(new Runnable()).start(); //new Thread(new FutureTask&lt;V&gt;()).start(); //new Thread(new FutureTask&lt;V&gt;( Callable )).start(); //new Thread().start();// æ€ä¹ˆå¯åŠ¨Callable MyThread thread = new MyThread(); FutureTask futureTask = new FutureTask(thread);//é€‚é…ç±» new Thread(futureTask,&quot;A&quot;).start(); new Thread(futureTask,&quot;B&quot;).start();// ç»“æœä¼šè¢«ç¼“å­˜ï¼Œæ•ˆç‡é«˜ï¼Œç»“æœåªæ‰“å°ä¸€æ¬¡ //è·å–Callableçš„è¿”å›ç»“æœ String o = (String) futureTask.get();//è¿™ä¸ªget æ–¹æ³•å¯èƒ½ä¼šäº§ç”Ÿé˜»å¡ï¼æŠŠä»–æ”¾åˆ°æœ€å æˆ–è€…ä½¿ç”¨å¼‚æ­¥é€šä¿¡æ¥å¤„ç†ï¼ System.out.println(o); &#125;&#125;class MyThread implements Callable&lt;String&gt; &#123; @Override public String call() throws Exception &#123; System.out.println(&quot;jjjj&quot;); // è€—æ—¶çš„æ“ä½œ return &quot;hello&quot;; &#125;&#125; ç»†èŠ‚ï¼š 1ã€æœ‰ç¼“å­˜ 2ã€ç»“æœå¯èƒ½éœ€è¦ç­‰å¾…ï¼Œä¼šé˜»å¡ï¼ å¸¸ç”¨çš„è¾…åŠ©ç±»(é«˜å¹¶å‘å¿…ä¼š)åŠ æ³•è®¡æ•°å™¨ï¼Œå‡æ³•è®¡æ•°å™¨å’Œä¿¡å·é‡ CountDownLatchå‡æ³•è®¡æ•°å™¨ ä¸»è¦æ–¹æ³•ï¼š countDown å‡ä¸€æ“ä½œï¼› await ç­‰å¾…è®¡æ•°å™¨å½’é›¶ await ç­‰å¾…è®¡æ•°å™¨å½’é›¶ï¼Œå°±å”¤é†’ï¼Œå†ç»§ç»­å‘ä¸‹è¿è¡Œ ä»£ç ï¼š 123456789101112131415public class CountDownLatchDemo &#123; public static void main(String[] args) throws InterruptedException &#123; // æ€»æ•°æ˜¯6 CountDownLatch countDownLatch = new CountDownLatch(6); for (int i = 1; i &lt;= 6; i++) &#123; new Thread(() -&gt; &#123; System.out.println(Thread.currentThread().getName() + &quot;==&gt; Go Out&quot;); countDownLatch.countDown(); // æ¯ä¸ªçº¿ç¨‹éƒ½æ•°é‡ -1 &#125;,String.valueOf(i)).start(); &#125; countDownLatch.await(); // ç­‰å¾…è®¡æ•°å™¨å½’é›¶ ç„¶åå‘ä¸‹æ‰§è¡Œ System.out.println(&quot;close door&quot;); &#125;&#125; CyclickBarrieråŠ æ³•è®¡æ•°å™¨ ä»£ç ï¼š 123456789101112131415161718192021222324public class CyclicBarrierDemo &#123; public static void main(String[] args) &#123; /** * é›†é½7é¢—é¾™ç å¬å”¤ç¥é¾™ */ // å¬å”¤é¾™ç çš„çº¿ç¨‹ CyclicBarrier cyclicBarrier = new CyclicBarrier(7, () -&gt; &#123; System.out.println(&quot;å¬å”¤ç¥é¾™ã€‚ã€‚ã€‚&quot;); &#125;); for (int i = 1; i &lt;= 7; i++) &#123; // lambdaä¸èƒ½æ“ä½œåˆ° i , å¿…é¡»ä¸ºä¸ä¿®æ”¹çš„å¸¸é‡ final int temp = i; new Thread(() -&gt; &#123; System.out.println(Thread.currentThread().getName()+&quot;æ”¶é›†ç¬¬&quot;+temp+&quot;é¢—é¾™ç &quot;); try &#123; cyclicBarrier.await(); //ç­‰å¾… &#125; catch (InterruptedException | BrokenBarrierException e) &#123; e.printStackTrace(); &#125; &#125;, String.valueOf(i)).start(); &#125; &#125;&#125; CyclicBarrier ä¸ CountDownLatch åŒºåˆ« CountDownLatch æ˜¯ä¸€æ¬¡æ€§çš„ï¼ŒCyclicBarrier æ˜¯å¯å¾ªç¯åˆ©ç”¨çš„ CountDownLatch å‚ä¸çš„çº¿ç¨‹çš„èŒè´£æ˜¯ä¸ä¸€æ ·çš„ï¼Œæœ‰çš„åœ¨å€’è®¡æ—¶ï¼Œæœ‰çš„åœ¨ç­‰å¾…å€’è®¡æ—¶ç»“æŸã€‚CyclicBarrier å‚ä¸çš„çº¿ç¨‹èŒè´£æ˜¯ä¸€æ ·çš„ã€‚ Semaphoreï¼ˆä¿¡å·é‡ï¼‰æŠ¢è½¦ä½ï¼6è½¦â€”3ä¸ªåœè½¦ä½ç½® ä»£ç ï¼š 1234567891011121314151617181920212223242526public class SemaphoreDemo &#123; public static void main(String[] args) &#123; // çº¿ç¨‹æ•°é‡ï¼šåœè½¦ä½! ç”¨æ¥é™æµï¼ Semaphore semaphore = new Semaphore(3); for (int i = 1; i &lt;= 6; i++) &#123; new Thread(() -&gt; &#123; //acquire() å¾—åˆ° //release() é‡Šæ”¾ try &#123; semaphore.acquire(); System.out.println(Thread.currentThread().getName()+&quot;æŠ¢åˆ°è½¦ä½ï¼&quot;); TimeUnit.SECONDS.sleep(2); System.out.println(Thread.currentThread().getName()+&quot;ç¦»å¼€è½¦ä½ï¼&quot;); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125;finally &#123; semaphore.release(); &#125; &#125;, String.valueOf(i)).start(); &#125; &#125;&#125; åŸç†ï¼š semaphore.acquire(); è·å¾—ï¼Œå‡è®¾å¦‚æœå·²ç»æ»¡äº†ï¼Œç­‰å¾…ï¼Œç­‰å¾…è¢«é‡Šæ”¾ä¸ºæ­¢ï¼ semaphore.release(); é‡Šæ”¾ï¼Œä¼šå°†å½“å‰çš„ä¿¡å·é‡é‡Šæ”¾ + 1ï¼Œç„¶åå”¤é†’ç­‰å¾…çš„çº¿ç¨‹ï¼ ä½œç”¨ï¼š å¤šä¸ªå…±äº«èµ„æºäº’æ–¥çš„ä½¿ç”¨ï¼å¹¶å‘é™æµï¼Œæ§åˆ¶æœ€å¤§çš„çº¿ç¨‹æ•°ï¼ è¯»å†™é”ReadWriteLock æ¡ˆä¾‹ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283/** * ç‹¬å é”ï¼ˆå†™é”ï¼‰ ä¸€æ¬¡åªèƒ½è¢«ä¸€ä¸ªçº¿ç¨‹å æœ‰ * å…±äº«é”ï¼ˆè¯»é”ï¼‰ å¤šä¸ªçº¿ç¨‹å¯ä»¥åŒæ—¶å æœ‰ * ReadWriteLock * è¯»-è¯» å¯ä»¥å…±å­˜ * è¯»-å†™ ä¸èƒ½å…±å­˜ * å†™-å†™ ä¸èƒ½å…±å­˜ */public class ReadWriteLockDemo &#123; public static void main(String[] args) &#123; //MyCache myCache = new MyCache(); MyCacheLock myCache = new MyCacheLock(); int num = 6; for (int i = 1; i &lt;= num; i++) &#123; int finalI = i; new Thread(() -&gt; &#123; myCache.write(String.valueOf(finalI), String.valueOf(finalI)); &#125;,String.valueOf(i)).start(); &#125; for (int i = 1; i &lt;= num; i++) &#123; int finalI = i; new Thread(() -&gt; &#123; myCache.read(String.valueOf(finalI)); &#125;,String.valueOf(i)).start(); &#125; &#125;&#125;class MyCacheLock &#123; private volatile Map&lt;String, String&gt; map = new HashMap&lt;&gt;(); // è¯»å†™é”ï¼Œæ›´åŠ ç»†ç²’åº¦çš„æ§åˆ¶ private ReadWriteLock readWriteLock = new ReentrantReadWriteLock(); //å†™çš„æ—¶å€™ï¼Œåªå¸Œæœ›åŒæ—¶åªæœ‰ä¸€ä¸ªçº¿ç¨‹å†™ public void write(String key, String value) &#123; readWriteLock.writeLock().lock(); try &#123; System.out.println(Thread.currentThread().getName() + &quot;çº¿ç¨‹å¼€å§‹å†™å…¥&quot;); map.put(key, value); System.out.println(Thread.currentThread().getName() + &quot;çº¿ç¨‹å†™å…¥ok&quot;); &#125; catch (Exception e) &#123; e.printStackTrace(); &#125; finally &#123; readWriteLock.writeLock().unlock(); &#125; &#125; //è¯»ï¼Œæ‰€æœ‰äººéƒ½å¯ä»¥è¯» public void read(String key) &#123; readWriteLock.readLock().lock(); try &#123; System.out.println(Thread.currentThread().getName() + &quot;çº¿ç¨‹å¼€å§‹è¯»å–&quot;); map.get(key); System.out.println(Thread.currentThread().getName() + &quot;çº¿ç¨‹è¯»å–ok&quot;); &#125; catch (Exception e) &#123; e.printStackTrace(); &#125; finally &#123; readWriteLock.readLock().unlock(); &#125; &#125;&#125;/** * æ–¹æ³•æœªåŠ é”ï¼Œå¯¼è‡´å†™çš„æ—¶å€™è¢«æ’é˜Ÿ */class MyCache &#123; private volatile Map&lt;String, String&gt; map = new HashMap&lt;&gt;(); public void write(String key, String value) &#123; System.out.println(Thread.currentThread().getName() + &quot;çº¿ç¨‹å¼€å§‹å†™å…¥&quot;); map.put(key, value); System.out.println(Thread.currentThread().getName() + &quot;çº¿ç¨‹å†™å…¥ok&quot;); &#125; public void read(String key) &#123; System.out.println(Thread.currentThread().getName() + &quot;çº¿ç¨‹å¼€å§‹è¯»å–&quot;); map.get(key); System.out.println(Thread.currentThread().getName() + &quot;çº¿ç¨‹å†™è¯»å–ok&quot;); &#125;&#125; é˜»å¡é˜Ÿåˆ—å†™å…¥ï¼šå¦‚æœé˜Ÿåˆ—æ»¡äº†å°±å¿…é¡»é˜»å¡ç­‰å¾… å–ï¼šå¦‚æœé˜Ÿåˆ—æ˜¯ç©ºçš„ï¼Œå¿…é¡»é˜»å¡ç­‰å¾…ç”Ÿäº§ é˜»å¡é˜Ÿåˆ—ï¼š BlockingQueue æœ‰å››ç»„api æ–¹å¼ æŠ›å‡ºå¼‚å¸¸ ä¸ä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œæœ‰è¿”å›å€¼ é˜»å¡ï¼Œç­‰å¾… è¶…æ—¶ç­‰å¾… æ·»åŠ  add offer() put offer(timenum.timeUnit) ç§»å‡º remove poll() take poll(timenum,timeUnit) åˆ¤æ–­é˜Ÿé¦–å…ƒç´  element peek - - æŠ›å‡ºå¼‚å¸¸ 1234567891011121314151617181920public static void test1()&#123; //éœ€è¦åˆå§‹åŒ–é˜Ÿåˆ—çš„å¤§å° ArrayBlockingQueue blockingQueue = new ArrayBlockingQueue&lt;&gt;(3); System.out.println(blockingQueue.add(&quot;a&quot;)); System.out.println(blockingQueue.add(&quot;b&quot;)); System.out.println(blockingQueue.add(&quot;c&quot;)); //æŠ›å‡ºå¼‚å¸¸ï¼šjava.lang.IllegalStateException: Queue full //System.out.println(blockingQueue.add(&quot;d&quot;)); System.out.println(blockingQueue.element()); //æŸ¥çœ‹é˜Ÿé¦–å…ƒç´ æ˜¯è° System.out.println(&quot;---------------------&quot;); System.out.println(blockingQueue.remove()); System.out.println(blockingQueue.remove()); System.out.println(blockingQueue.remove()); //å¦‚æœå¤šç§»é™¤ä¸€ä¸ª //è¿™ä¹Ÿä¼šé€ æˆ java.util.NoSuchElementException æŠ›å‡ºå¼‚å¸¸ //System.out.println(blockingQueue.remove());&#125; ä¸æŠ›å‡ºå¼‚å¸¸ï¼Œæœ‰è¿”å›å€¼ 1234567891011121314151617public static void test2()&#123; ArrayBlockingQueue blockingQueue = new ArrayBlockingQueue&lt;&gt;(3); System.out.println(blockingQueue.offer(&quot;a&quot;)); System.out.println(blockingQueue.offer(&quot;b&quot;)); System.out.println(blockingQueue.offer(&quot;c&quot;)); //æ·»åŠ ä¸€ä¸ªä¸èƒ½æ·»åŠ çš„å…ƒç´  ä½¿ç”¨offeråªä¼šè¿”å›false ä¸ä¼šæŠ›å‡ºå¼‚å¸¸ System.out.println(blockingQueue.offer(&quot;d&quot;)); System.out.println(blockingQueue.peek()); //æŸ¥çœ‹é˜Ÿé¦–å…ƒç´ æ˜¯è° System.out.println(&quot;---------------------&quot;); System.out.println(blockingQueue.poll()); System.out.println(blockingQueue.poll()); System.out.println(blockingQueue.poll()); //å¼¹å‡º å¦‚æœæ²¡æœ‰å…ƒç´  åªä¼šè¿”å›null ä¸ä¼šæŠ›å‡ºå¼‚å¸¸ System.out.println(blockingQueue.poll());&#125; ç­‰å¾… ä¸€ç›´é˜»å¡ 123456789101112131415161718public static void test3() throws InterruptedException &#123; ArrayBlockingQueue blockingQueue = new ArrayBlockingQueue&lt;&gt;(3); //ä¸€ç›´é˜»å¡ ä¸ä¼šè¿”å› blockingQueue.put(&quot;a&quot;); blockingQueue.put(&quot;b&quot;); blockingQueue.put(&quot;c&quot;); //å¦‚æœé˜Ÿåˆ—å·²ç»æ»¡äº†ï¼Œ å†è¿›å»ä¸€ä¸ªå…ƒç´  è¿™ç§æƒ…å†µä¼šä¸€ç›´ç­‰å¾…è¿™ä¸ªé˜Ÿåˆ— ä»€ä¹ˆæ—¶å€™æœ‰äº†ä½ç½®å†è¿›å»ï¼Œç¨‹åºä¸ä¼šåœæ­¢ //blockingQueue.put(&quot;d&quot;); System.out.println(&quot;---------------------&quot;); System.out.println(blockingQueue.take()); System.out.println(blockingQueue.take()); System.out.println(blockingQueue.take()); //å¦‚æœæˆ‘ä»¬å†æ¥ä¸€ä¸ª è¿™ç§æƒ…å†µä¹Ÿä¼šç­‰å¾…ï¼Œç¨‹åºä¼šä¸€ç›´è¿è¡Œ é˜»å¡ System.out.println(blockingQueue.take());&#125; ç­‰å¾… è¶…æ—¶é˜»å¡ è¿™ç§æƒ…å†µä¹Ÿä¼šç­‰å¾…é˜Ÿåˆ—æœ‰ä½ç½® æˆ–è€…æœ‰äº§å“ ä½†æ˜¯ä¼šè¶…æ—¶ç»“æŸ 12345678910111213141516public static void test4() throws InterruptedException &#123; ArrayBlockingQueue blockingQueue = new ArrayBlockingQueue&lt;&gt;(3); blockingQueue.offer(&quot;a&quot;); blockingQueue.offer(&quot;b&quot;); blockingQueue.offer(&quot;c&quot;); System.out.println(&quot;å¼€å§‹ç­‰å¾…&quot;); blockingQueue.offer(&quot;d&quot;,2, TimeUnit.SECONDS); //è¶…æ—¶æ—¶é—´2s ç­‰å¾…å¦‚æœè¶…è¿‡2så°±ç»“æŸç­‰å¾… System.out.println(&quot;ç»“æŸç­‰å¾…&quot;); System.out.println(&quot;===========å–å€¼==================&quot;); System.out.println(blockingQueue.poll()); System.out.println(blockingQueue.poll()); System.out.println(blockingQueue.poll()); System.out.println(&quot;å¼€å§‹ç­‰å¾…&quot;); blockingQueue.poll(2,TimeUnit.SECONDS); //è¶…è¿‡ä¸¤ç§’ æˆ‘ä»¬å°±ä¸è¦ç­‰å¾…äº† System.out.println(&quot;ç»“æŸç­‰å¾…&quot;);&#125; è¡¥å……ï¼šåŒæ­¥é˜Ÿåˆ—SynchronousQueue åŒæ­¥é˜Ÿåˆ—æ²¡æœ‰å®¹é‡ï¼Œä¹Ÿå¯ä»¥è§†ä¸ºå®¹é‡ä¸º1çš„é˜Ÿåˆ—ï¼› è¿›å»ä¸€ä¸ªå…ƒç´ ï¼Œå¿…é¡»ç­‰å¾…å–å‡ºæ¥ä¹‹åï¼Œæ‰èƒ½å†å¾€é‡Œé¢æ”¾å…¥ä¸€ä¸ªå…ƒç´ ï¼› putæ–¹æ³• å’Œ takeæ–¹æ³•ï¼› Synchronized å’Œ å…¶ä»–çš„BlockingQueue ä¸ä¸€æ · å®ƒä¸å­˜å‚¨å…ƒç´ ï¼› putäº†ä¸€ä¸ªå…ƒç´ ï¼Œå°±å¿…é¡»ä»é‡Œé¢å…ˆtakeå‡ºæ¥ï¼Œå¦åˆ™ä¸èƒ½å†putè¿›å»å€¼ï¼ å¹¶ä¸”SynchronousQueue çš„takeæ˜¯ä½¿ç”¨äº†locké”ä¿è¯çº¿ç¨‹å®‰å…¨çš„ 12345678910111213141516171819202122232425262728293031public class SynchronousQueueDemo &#123; public static void main(String[] args) &#123; BlockingQueue&lt;String&gt; synchronousQueue = new SynchronousQueue&lt;&gt;(); // ç½‘queueä¸­æ·»åŠ å…ƒç´  new Thread(() -&gt; &#123; try &#123; System.out.println(Thread.currentThread().getName() + &quot; put 1&quot;); synchronousQueue.put(&quot;1&quot;); System.out.println(Thread.currentThread().getName() + &quot; put 2&quot;); synchronousQueue.put(&quot;2&quot;); System.out.println(Thread.currentThread().getName() + &quot; put 3&quot;); synchronousQueue.put(&quot;3&quot;); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; &#125;).start(); // å–å‡ºå…ƒç´  new Thread(()-&gt; &#123; try &#123; TimeUnit.SECONDS.sleep(3); System.out.println(Thread.currentThread().getName() + &quot; take &quot; + synchronousQueue.take()); TimeUnit.SECONDS.sleep(3); System.out.println(Thread.currentThread().getName() + &quot; take &quot; + synchronousQueue.take()); TimeUnit.SECONDS.sleep(3); System.out.println(Thread.currentThread().getName() + &quot; take &quot; + synchronousQueue.take()); &#125;catch (InterruptedException e) &#123; e.printStackTrace(); &#125; &#125;).start(); &#125;&#125; çº¿ç¨‹æ± (é‡ç‚¹)çº¿ç¨‹æ± ï¼šä¸‰å¤§æ–¹æ³•ã€7å¤§å‚æ•°ã€4ç§æ‹’ç»ç­–ç•¥ æ± åŒ–æŠ€æœ¯ ç¨‹åºçš„è¿è¡Œï¼Œæœ¬è´¨ï¼šå ç”¨ç³»ç»Ÿçš„èµ„æºï¼æˆ‘ä»¬éœ€è¦å»ä¼˜åŒ–èµ„æºçš„ä½¿ç”¨ &#x3D;&#x3D;&#x3D;&gt; æ± åŒ–æŠ€æœ¯ çº¿ç¨‹æ± ã€JDBCçš„è¿æ¥æ± ã€å†…å­˜æ± ã€å¯¹è±¡æ±  ç­‰ç­‰ã€‚ã€‚ã€‚ã€‚ èµ„æºçš„åˆ›å»ºã€é”€æ¯ååˆ†æ¶ˆè€—èµ„æº æ± åŒ–æŠ€æœ¯ï¼šäº‹å…ˆå‡†å¤‡å¥½ä¸€äº›èµ„æºï¼Œå¦‚æœæœ‰äººè¦ç”¨ï¼Œå°±æ¥æˆ‘è¿™é‡Œæ‹¿ï¼Œç”¨å®Œä¹‹åè¿˜ç»™æˆ‘ï¼Œä»¥æ­¤æ¥æé«˜æ•ˆç‡ã€‚ é»˜è®¤å¤§å°ï¼š3 maxï¼š çº¿ç¨‹æ± çš„å¥½å¤„ï¼š 1ã€é™ä½èµ„æºçš„æ¶ˆè€—ï¼› 2ã€æé«˜å“åº”çš„é€Ÿåº¦ï¼› 3ã€æ–¹ä¾¿ç®¡ç†ï¼› çº¿ç¨‹å¤ç”¨ã€å¯ä»¥æ§åˆ¶æœ€å¤§å¹¶å‘æ•°ã€ç®¡ç†çº¿ç¨‹ï¼› ä¸‰å¤§æ–¹æ³•é˜¿é‡Œè§„èŒƒï¼š ä¸‰å¤§æ–¹æ³•ï¼š ExecutorService threadPool &#x3D; Executors.newSingleThreadExecutor();&#x2F;&#x2F;å•ä¸ªçº¿ç¨‹ ExecutorService threadPool2 &#x3D; Executors.newFixedThreadPool(5); &#x2F;&#x2F;åˆ›å»ºä¸€ä¸ªå›ºå®šçš„çº¿ç¨‹æ± çš„å¤§å° ExecutorService threadPool3 &#x3D; Executors.newCachedThreadPool(); &#x2F;&#x2F;å¯ä¼¸ç¼©çš„ æ¡ˆä¾‹ï¼š 1234567891011121314151617181920212223//Executors å·¥å…·ç±»ï¼Œ 3å¤§æ–¹æ³•public class Demo01 &#123; public static void main(String[] args) &#123; //ExecutorService threadPool = Executors.newSingleThreadExecutor();//å•ä¸ªçº¿ç¨‹ //ExecutorService threadPool = Executors.newFixedThreadPool(5);//åˆ›å»ºä¸€ä¸ªå›ºå®šçš„çº¿ç¨‹æ± å¤§å° ExecutorService threadPool = Executors.newCachedThreadPool();//å¯ä¼¸ç¼©çš„ï¼Œé‡å¼ºåˆ™å¼ºï¼Œé‡å¼±åˆ™å¼± try &#123; for (int i = 0; i &lt; 10; i++) &#123; // ä½¿ç”¨äº†çº¿ç¨‹æ± ä¹‹åï¼Œä½¿ç”¨çº¿ç¨‹æ± æ¥åˆ›å»ºçº¿ç¨‹ threadPool.execute(() -&gt; &#123; System.out.println(Thread.currentThread().getName() + &quot; OK&quot;); &#125;); &#125; &#125; catch (Exception e) &#123; e.printStackTrace(); &#125; finally &#123; // çº¿ç¨‹æ± ç”¨å®Œï¼Œç¨‹åºç»“æŸï¼Œå…³é—­çº¿ç¨‹æ±  threadPool.shutdown(); &#125; &#125;&#125; ä¸ƒå¤§å‚æ•°ä¸‰è€…æœ¬è´¨ä¸Šéƒ½æ˜¯è°ƒç”¨ThreadPoolExecutor ä¸‰å¤§æ–¹æ³•æºç åˆ†æï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445 public static ExecutorService newSingleThreadExecutor() &#123; return new FinalizableDelegatedExecutorService (new ThreadPoolExecutor(1, 1, 0L, TimeUnit.MILLISECONDS, new LinkedBlockingQueue&lt;Runnable&gt;())); &#125; public static ExecutorService newFixedThreadPool(int nThreads) &#123; return new ThreadPoolExecutor(nThreads, nThreads, 0L, TimeUnit.MILLISECONDS, new LinkedBlockingQueue&lt;Runnable&gt;()); &#125; public static ExecutorService newCachedThreadPool() &#123; return new ThreadPoolExecutor(0, Integer.MAX_VALUE, //21äº¿ 60L, TimeUnit.SECONDS, new SynchronousQueue&lt;Runnable&gt;()); &#125; // æœ¬è´¨ThreadPoolExecutorï¼ˆï¼‰ public ThreadPoolExecutor(int corePoolSize, // æ ¸å¿ƒçº¿ç¨‹æ± å¤§å° int maximumPoolSize, // æœ€å¤§æ ¸å¿ƒçº¿ç¨‹æ± å¤§å° long keepAliveTime, // è¶…æ—¶äº†æ²¡æœ‰äººè°ƒç”¨å°±ä¼šé‡Šæ”¾ TimeUnit unit, // è¶…æ—¶å•ä½ BlockingQueue&lt;Runnable&gt; workQueue,// é˜»å¡é˜Ÿåˆ— ThreadFactory threadFactory,// çº¿ç¨‹å·¥å‚ï¼šåˆ›å»ºçº¿ç¨‹çš„ï¼Œä¸€èˆ¬ä¸ç”¨åŠ¨ RejectedExecutionHandler handler// æ‹’ç»ç­–ç•¥ ) &#123; if (corePoolSize &lt; 0 || maximumPoolSize &lt;= 0 || maximumPoolSize &lt; corePoolSize || keepAliveTime &lt; 0) throw new IllegalArgumentException(); if (workQueue == null || threadFactory == null || handler == null) throw new NullPointerException(); this.acc = System.getSecurityManager() == null ? null : AccessController.getContext(); this.corePoolSize = corePoolSize; this.maximumPoolSize = maximumPoolSize; this.workQueue = workQueue; this.keepAliveTime = unit.toNanos(keepAliveTime); this.threadFactory = threadFactory; this.handler = handler; &#125; æ‰‹åŠ¨åˆ›å»ºä¸€ä¸ªçº¿ç¨‹æ±  1234567891011121314151617181920212223242526272829303132333435/** * new ThreadPoolExecutor.AbortPolicy() // é“¶è¡Œæ»¡äº†ï¼Œè¿˜æœ‰äººè¿›æ¥ï¼Œä¸å¤„ç†è¿™ä¸ªäººçš„ï¼ŒæŠ›å‡ºå¼‚å¸¸ * new ThreadPoolExecutor.CallerRunsPolicy() // å“ªæ¥çš„å»å“ªé‡Œï¼ mainçº¿ç¨‹ * new ThreadPoolExecutor.DiscardPolicy() //é˜Ÿåˆ—æ»¡äº†ï¼Œä¸¢æ‰ä»»åŠ¡ï¼Œä¸ä¼šæŠ›å‡ºå¼‚å¸¸ï¼ * new ThreadPoolExecutor.DiscardOldestPolicy() //é˜Ÿåˆ—æ»¡äº†ï¼Œå°è¯•å»å’Œæœ€æ—©çš„ç«äº‰ï¼Œä¹Ÿä¸ä¼šæŠ›å‡ºå¼‚å¸¸ï¼åªä¼šå°è¯• */public class Demo01 &#123; public static void main(String[] args) &#123; //è‡ªå®šä¹‰çº¿ç¨‹æ± ï¼å·¥ä½œ ThreadPoolExecutor ExecutorService threadPool = new ThreadPoolExecutor( 2,// æ ¸å¿ƒçº¿ç¨‹æ± å¤§å° 5,// æœ€å¤§æ ¸å¿ƒçº¿ç¨‹æ± å¤§å° 4,//è¶…æ—¶æ—¶é—´ TimeUnit.SECONDS,//è¶…æ—¶å•ä½ new LinkedBlockingQueue&lt;&gt;(3),//å€™å®¢åŒº Executors.defaultThreadFactory(), new ThreadPoolExecutor.DiscardOldestPolicy());//é“¶è¡Œæ»¡äº†ï¼Œè¿˜æœ‰äººè¿›æ¥ï¼Œä¸å¤„ç†è¿™ä¸ªäººçš„ï¼ŒæŠ›å‡ºå¼‚å¸¸ try &#123; //æœ€å¤§æ‰¿è½½ï¼šDeque + max ï¼ˆ5+3ï¼‰ //è¶…è¿‡ RejectedExecutionException for (int i = 1; i &lt;= 9; i++) &#123; // ä½¿ç”¨äº†çº¿ç¨‹æ± ä¹‹åï¼Œä½¿ç”¨çº¿ç¨‹æ± æ¥åˆ›å»ºçº¿ç¨‹ threadPool.execute(() -&gt; &#123; System.out.println(Thread.currentThread().getName() + &quot; OK&quot;); &#125;); &#125; &#125; catch (Exception e) &#123; e.printStackTrace(); &#125; finally &#123; // çº¿ç¨‹æ± ç”¨å®Œï¼Œç¨‹åºç»“æŸï¼Œå…³é—­çº¿ç¨‹æ±  threadPool.shutdown(); &#125; &#125;&#125; å››ç§æ‹’ç»ç­–ç•¥ new ThreadPoolExecutor.AbortPolicy() &#x2F;&#x2F; é“¶è¡Œæ»¡äº†ï¼Œè¿˜æœ‰äººè¿›æ¥ï¼Œä¸å¤„ç†è¿™ä¸ªäººçš„ï¼ŒæŠ›å‡ºå¼‚å¸¸ new ThreadPoolExecutor.CallerRunsPolicy() &#x2F;&#x2F; å“ªæ¥çš„å»å“ªé‡Œï¼ mainçº¿ç¨‹ new ThreadPoolExecutor.DiscardPolicy() &#x2F;&#x2F;é˜Ÿåˆ—æ»¡äº†ï¼Œä¸¢æ‰ä»»åŠ¡ï¼Œä¸ä¼šæŠ›å‡ºå¼‚å¸¸ï¼ new ThreadPoolExecutor.DiscardOldestPolicy() &#x2F;&#x2F;é˜Ÿåˆ—æ»¡äº†ï¼Œå°è¯•å»å’Œæœ€æ—©çš„ç«äº‰ï¼Œä¹Ÿä¸ä¼šæŠ›å‡ºå¼‚å¸¸ï¼åªä¼šå°è¯• æ‰©å±•å¦‚ä½•è®¾ç½®çº¿ç¨‹æ± çš„æœ€å¤§å¤§å°ï¼ˆè°ƒä¼˜ï¼‰ æœ€å¤§çº¿ç¨‹æ± å¤§å°è¯¥å¦‚ä½•å®šä¹‰ï¼š 1ã€CPUå¯†é›†å‹ï¼šç”µè„‘çš„æ ¸æ•°æ˜¯å‡ æ ¸å°±é€‰æ‹©å‡ ï¼›é€‰æ‹©maximunPoolSizeçš„å¤§å° ä»£ç è·å–CPUæ ¸æ•°ï¼š 1System.out.println(Runtime.getRuntime().availableProcessors()); 2ã€I&#x2F;Oå¯†é›†å‹ï¼š åœ¨ç¨‹åºä¸­æœ‰15ä¸ªå¤§å‹ä»»åŠ¡ï¼Œioååˆ†å ç”¨èµ„æºï¼› I&#x2F;Oå¯†é›†å‹å°±æ˜¯åˆ¤æ–­æˆ‘ä»¬ç¨‹åºä¸­ååˆ†è€—I&#x2F;Oçš„çº¿ç¨‹æ•°é‡ï¼Œå¤§çº¦æ˜¯æœ€å¤§I&#x2F;Oæ•°çš„ä¸€å€åˆ°ä¸¤å€ä¹‹é—´ã€‚ å››å¤§å‡½æ•°å¼æ¥å£ï¼ˆå¿…é¡»æŒæ¡ï¼‰æ–°æ—¶ä»£çš„ç¨‹åºå‘˜ï¼šlambdaè¡¨è¾¾å¼ã€é“¾å¼ç¼–ç¨‹ã€å‡½æ•°å¼æ¥å£ã€Streamæµå¼è®¡ç®— å‡½æ•°å¼æ¥å£ï¼šåªæœ‰ä¸€ä¸ªæ–¹æ³•çš„æ¥å£ 12345678910@FunctionalInterfacepublic interface Runnable &#123; public abstract void run();&#125;// ä¼ ç»ŸæŠ€æœ¯å¿…ä¼šï¼šæ³›å‹ã€æšä¸¾ã€åå°„// æ–°æŠ€æœ¯å¿…ä¼šï¼šlambdaè¡¨è¾¾å¼ã€é“¾å¼ç¼–ç¨‹ã€å‡½æ•°å¼æ¥å£ã€Streamæµå¼è®¡ç®—// è¶…çº§å¤šFunctionalInterface// ç®€åŒ–ç¼–ç¨‹æ¨¡å‹ï¼Œåœ¨æ–°ç‰ˆæœ¬çš„æ¡†æ¶åº•å±‚å¤§é‡åº”ç”¨ï¼// foreach(æ¶ˆè´¹è€…ç±»çš„å‡½æ•°å¼æ¥å£) å››å¤§å‡½æ•°å¼æ¥å£ï¼šFunctionã€Predicateã€Suppierã€Consummer å‚æ•° è¿”å›å€¼ Function æœ‰ æœ‰ Predicate æœ‰ Boolean Suppier æ—  æ—  Consummer æœ‰ æ—  Function å‡½æ•°å‹æ¥å£ä¼ å…¥å‚æ•°Tï¼Œè¿”å›å‚æ•°R ä»£ç ï¼š 12345678910111213141516171819202122/** * Function å‡½æ•°å‹æ¥å£, æœ‰ä¸€ä¸ªè¾“å…¥å‚æ•°ï¼Œæœ‰ä¸€ä¸ªè¾“å‡º, * åªè¦æ˜¯å‡½æ•°å‹æ¥å£ï¼Œå°±å¯ä»¥ç”¨ lambdaè¡¨è¾¾å¼ç®€åŒ– */public class Demo01 &#123; public static void main(String[] args) &#123; //å·¥å…·ç±»ï¼šè¾“å‡ºè¾“å…¥çš„å€¼ Function function = new Function&lt;String, String&gt;() &#123; @Override public String apply(String str) &#123; return str; &#125; &#125;; //åªè¦æ˜¯å‡½æ•°å‹æ¥å£ï¼Œå°±å¯ä»¥ç”¨ lambdaè¡¨è¾¾å¼ç®€åŒ– Function function1 = (str) -&gt; &#123; return str; &#125;; System.out.println(function1.apply(&quot;123&quot;)); &#125;&#125; Predicate æ–­å®šå‹æ¥å£ä¼ å…¥å‚æ•°Tï¼Œè¿”å›Booleanå€¼ ä»£ç ï¼š 123456789101112131415161718192021/** * æ–­å®šå‹æ¥å£ï¼šæœ‰ä¸€ä¸ªè¾“å…¥å‚æ•°ï¼Œè¿”å›å€¼åªèƒ½æ˜¯ å¸ƒå°”å€¼ï¼ */public class Demo02 &#123; public static void main(String[] args) &#123; //åˆ¤æ–­å­—ç¬¦ä¸²æ˜¯å¦ä¸ºç©º Predicate&lt;String&gt; predicate = new Predicate&lt;String&gt;() &#123; @Override public boolean test(String str) &#123; return str.isEmpty(); &#125; &#125;; //åªè¦æ˜¯å‡½æ•°å‹æ¥å£ï¼Œå°±å¯ä»¥ç”¨ lambdaè¡¨è¾¾å¼ç®€åŒ– Predicate&lt;String&gt; predicate2 = (str) -&gt; &#123; return str.isEmpty(); &#125;; System.out.println(predicate.test(&quot;asddd&quot;)); &#125;&#125; Suppier ä¾›ç»™å‹æ¥å£æ²¡æœ‰å‚æ•°ï¼Œåªæœ‰è¿”å›å€¼ ä»£ç ï¼š 1234567891011121314151617181920/** * Supplier ä¾›ç»™å‹æ¥å£ æ²¡æœ‰å‚æ•°ï¼Œåªæœ‰è¿”å›å€¼ */public class Demo04 &#123; public static void main(String[] args) &#123; Supplier supplier = new Supplier&lt;Integer&gt;() &#123; @Override public Integer get() &#123; return 1024; &#125; &#125;; //åªè¦æ˜¯å‡½æ•°å‹æ¥å£ï¼Œå°±å¯ä»¥ç”¨ lambdaè¡¨è¾¾å¼ç®€åŒ– Supplier supplier2 = () -&gt; &#123; return 1024; &#125;; System.out.println(supplier2.get()); &#125;&#125; Consummer æ¶ˆè´¹å‹æ¥å£åªæœ‰å‚æ•°ï¼Œæ²¡æœ‰è¿”å›å€¼ 1234567891011121314151617181920/** * Consumer æ¶ˆè´¹å‹æ¥å£: åªæœ‰è¾“å…¥ï¼Œæ²¡æœ‰è¿”å›å€¼ */public class Demo03 &#123; public static void main(String[] args) &#123; Consumer&lt;String&gt; consumer = new Consumer&lt;String&gt;() &#123; @Override public void accept(String str) &#123; System.out.println(str); &#125; &#125;; //åªè¦æ˜¯å‡½æ•°å‹æ¥å£ï¼Œå°±å¯ä»¥ç”¨ lambdaè¡¨è¾¾å¼ç®€åŒ– Consumer&lt;String&gt; consumer1 = (str) -&gt; &#123; System.out.println(str); &#125;; consumer.accept(&quot;qwre&quot;); &#125;&#125; Streamæµå¼è®¡ç®— ä»€ä¹ˆæ˜¯Streamæµå¼è®¡ç®— å¤§æ•°æ®ï¼šå­˜å‚¨ + è®¡ç®— é›†åˆã€MySQL æœ¬è´¨å°±æ˜¯å­˜å‚¨ä¸œè¥¿çš„ï¼› è®¡ç®—éƒ½åº”è¯¥äº¤ç»™æµæ¥æ“ä½œï¼ æ¡ˆä¾‹ Userç±» 12345678@Data@NoArgsConstructor@AllArgsConstructorpublic class User &#123; private int id; private String name; private int age;&#125; Test 1234567891011121314151617181920212223242526272829303132333435363738394041/** * é¢˜ç›®è¦æ±‚ï¼šä¸€åˆ†é’Ÿå†…å®Œæˆæ­¤é¢˜ï¼Œåªèƒ½ç”¨ä¸€è¡Œä»£ç å®ç°ï¼ * ç°åœ¨æœ‰5ä¸ªç”¨æˆ·ï¼ç­›é€‰ï¼š * 1ã€ID å¿…é¡»æ˜¯å¶æ•° * 2ã€å¹´é¾„å¿…é¡»å¤§äº23å² * 3ã€ç”¨æˆ·åè½¬ä¸ºå¤§å†™å­—æ¯ * 4ã€ç”¨æˆ·åå­—æ¯å€’ç€æ’åº * 5ã€åªè¾“å‡ºä¸€ä¸ªç”¨æˆ·ï¼ */public class Test &#123; public static void main(String[] args) &#123; User u1 = new User(1, &quot;a&quot;, 21); User u2 = new User(2, &quot;b&quot;, 22); User u3 = new User(3, &quot;c&quot;, 23); User u4 = new User(4, &quot;d&quot;, 24); User u5 = new User(6, &quot;e&quot;, 25); // é›†åˆæ˜¯å­˜å‚¨ List&lt;User&gt; list = Arrays.asList(u1, u2, u3, u4, u5); // è®¡ç®—äº¤ç»™Streamæµ // list.stream(); // lambdaè¡¨è¾¾å¼ã€é“¾å¼ç¼–ç¨‹ã€å‡½æ•°å¼æ¥å£ã€Streamæµå¼è®¡ç®— list.stream() .filter(u -&gt; &#123; return u.getId() % 2 == 0; &#125;) .filter(u -&gt; &#123; return u.getAge() &gt; 23; &#125;) .map(u -&gt; &#123; return u.getName().toUpperCase(); &#125;) .sorted((uu1, uu2) -&gt; &#123; return uu2.compareTo(uu1); &#125;) .limit(1) .forEach(System.out::println); &#125;&#125; ForkJoinä¸­æ–‡ï¼šåˆ†æ”¯åˆå¹¶ ForkJoin åœ¨JDK1.7ï¼Œå¹¶è¡Œæ‰§è¡Œä»»åŠ¡ï¼æé«˜æ•ˆç‡ã€‚åœ¨å¤§æ•°æ®é‡é€Ÿç‡ä¼šæ›´å¿«ï¼ å¤§æ•°æ®ä¸­ï¼šMapReduce æ ¸å¿ƒæ€æƒ³-&gt;æŠŠå¤§ä»»åŠ¡æ‹†åˆ†ä¸ºå°ä»»åŠ¡ï¼ ForkJoin ç‰¹ç‚¹ï¼š å·¥ä½œçªƒå–ï¼ å®ç°åŸç†æ˜¯ï¼šåŒç«¯é˜Ÿåˆ—ï¼ä»ä¸Šé¢å’Œä¸‹é¢éƒ½å¯ä»¥å»æ‹¿åˆ°ä»»åŠ¡è¿›è¡Œæ‰§è¡Œï¼ ForkJoinä½¿ç”¨ é€šè¿‡ForkJoinPoolæ¥æ‰§è¡Œ è®¡ç®—ä»»åŠ¡ execute(ForkJoinTask&lt;?&gt; task) è®¡ç®—ç±»è¦å»ç»§æ‰¿ForkJoinTaskï¼› ForkJoin çš„è®¡ç®—ç±» 12345678910111213141516171819202122232425262728293031323334353637383940414243/** * æ±‚å’Œè®¡ç®—çš„ä»»åŠ¡ * 3000 6000(ForkJoin) 9000(Streamå¹¶è¡Œæµ) * */public class ForkJoinDemo extends RecursiveTask&lt;Long&gt; &#123; private long start; private long end; /** ä¸´ç•Œå€¼ */ private long temp = 1000000L; public ForkJoinDemo(long start, long end) &#123; this.start = start; this.end = end; &#125; /** * è®¡ç®—æ–¹æ³• * @return */ @Override protected Long compute() &#123; if ((end - start) &lt; temp) &#123; long sum = 0L; for (long i = start; i &lt; end; i++) &#123; sum += i; &#125; return sum; &#125;else &#123; // ä½¿ç”¨ForkJoin åˆ†è€Œæ²»ä¹‹ è®¡ç®— //1 . è®¡ç®—å¹³å‡å€¼ long middle = (start + end) / 2; ForkJoinDemo task1 = new ForkJoinDemo(start, middle); task1.fork();// æ‹†åˆ†ä»»åŠ¡ï¼ŒæŠŠçº¿ç¨‹å‹å…¥çº¿ç¨‹é˜Ÿåˆ— ForkJoinDemo task2 = new ForkJoinDemo(middle, end); task2.fork(); long taskSum = task1.join() + task2.join(); return taskSum; &#125; &#125;&#125; æµ‹è¯•ç±» 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152public class ForkJoinTest &#123; private static final long SUM = 20_0000_0000; public static void main(String[] args) throws ExecutionException, InterruptedException &#123; test1(); test2(); test3(); &#125; /** * ä½¿ç”¨æ™®é€šæ–¹æ³• */ public static void test1() &#123; long star = System.currentTimeMillis(); long sum = 0L; for (long i = 1; i &lt; SUM ; i++) &#123; sum += i; &#125; long end = System.currentTimeMillis(); System.out.println(sum); System.out.println(&quot;æ—¶é—´ï¼š&quot; + (end - star)); System.out.println(&quot;----------------------&quot;); &#125; /** * ä½¿ç”¨ForkJoin æ–¹æ³• */ public static void test2() throws ExecutionException, InterruptedException &#123; long star = System.currentTimeMillis(); ForkJoinPool forkJoinPool = new ForkJoinPool(); ForkJoinTask&lt;Long&gt; task = new ForkJoinDemo(0L, SUM); ForkJoinTask&lt;Long&gt; submit = forkJoinPool.submit(task); //æäº¤ä»»åŠ¡ Long along = submit.get(); System.out.println(along); long end = System.currentTimeMillis(); System.out.println(&quot;æ—¶é—´ï¼š&quot; + (end - star)); System.out.println(&quot;-----------&quot;); &#125; /** * ä½¿ç”¨ Stream æµè®¡ç®— */ public static void test3() &#123; long star = System.currentTimeMillis(); long sum = LongStream.range(0L, 20_0000_0000L).parallel().reduce(0, Long::sum); System.out.println(sum); long end = System.currentTimeMillis(); System.out.println(&quot;æ—¶é—´ï¼š&quot; + (end - star)); System.out.println(&quot;-----------&quot;); &#125;&#125; ç»“æœï¼š æ³¨æ„ longå’ŒLongçš„åŒºåˆ«ï¼š longï¼šåŸºæœ¬æ•°æ®ç±»å‹ï¼Œä¸intï¼Œfloatç±»ä¼¼ Longï¼šå¯¹è±¡ï¼Œä¸Integerç±»ä¼¼ longæ¯”Longè¿ç®—é€Ÿåº¦å¿«çš„å¤šï¼ï¼ï¼ æ‰©å……ï¼šjavaå…«å¤§åŸºæœ¬æ•°æ®ç±»å‹åŠå…¶å°è£…ç±» ç®€å•ç±»å‹ boolean byte char short Int long float double void äºŒè¿›åˆ¶ä½æ•° 1 8 16 16 32 64 32 64 â€“ å°è£…å™¨ç±» Boolean Byte Character Short Integer Long Float Double Void JavaåŸºæœ¬ç±»å‹å­˜å‚¨åœ¨æ ˆä¸­ï¼Œå› æ­¤å®ƒä»¬çš„å­˜å–é€Ÿåº¦è¦å¿«äºå­˜å‚¨åœ¨å †ä¸­çš„å¯¹åº”åŒ…è£…ç±»çš„å®ä¾‹å¯¹è±¡ã€‚ åŸºæœ¬ç±»å‹çš„ä¼˜åŠ¿ï¼šæ•°æ®å­˜å‚¨ç›¸å¯¹ç®€å•ï¼Œè¿ç®—æ•ˆç‡æ¯”è¾ƒé«˜ åŒ…è£…ç±»çš„ä¼˜åŠ¿ï¼šæœ‰çš„å®¹æ˜“ï¼Œæ¯”å¦‚é›†åˆçš„å…ƒç´ å¿…é¡»æ˜¯å¯¹è±¡ç±»å‹ï¼Œæ»¡è¶³äº†javaä¸€åˆ‡çš†æ˜¯å¯¹è±¡çš„æ€æƒ³ å¼‚æ­¥å›è°ƒ Future è®¾è®¡çš„åˆè¡·ï¼š å¯¹å°†æ¥çš„æŸä¸ªäº‹ä»¶çš„ç»“æœè¿›è¡Œå»ºæ¨¡ å…¶å®å°±æ˜¯å‰ç«¯ â€“&gt; å‘é€ajaxå¼‚æ­¥è¯·æ±‚ç»™åç«¯ ä½†æ˜¯æˆ‘ä»¬å¹³æ—¶éƒ½ä½¿ç”¨CompletableFuture æ²¡æœ‰è¿”å›å€¼çš„runAsyncå¼‚æ­¥å›è°ƒ 123456789101112131415161718192021222324/** * å¼‚æ­¥è°ƒç”¨ï¼š CompletableFuture * // å¼‚æ­¥æ‰§è¡Œ * // æˆåŠŸå›è°ƒ * // å¤±è´¥å›è°ƒ */public class Demo01 &#123; public static void main(String[] args) throws ExecutionException, InterruptedException &#123; // å‘èµ·ä¸€ä¸ªè¯·æ±‚ void // æ²¡æœ‰è¿”å›å€¼çš„ runAsync å¼‚æ­¥å›è°ƒ CompletableFuture&lt;Void&gt; completableFuture = CompletableFuture.runAsync(() -&gt; &#123; try &#123; TimeUnit.SECONDS.sleep(2); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; System.out.println(Thread.currentThread().getName() + &quot;runAsync=&gt;void&quot;); &#125;); System.out.println(&quot;11111111&quot;); completableFuture.get();//è·å–æ‰§è¡Œç»“æœ &#125;&#125; æœ‰è¿”å›å€¼çš„å¼‚æ­¥å›è°ƒsupplyAsync 12345678910111213141516171819public class Demo01 &#123; public static void main(String[] args) throws ExecutionException, InterruptedException &#123; // æœ‰è¿”å›å€¼çš„ runAsync å¼‚æ­¥å›è°ƒ // æˆåŠŸè¿”å›ï¼Œå¤±è´¥è¿”å›é”™è¯¯ä¿¡æ¯ CompletableFuture&lt;Integer&gt; completableFuture = CompletableFuture.supplyAsync(()-&gt;&#123; System.out.println(Thread.currentThread().getName() + &quot;supplyAsync=&gt;Integer&quot;); int i = 10/0; return 1024; &#125;); System.out.println(completableFuture.whenComplete((t, u) -&gt; &#123; System.out.println(&quot;t=&gt;&quot; + t); //æ­£å¸¸çš„è¿”å›ç»“æœ System.out.println(&quot;u=&gt;&quot; + u); //é”™è¯¯ä¿¡æ¯ java.util.concurrent.CompletionException &#125;).exceptionally((e) -&gt; &#123; System.out.println(e.getMessage()); return 233; //å¯ä»¥è·å–åˆ°é”™è¯¯çš„è¿”å›ç»“æœ &#125;).get()); &#125;&#125; whenComplete: æœ‰ä¸¤ä¸ªå‚æ•°ï¼Œä¸€ä¸ªæ˜¯t ä¸€ä¸ªæ˜¯u Tï¼šæ˜¯ä»£è¡¨çš„ æ­£å¸¸è¿”å›çš„ç»“æœï¼› Uï¼šæ˜¯ä»£è¡¨çš„ æŠ›å‡ºå¼‚å¸¸çš„é”™è¯¯ä¿¡æ¯ï¼› å¦‚æœå‘ç”Ÿäº†å¼‚å¸¸ï¼Œgetå¯ä»¥è·å–åˆ°exceptionallyè¿”å›çš„å€¼ï¼› ç†è§£ å¼‚æ­¥å›è°ƒï¼šå¼€å¯å¦å¤–ä¸€ä¸ªçº¿ç¨‹å»æ‰§è¡Œä»»åŠ¡ï¼Œä¸»çº¿ç¨‹å¯è·å¾—å¦å¤–ä¸€ä¸ªçº¿ç¨‹çš„æ‰§è¡Œç»“æœï¼ˆä¸å¤šçº¿ç¨‹çš„ä¸åŒï¼‰ Mqtt (åº”ç”¨)ï¼šMqttCallbackå›è°ƒå‡½æ•° JMM å¯¹Volatile çš„ç†è§£ Volatile æ˜¯ Java è™šæ‹Ÿæœºæä¾› è½»é‡çº§çš„åŒæ­¥æœºåˆ¶ 1ã€ä¿è¯å¯è§æ€§ 2ã€ä¸ä¿è¯åŸå­æ€§ 3ã€ç¦æ­¢æŒ‡ä»¤é‡æ’ ä»€ä¹ˆæ˜¯JMMï¼Ÿ JMMï¼šJAVAå†…å­˜æ¨¡å‹ï¼Œä¸å­˜åœ¨çš„ä¸œè¥¿ï¼Œæ˜¯ä¸€ä¸ªæ¦‚å¿µï¼Œä¹Ÿæ˜¯ä¸€ä¸ªçº¦å®šï¼ å…³äºJMMçš„ä¸€äº›åŒæ­¥çš„çº¦å®šï¼š 1ã€çº¿ç¨‹è§£é”å‰ï¼Œå¿…é¡»æŠŠå…±äº«å˜é‡ç«‹åˆ»åˆ·å›ä¸»å­˜ï¼› 2ã€çº¿ç¨‹åŠ é”å‰ï¼Œå¿…é¡»è¯»å–ä¸»å­˜ä¸­çš„æœ€æ–°å€¼åˆ°å·¥ä½œå†…å­˜ä¸­ï¼› 3ã€åŠ é”å’Œè§£é”æ˜¯åŒä¸€æŠŠé”ï¼› å†…å­˜äº¤äº’æ“ä½œæœ‰8ç§: Readï¼ˆè¯»å–ï¼‰ï¼šä½œç”¨äºä¸»å†…å­˜å˜é‡ï¼Œå®ƒæŠŠä¸€ä¸ªå˜é‡çš„å€¼ä»ä¸»å†…å­˜ä¼ è¾“åˆ°çº¿ç¨‹çš„å·¥ä½œå†…å­˜ä¸­ï¼Œä»¥ä¾¿éšåçš„loadåŠ¨ä½œä½¿ç”¨ï¼› loadï¼ˆè½½å…¥ï¼‰ï¼šä½œç”¨äºå·¥ä½œå†…å­˜çš„å˜é‡ï¼Œå®ƒæŠŠreadæ“ä½œä»ä¸»å­˜ä¸­å˜é‡æ”¾å…¥å·¥ä½œå†…å­˜ä¸­ï¼› Useï¼ˆä½¿ç”¨ï¼‰ï¼šä½œç”¨äºå·¥ä½œå†…å­˜ä¸­çš„å˜é‡ï¼Œå®ƒæŠŠå·¥ä½œå†…å­˜ä¸­çš„å˜é‡ä¼ è¾“ç»™æ‰§è¡Œå¼•æ“ï¼Œæ¯å½“è™šæ‹Ÿæœºé‡åˆ°ä¸€ä¸ªéœ€è¦ä½¿ç”¨åˆ°å˜é‡çš„å€¼ï¼Œå°±ä¼šä½¿ç”¨åˆ°è¿™ä¸ªæŒ‡ä»¤ï¼› assignï¼ˆèµ‹å€¼ï¼‰ï¼šä½œç”¨äºå·¥ä½œå†…å­˜ä¸­çš„å˜é‡ï¼Œå®ƒæŠŠä¸€ä¸ªä»æ‰§è¡Œå¼•æ“ä¸­æ¥å—åˆ°çš„å€¼æ”¾å…¥å·¥ä½œå†…å­˜çš„å˜é‡å‰¯æœ¬ä¸­ï¼› storeï¼ˆå­˜å‚¨ï¼‰ï¼šä½œç”¨äºä¸»å†…å­˜ä¸­çš„å˜é‡ï¼Œå®ƒæŠŠä¸€ä¸ªä»å·¥ä½œå†…å­˜ä¸­ä¸€ä¸ªå˜é‡çš„å€¼ä¼ é€åˆ°ä¸»å†…å­˜ä¸­ï¼Œä»¥ä¾¿åç»­çš„writeä½¿ç”¨ï¼› writeï¼ˆå†™å…¥ï¼‰ï¼šä½œç”¨äºä¸»å†…å­˜ä¸­çš„å˜é‡ï¼Œå®ƒæŠŠstoreæ“ä½œä»å·¥ä½œå†…å­˜ä¸­å¾—åˆ°çš„å˜é‡çš„å€¼æ”¾å…¥ä¸»å†…å­˜çš„å˜é‡ä¸­ï¼› lockï¼ˆé”å®šï¼‰ï¼šä½œç”¨äºä¸»å†…å­˜çš„å˜é‡ï¼ŒæŠŠä¸€ä¸ªå˜é‡æ ‡è¯†ä¸ºçº¿ç¨‹ç‹¬å çŠ¶æ€ï¼› unlockï¼ˆè§£é”ï¼‰ï¼šä½œç”¨äºä¸»å†…å­˜çš„å˜é‡ï¼Œå®ƒæŠŠä¸€ä¸ªå¤„äºé”å®šçŠ¶æ€çš„å˜é‡é‡Šæ”¾å‡ºæ¥ï¼Œé‡Šæ”¾åçš„å˜é‡æ‰å¯ä»¥è¢«å…¶ä»–çº¿ç¨‹é”å®šï¼› æ³¨æ„ï¼šä¸‹é¢è¿™å¹…å›¾ä¸­writeå’Œstoreçš„é¡ºåºåäº†ï¼Œåº”è¯¥å…ˆstoreå†write JMMå¯¹è¿™å…«ç§æŒ‡ä»¤çš„ä½¿ç”¨ï¼Œåˆ¶å®šäº†å¦‚ä¸‹è§„åˆ™ï¼š ä¸å…è®¸readå’Œloadã€storeå’Œwriteæ“ä½œä¹‹ä¸€å•ç‹¬å‡ºç°ï¼Œå¿…é¡»æˆå¯¹ä½¿ç”¨ã€‚å³ä½¿ç”¨äº†readå¿…é¡»loadï¼Œä½¿ç”¨äº†storeå¿…é¡»write ä¸å…è®¸çº¿ç¨‹ä¸¢å¼ƒä»–æœ€è¿‘çš„assignæ“ä½œï¼Œå³å·¥ä½œå˜é‡çš„æ•°æ®æ”¹å˜äº†ä¹‹åï¼Œå¿…é¡»å‘ŠçŸ¥ä¸»å­˜ ä¸å…è®¸ä¸€ä¸ªçº¿ç¨‹å°†æ²¡æœ‰assignçš„æ•°æ®ä»å·¥ä½œå†…å­˜åŒæ­¥å›ä¸»å†…å­˜ä¸€ä¸ªæ–°çš„å˜é‡å¿…é¡»åœ¨ä¸»å†…å­˜ä¸­è¯ç”Ÿï¼Œä¸å…è®¸å·¥ä½œå†…å­˜ç›´æ¥ä½¿ç”¨ä¸€ä¸ªæœªè¢«åˆå§‹åŒ–çš„å˜é‡ã€‚å°±æ˜¯æ€¼å˜é‡å®æ–½useã€storeæ“ä½œä¹‹å‰ï¼Œå¿…é¡»ç»è¿‡assignå’Œloadæ“ä½œ ä¸€ä¸ªå˜é‡åŒä¸€æ—¶é—´åªæœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½å¯¹å…¶è¿›è¡Œlockã€‚å¤šæ¬¡lockåï¼Œå¿…é¡»æ‰§è¡Œç›¸åŒæ¬¡æ•°çš„unlockæ‰èƒ½è§£é” å¦‚æœå¯¹ä¸€ä¸ªå˜é‡è¿›è¡Œlockæ“ä½œï¼Œä¼šæ¸…ç©ºæ‰€æœ‰å·¥ä½œå†…å­˜ä¸­æ­¤å˜é‡çš„å€¼ï¼Œåœ¨æ‰§è¡Œå¼•æ“ä½¿ç”¨è¿™ä¸ªå˜é‡å‰ï¼Œå¿…é¡»é‡æ–°loadæˆ–assignæ“ä½œåˆå§‹åŒ–å˜é‡çš„å€¼ å¦‚æœä¸€ä¸ªå˜é‡æ²¡æœ‰è¢«lockï¼Œå°±ä¸èƒ½å¯¹å…¶è¿›è¡Œunlockæ“ä½œã€‚ä¹Ÿä¸èƒ½unlockä¸€ä¸ªè¢«å…¶ä»–çº¿ç¨‹é”ä½çš„å˜é‡å¯¹ä¸€ä¸ªå˜é‡è¿›è¡Œunlockæ“ä½œä¹‹å‰ï¼Œå¿…é¡»æŠŠæ­¤å˜é‡åŒæ­¥å›ä¸»å†…å­˜é—®é¢˜ï¼š ç¨‹åºä¸çŸ¥é“ä¸»å†…å­˜çš„å€¼å·²ç»è¢«ä¿®æ”¹è¿‡äº† æ¡ˆä¾‹ 12345678910111213141516171819public class JMMDemo &#123; private static int num = 0; public static void main(String[] args) &#123; //main new Thread(()-&gt;&#123; //çº¿ç¨‹1 å¯¹ä¸»å†…å­˜çš„å˜åŒ–ä¸çŸ¥é“çš„ while (num == 0 )&#123; &#125; &#125;).start(); try &#123; TimeUnit.SECONDS.sleep(1); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; num = 1; System.out.println(num); &#125;&#125;/**ç»“æœï¼šç¨‹åºæœªæš‚åœï¼Œçº¿ç¨‹ä¸­numä¸€ç›´ä¸º0*/ volatileVolatile æ˜¯ Java è™šæ‹Ÿæœºæä¾› è½»é‡çº§çš„åŒæ­¥æœºåˆ¶ 1ã€ä¿è¯å¯è§æ€§ 2ã€ä¸ä¿è¯åŸå­æ€§ 3ã€ç¦æ­¢æŒ‡ä»¤é‡æ’ ä¿è¯å¯è§æ€§1234567891011121314151617181920212223public class JMMDemo &#123; // ä¸åŠ  volatile ç¨‹åºå°±ä¼šæ­»å¾ªç¯ï¼ // åŠ  volatile å¯ä»¥ä¿è¯å¯è§æ€§ private volatile static int num = 0; public static void main(String[] args) &#123; //main new Thread(()-&gt;&#123; //çº¿ç¨‹1 å¯¹ä¸»å†…å­˜çš„å˜åŒ–ä¸çŸ¥é“çš„ while (num == 0 )&#123; &#125; &#125;).start(); try &#123; TimeUnit.SECONDS.sleep(1); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; num = 1; System.out.println(num); &#125;&#125; ä¸ä¿è¯åŸå­æ€§åŸå­æ€§ï¼šä¸å¯åˆ†å‰²ï¼› çº¿ç¨‹Aåœ¨æ‰§è¡Œä»»åŠ¡çš„æ—¶å€™ï¼Œä¸èƒ½è¢«æ‰“æ‰°çš„ï¼Œä¹Ÿä¸èƒ½è¢«åˆ†å‰²çš„ï¼Œè¦ä¹ˆåŒæ—¶æˆåŠŸï¼Œè¦ä¹ˆåŒæ—¶å¤±è´¥ã€‚ 123456789101112131415161718192021222324252627282930313233/** * ä¸ä¿è¯åŸå­æ€§ * number &lt;=2w * */public class VDemo02 &#123; private static volatile int number = 0; public static void add()&#123; number++; //++ ä¸æ˜¯ä¸€ä¸ªåŸå­æ€§æ“ä½œï¼Œæ˜¯ä¸¤ä¸ª~3ä¸ªæ“ä½œ // &#125; public static void main(String[] args) &#123; //ç†è®ºä¸Šnumber === 20000 for (int i = 1; i &lt;= 20; i++) &#123; new Thread(()-&gt;&#123; for (int j = 1; j &lt;= 1000 ; j++) &#123; add(); &#125; &#125;).start(); &#125; while (Thread.activeCount() &gt; 2)&#123; //main gc //main gc Thread.yield(); &#125; System.out.println(Thread.currentThread().getName()+&quot;,num=&quot;+number); &#125;&#125; å¦‚æœä¸åŠ lockå’Œsynchronized ï¼Œæ€ä¹ˆæ ·ä¿è¯åŸå­æ€§ï¼Ÿ ä½¿ç”¨åŸå­ç±»ï¼Œè§£å†³åŸå­æ€§é—®é¢˜ï¼Œæ¯”é”é«˜æ•ˆå¾ˆå¤šå€ï¼ 1234567891011121314151617181920212223242526public class VDemo02 &#123; private static volatile AtomicInteger number = new AtomicInteger(); public static void add()&#123; number.getAndIncrement(); // AtomicInteger +1 æ–¹æ³• ï¼ŒCAS &#125; public static void main(String[] args) &#123; //ç†è®ºä¸Šnumber === 20000 for (int i = 1; i &lt;= 20; i++) &#123; new Thread(()-&gt;&#123; for (int j = 1; j &lt;= 1000 ; j++) &#123; add(); &#125; &#125;).start(); &#125; while (Thread.activeCount() &gt; 2)&#123; //main gc Thread.yield(); &#125; System.out.println(Thread.currentThread().getName()+&quot;,num=&quot;+number); &#125;&#125; è¿™äº›ç±»çš„åº•å±‚éƒ½ç›´æ¥å’Œæ“ä½œç³»ç»ŸæŒ‚é’©ï¼æ˜¯åœ¨å†…å­˜ä¸­ä¿®æ”¹å€¼ã€‚ Unsafeç±»æ˜¯ä¸€ä¸ªå¾ˆç‰¹æ®Šçš„å­˜åœ¨ï¼› ç¦æ­¢æŒ‡ä»¤é‡æ’ ä»€ä¹ˆæ˜¯æŒ‡ä»¤é‡æ’ï¼Ÿ æˆ‘ä»¬å†™çš„ç¨‹åºï¼Œè®¡ç®—æœºå¹¶ä¸æ˜¯æŒ‰ç…§æˆ‘ä»¬è‡ªå·±å†™çš„é‚£æ ·å»æ‰§è¡Œçš„ æºä»£ç â€“&gt;ç¼–è¯‘å™¨ä¼˜åŒ–é‡æ’â€“&gt;æŒ‡ä»¤å¹¶è¡Œä¹Ÿå¯èƒ½ä¼šé‡æ’â€“&gt;å†…å­˜ç³»ç»Ÿä¹Ÿä¼šé‡æ’â€“&gt;æ‰§è¡Œ å¤„ç†å™¨åœ¨è¿›è¡ŒæŒ‡ä»¤é‡æ’çš„æ—¶å€™ï¼Œä¼šè€ƒè™‘æ•°æ®ä¹‹é—´çš„ä¾èµ–æ€§ï¼ 1234567int x=1; //1int y=2; //2x=x+5; //3y=x*x; //4//æˆ‘ä»¬æœŸæœ›çš„æ‰§è¡Œé¡ºåºæ˜¯ 1_2_3_4 å¯èƒ½æ‰§è¡Œçš„é¡ºåºä¼šå˜æˆ2134 1324//å¯ä¸å¯èƒ½æ˜¯ 4123ï¼Ÿ ä¸å¯èƒ½çš„ å¯èƒ½é€ æˆçš„å½±å“ç»“æœï¼šå‰æï¼ša b x yè¿™å››ä¸ªå€¼ é»˜è®¤éƒ½æ˜¯0 çº¿ç¨‹A çº¿ç¨‹B x&#x3D;a y&#x3D;b b&#x3D;1 a&#x3D;2 æ­£å¸¸çš„ç»“æœï¼š x &#x3D; 0; y &#x3D;0; çº¿ç¨‹A çº¿ç¨‹B b&#x3D;1 a&#x3D;2 x&#x3D;a y&#x3D;b å¯èƒ½åœ¨çº¿ç¨‹Aä¸­ä¼šå‡ºç°ï¼Œå…ˆæ‰§è¡Œb&#x3D;1,ç„¶åå†æ‰§è¡Œx&#x3D;aï¼› åœ¨Bçº¿ç¨‹ä¸­å¯èƒ½ä¼šå‡ºç°ï¼Œå…ˆæ‰§è¡Œa&#x3D;2ï¼Œç„¶åæ‰§è¡Œy&#x3D;bï¼› é‚£ä¹ˆå°±æœ‰å¯èƒ½ç»“æœå¦‚ä¸‹ï¼šx&#x3D;2; y&#x3D;1. volatileå¯ä»¥é¿å…æŒ‡ä»¤é‡æ’ï¼š volatileä¸­ä¼šåŠ ä¸€é“å†…å­˜çš„å±éšœï¼Œè¿™ä¸ªå†…å­˜å±éšœå¯ä»¥ä¿è¯åœ¨è¿™ä¸ªå±éšœä¸­çš„æŒ‡ä»¤é¡ºåºã€‚ å†…å­˜å±éšœï¼šCPUæŒ‡ä»¤ã€‚ä½œç”¨ï¼š 1ã€ä¿è¯ç‰¹å®šçš„æ“ä½œçš„æ‰§è¡Œé¡ºåºï¼› 2ã€å¯ä»¥ä¿è¯æŸäº›å˜é‡çš„å†…å­˜å¯è§æ€§ï¼ˆåˆ©ç”¨è¿™äº›ç‰¹æ€§ï¼Œå°±å¯ä»¥ä¿è¯volatileå®ç°çš„å¯è§æ€§ï¼‰ volatileåœ¨ä¸Šä¸‹åŠ ä¸Šä¸¤å±‚å†…å­˜å±éšœï¼Œé˜²æ­¢æŒ‡ä»¤é‡æ’ã€‚ åœ¨å“ªé‡Œå†…å­˜å±éšœç”¨å¾—æœ€å¤šï¼Ÿå•ä¾‹æ¨¡å¼ ç©è½¬å•ä¾‹æ¨¡å¼ä¸ºä»€ä¹ˆæšä¸¾å¯ä»¥é¿å…å•ä¾‹æ¨¡å¼è¢«ç ´åï¼Ÿ é¥¿æ±‰å¼ DCLæ‡’æ±‰å¼ï¼Œæ·±ç©¶ï¼ é¥¿æ±‰å¼123456789101112131415161718//é¥¿æ±‰å¼å•ä¾‹public class Hungry &#123; //ä¸€ä¸Šæ¥å°±å®ä¾‹åŒ–ï¼Œå¯èƒ½ä¼šæµªè´¹ç©ºé—´ private byte[] data1 = new byte[1024*1024]; private byte[] data2 = new byte[1024*1024]; private byte[] data3 = new byte[1024*1024]; private byte[] data4 = new byte[1024*1024]; //ç§æœ‰åŒ–æ„é€ å™¨ private Hungry() &#123; &#125; private final static Hungry HUNGRY = new Hungry(); public static Hungry getInstance() &#123; return HUNGRY; &#125;&#125; DCLæ‡’æ±‰å¼ æ‡’æ±‰å¼å•ä¾‹ 123456789101112131415161718192021222324252627282930313233// æ‡’æ±‰å¼å•ä¾‹public class LazyMan &#123; //ç§æœ‰åŒ–æ„é€ å™¨ private LazyMan() &#123; System.out.println(Thread.currentThread().getName()+&quot; OK&quot;); &#125; private static LazyMan lazyMan; public static LazyMan getInstance() &#123; if (lazyMan == null) &#123; lazyMan = new LazyMan(); &#125; return lazyMan; &#125; //å¤šçº¿ç¨‹å¹¶å‘ ï¼Œä¼šæœ‰éšæ‚£ï¼ public static void main(String[] args) &#123; for (int i = 0; i &lt; 10; i++) &#123; new Thread(()-&gt;&#123; lazyMan.getInstance(); &#125;).start(); &#125; &#125;&#125;/**å¯èƒ½ç»“æœï¼šThread-0 OKThread-2 OKThread-1 OK*/ åŒé‡æ£€æµ‹é”æ¨¡å¼çš„ æ‡’æ±‰å¼å•ä¾‹ï¼ˆDCLæ‡’æ±‰å¼ï¼‰ 123456789101112131415161718192021222324252627282930313233343536373839public class LazyMan &#123; //ç§æœ‰åŒ–æ„é€ å™¨ private LazyMan() &#123; System.out.println(Thread.currentThread().getName()+&quot; OK&quot;); &#125; private static LazyMan lazyMan; //åŒé‡æ£€æµ‹é”æ¨¡å¼çš„ æ‡’æ±‰å¼å•ä¾‹ DCLæ‡’æ±‰å¼ public static LazyMan getInstance() &#123; if (lazyMan == null)&#123; synchronized (LazyMan.class)&#123; if (lazyMan == null) &#123; lazyMan = new LazyMan(); //ä¸æ˜¯ä¸€ä¸ªåŸå­æ€§æ“ä½œ /** * 1. åˆ†é…å†…å­˜ç©ºé—´ * 2. æ‰§è¡Œæ„é€ æ–¹æ³•ï¼Œåˆå§‹åŒ–å¯¹è±¡ * 3. æŠŠè¿™ä¸ªå¯¹è±¡æŒ‡å‘è¿™ä¸ªç©ºé—´ * * 123 * 132 A * B // æ­¤æ—¶lazyManè¿˜æ²¡æœ‰å®Œæˆæ„é€  */ &#125; &#125; &#125; return lazyMan; &#125; //å¤šçº¿ç¨‹å¹¶å‘ public static void main(String[] args) &#123; for (int i = 0; i &lt; 10; i++) &#123; new Thread(()-&gt;&#123; lazyMan.getInstance(); &#125;).start(); &#125; &#125;&#125; åŒé‡æ£€æµ‹é” + åŸå­æ€§æ“ä½œ çš„æ‡’æ±‰å¼å•ä¾‹ï¼ˆDCLæ‡’æ±‰å¼ï¼‰ åŠ volatile 123456789101112131415161718192021222324252627282930313233343536373839public class LazyMan &#123; //ç§æœ‰åŒ–æ„é€ å™¨ private LazyMan() &#123; System.out.println(Thread.currentThread().getName()+&quot; OK&quot;); &#125; private volatile static LazyMan lazyMan; //åŒé‡æ£€æµ‹é”æ¨¡å¼çš„ æ‡’æ±‰å¼å•ä¾‹ DCLæ‡’æ±‰å¼ public static LazyMan getInstance() &#123; if (lazyMan == null)&#123; synchronized (LazyMan.class)&#123; if (lazyMan == null) &#123; lazyMan = new LazyMan(); //ä¸æ˜¯ä¸€ä¸ªåŸå­æ€§æ“ä½œ /** * 1. åˆ†é…å†…å­˜ç©ºé—´ * 2. æ‰§è¡Œæ„é€ æ–¹æ³•ï¼Œåˆå§‹åŒ–å¯¹è±¡ * 3. æŠŠè¿™ä¸ªå¯¹è±¡æŒ‡å‘è¿™ä¸ªç©ºé—´ * * 123 * 132 A * B // æ­¤æ—¶lazyManè¿˜æ²¡æœ‰å®Œæˆæ„é€  */ &#125; &#125; &#125; return lazyMan; &#125; //å¤šçº¿ç¨‹å¹¶å‘ public static void main(String[] args) &#123; for (int i = 0; i &lt; 10; i++) &#123; new Thread(()-&gt;&#123; lazyMan.getInstance(); &#125;).start(); &#125; &#125;&#125; é™æ€å†…éƒ¨ç±»1234567891011public class Holder &#123; private Holder()&#123; &#125; public static Holder getInstance()&#123; return InnerClass.holder; &#125; public static class InnerClass&#123; private static final Holder holder = new Holder(); &#125;&#125; ä»¥ä¸Šéƒ½ä¸å®‰å…¨ï¼Œå¯ä»¥é€šè¿‡åå°„ç ´åï¼ æšä¸¾ä½¿ç”¨æšä¸¾ï¼Œæˆ‘ä»¬å°±å¯ä»¥é˜²æ­¢åå°„ç ´åäº†ã€‚ 1234567891011121314151617181920//enum æ˜¯ä»€ä¹ˆï¼Ÿ enumæœ¬èº«å°±æ˜¯ä¸€ä¸ªClass ç±»public enum EnumSingle &#123; INSTANCE; public EnumSingle getInstance()&#123; return INSTANCE; &#125;&#125;class Test&#123; public static void main(String[] args) throws NoSuchMethodException, IllegalAccessException, InvocationTargetException, InstantiationException &#123; EnumSingle instance1 = EnumSingle.INSTANCE; Constructor&lt;EnumSingle&gt; declaredConstructor = EnumSingle.class.getDeclaredConstructor(String.class,int.class); declaredConstructor.setAccessible(true); //java.lang.NoSuchMethodException: com.ogj.single.EnumSingle.&lt;init&gt;() EnumSingle instance2 = declaredConstructor.newInstance(); System.out.println(instance1); System.out.println(instance2); &#125;&#125; æ·±å…¥ç†è§£CAS ä»€ä¹ˆæ˜¯CASï¼Ÿ è¿›å¤§å‚å¿…é¡»è¦æ·±å…¥ç ”ç©¶åº•å±‚ï¼å¦åˆ™è¿›ä¸å»ï¼æœ‰æ‰€çªç ´ï¼ ä¿®å†…åŠŸï¼Œæ“ä½œç³»ç»Ÿï¼Œè®¡ç®—æœºç½‘ç»œåŸç†ã€‚ CAS : compareAndSet æ¯”è¾ƒå¹¶äº¤æ¢ javaä»£ç ï¼š 1234567891011121314151617181920public class CASDemo &#123; //CAS : compareAndSet æ¯”è¾ƒå¹¶äº¤æ¢ public static void main(String[] args) &#123; AtomicInteger atomicInteger = new AtomicInteger(2020); //boolean compareAndSet(int expect, int update) //æœŸæœ›å€¼ã€æ›´æ–°å€¼ //å¦‚æœå®é™…å€¼ å’Œ æˆ‘çš„æœŸæœ›å€¼ç›¸åŒï¼Œé‚£ä¹ˆå°±æ›´æ–° //å¦‚æœå®é™…å€¼ å’Œ æˆ‘çš„æœŸæœ›å€¼ä¸åŒï¼Œé‚£ä¹ˆå°±ä¸æ›´æ–° System.out.println(atomicInteger.compareAndSet(2020, 2021)); System.out.println(atomicInteger.get()); //å› ä¸ºæœŸæœ›å€¼æ˜¯2020 å®é™…å€¼å´å˜æˆäº†2021 æ‰€ä»¥ä¼šä¿®æ”¹å¤±è´¥ //CAS æ˜¯CPUçš„å¹¶å‘åŸè¯­ atomicInteger.getAndIncrement(); //++æ“ä½œ System.out.println(atomicInteger.compareAndSet(2020, 2021)); System.out.println(atomicInteger.get()); &#125;&#125; Unsafe ç±» æ€»ç»“ CASï¼šæ¯”è¾ƒå½“å‰å·¥ä½œå†…å­˜ä¸­çš„å€¼ å’Œ ä¸»å†…å­˜ä¸­çš„å€¼ï¼Œå¦‚æœè¿™ä¸ªå€¼æ˜¯æœŸæœ›çš„ï¼Œé‚£ä¹ˆåˆ™æ‰§è¡Œæ“ä½œï¼å¦‚æœä¸æ˜¯å°±ä¸€ç›´å¾ªç¯ï¼Œä½¿ç”¨çš„æ˜¯è‡ªæ—‹é”ã€‚ ç¼ºç‚¹ï¼š å¾ªç¯ä¼šè€—æ—¶ï¼› ä¸€æ¬¡æ€§åªèƒ½ä¿è¯ä¸€ä¸ªå…±äº«å˜é‡çš„åŸå­æ€§ï¼› å®ƒä¼šå­˜åœ¨ABAé—®é¢˜ CASï¼šABAé—®é¢˜ï¼ˆç‹¸çŒ«æ¢å¤ªå­ï¼‰ çº¿ç¨‹1ï¼šæœŸæœ›å€¼æ˜¯1ï¼Œè¦å˜æˆ2ï¼› çº¿ç¨‹2ï¼šä¸¤ä¸ªæ“ä½œï¼š 1ã€æœŸæœ›å€¼æ˜¯1ï¼Œå˜æˆ3 2ã€æœŸæœ›æ˜¯3ï¼Œå˜æˆ1 æ‰€ä»¥å¯¹äºçº¿ç¨‹1æ¥è¯´ï¼ŒAçš„å€¼è¿˜æ˜¯1ï¼Œæ‰€ä»¥å°±å‡ºç°äº†é—®é¢˜ï¼Œéª—è¿‡äº†çº¿ç¨‹1ï¼› 12345678910111213141516171819202122public class CASDemo &#123; // CAS compareAndSet : æ¯”è¾ƒå¹¶äº¤æ¢ï¼ public static void main(String[] args) &#123; AtomicInteger atomicInteger = new AtomicInteger(2020); //å¹³æ—¶å†™çš„SQLï¼šä¹è§‚é” //æœŸæœ› æ›´æ–° //public final boolean compareAndSet(int expect, int update) // å¦‚æœæˆ‘æœŸæœ›çš„å€¼è¾¾åˆ°äº†ï¼Œé‚£ä¹ˆå°±æ›´æ–°ï¼Œå¦åˆ™ï¼Œå°±ä¸æ›´æ–°, CAS æ˜¯CPUçš„å¹¶å‘åŸè¯­ï¼ // ============== æ£ä¹±çš„çº¿ç¨‹ ================== System.out.println(atomicInteger.compareAndSet(2020, 2021)); System.out.println(atomicInteger.get()); System.out.println(atomicInteger.compareAndSet(2021, 2020)); System.out.println(atomicInteger.get()); // ============== æœŸæœ›çš„çº¿ç¨‹ ================== System.out.println(atomicInteger.compareAndSet(2020, 77777)); System.out.println(atomicInteger.get()); &#125;&#125; åŸå­å¼•ç”¨ è§£å†³ABA é—®é¢˜ï¼šå¼•å…¥åŸå­å¼•ç”¨ï¼Œå¯¹åº”çš„æ€æƒ³ï¼šä¹è§‚é”ï¼ å¸¦ç‰ˆæœ¬å· çš„åŸå­æ“ä½œï¼ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354public class CASDemo &#123; // AtomicStampedReference æ³¨æ„ï¼Œå¦‚æœæ³›å‹æ˜¯ä¸€ä¸ªåŒ…è£…ç±»ï¼Œæ³¨æ„å¯¹è±¡çš„å¼•ç”¨é—®é¢˜ // æ­£å¸¸åœ¨ä¸šåŠ¡æ“ä½œï¼Œè¿™é‡Œé¢æ¯”è¾ƒçš„éƒ½æ˜¯ä¸€ä¸ªä¸ªå¯¹è±¡ static AtomicStampedReference&lt;Integer&gt; atomicStampedReference = new AtomicStampedReference&lt;&gt;(1, 1); // CAS compareAndSet : æ¯”è¾ƒå¹¶äº¤æ¢ï¼ public static void main(String[] args) &#123; new Thread(() -&gt; &#123; int stamp = atomicStampedReference.getStamp();//è·å¾—ç‰ˆæœ¬å· System.out.println(&quot;a1=&gt;&quot;+stamp); try &#123; TimeUnit.SECONDS.sleep(2); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; System.out.println(atomicStampedReference.compareAndSet(10, 11, atomicStampedReference.getStamp(), atomicStampedReference.getStamp() + 1)); System.out.println(&quot;a2=&gt;&quot; + atomicStampedReference.getStamp()); System.out.println(atomicStampedReference.compareAndSet(11, 10, atomicStampedReference.getStamp(), atomicStampedReference.getStamp() + 1)); System.out.println(&quot;a3=&gt;&quot;+atomicStampedReference.getStamp()); &#125;,&quot;a&quot;).start(); new Thread(() -&gt; &#123; int stamp = atomicStampedReference.getStamp();//è·å¾—ç‰ˆæœ¬å· System.out.println(&quot;b1=&gt;&quot;+stamp); try &#123; TimeUnit.SECONDS.sleep(2); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; System.out.println(atomicStampedReference.compareAndSet(10, 15, stamp, stamp + 1)); System.out.println(&quot;b2=&gt;&quot;+atomicStampedReference.getStamp()); &#125;,&quot;b&quot;).start(); &#125;&#125; æ³¨æ„ï¼š Integer ä½¿ç”¨äº†å¯¹è±¡ç¼“å­˜æœºåˆ¶ï¼Œé»˜è®¤èŒƒå›´æ˜¯ -128 ~ 127 ï¼Œæ¨èä½¿ç”¨é™æ€å·¥å‚æ–¹æ³• valueOf è·å–å¯¹è±¡å®ä¾‹ï¼Œè€Œä¸æ˜¯ newï¼Œå› ä¸º valueOf ä½¿ç”¨ç¼“å­˜ï¼Œè€Œ new ä¸€å®šä¼šåˆ›å»ºæ–°çš„å¯¹è±¡åˆ†é…æ–°çš„å†…å­˜ç©ºé—´ï¼› é˜¿é‡Œå·´å·´å¼€å‘æ‰‹å†Œï¼š å„ç§é”çš„ç†è§£å…¬å¹³é”ï¼Œéå…¬å¹³é”å…¬å¹³é”ï¼š éå¸¸å…¬å¹³ï¼Œ ä¸èƒ½å¤Ÿæ’é˜Ÿï¼Œå¿…é¡»å…ˆæ¥ååˆ°ï¼ éå…¬å¹³é”ï¼šéå¸¸ä¸å…¬å¹³ï¼Œå¯ä»¥æ’é˜Ÿ ï¼ˆé»˜è®¤éƒ½æ˜¯éå…¬å¹³ï¼‰ æºç ï¼š 1234567public ReentrantLock() &#123; sync = new NonfairSync();&#125;public ReentrantLock(boolean fair) &#123; sync = fair ? new FairSync() : new NonfairSync();&#125; å¯é‡å…¥é”å¯é‡å…¥é”ï¼ˆé€’å½’é”ï¼‰ Synchronized 1234567891011121314151617181920212223public class Demo01 &#123; public static void main(String[] args) &#123; Phone phone = new Phone(); new Thread(()-&gt;&#123; phone.sms(); &#125;,&quot;A&quot;).start(); new Thread(()-&gt;&#123; phone.sms(); &#125;,&quot;B&quot;).start(); &#125;&#125;class Phone&#123; public synchronized void sms()&#123; System.out.println(Thread.currentThread().getName()+&quot;ï¼šsms&quot;); call();//è¿™é‡Œä¹Ÿæœ‰é” &#125; public synchronized void call()&#123; System.out.println(Thread.currentThread().getName()+&quot;ï¼šcall&quot;); &#125;&#125; Lock ç‰ˆ 1234567891011121314151617181920212223242526272829303132333435363738394041public class Demo02 &#123; public static void main(String[] args) &#123; Phone2 phone = new Phone2(); new Thread(() -&gt; &#123; phone.sms(); &#125;, &quot;A&quot;).start(); new Thread(() -&gt; &#123; phone.sms(); &#125;, &quot;B&quot;).start(); &#125;&#125;class Phone2 &#123; Lock lock = new ReentrantLock(); public synchronized void sms() &#123; lock.lock();// ç»†èŠ‚é—®é¢˜ï¼šlock.lock(); lock.unlock(); // locké”å¿…é¡»é…å¯¹ï¼Œlockä¸unlockæˆå¯¹å‡ºç°ï¼Œå¦åˆ™å°±ä¼šæ­»åœ¨é‡Œé¢ try &#123; System.out.println(Thread.currentThread().getName() + &quot;ï¼šsms&quot;); call();//è¿™é‡Œä¹Ÿæœ‰é” &#125; catch (Exception e) &#123; e.printStackTrace(); &#125; finally &#123; lock.unlock(); &#125; &#125; public synchronized void call() &#123; lock.lock(); try &#123; System.out.println(Thread.currentThread().getName() + &quot;ï¼šcall&quot;); &#125; catch (Exception e) &#123; e.printStackTrace(); &#125; finally &#123; lock.unlock(); &#125; &#125;&#125; locké”å¿…é¡»é…å¯¹ï¼Œç›¸å½“äºlockå’Œ unlock å¿…é¡»æ•°é‡ç›¸åŒï¼› åœ¨å¤–é¢åŠ çš„é”ï¼Œä¹Ÿå¯ä»¥åœ¨é‡Œé¢è§£é”ï¼›åœ¨é‡Œé¢åŠ çš„é”ï¼Œåœ¨å¤–é¢ä¹Ÿå¯ä»¥è§£é”ï¼› è‡ªæ—‹é”spinlock æºç  è‡ªæˆ‘è®¾è®¡ è‡ªæ—‹é” è‡ªå®šä¹‰ä¸€ä¸ªé”ï¼š 1234567891011121314151617181920212223242526/** * è‡ªæ—‹é” */public class SpinlockDemo &#123; // åˆå§‹ï¼š int -&gt; 0; å¼•ç”¨ç±»å‹ Thread -&gt; null AtomicReference&lt;Thread&gt; atomicReference = new AtomicReference&lt;&gt;(); // åŠ é” public void myLock() &#123; Thread thread = Thread.currentThread(); System.out.println(Thread.currentThread().getName() + &quot;==&gt;myLock&quot;); //è‡ªæ—‹é” while (!atomicReference.compareAndSet(null, thread)) &#123; &#125; &#125; // è§£é” public void myUnlock() &#123; Thread thread = Thread.currentThread(); System.out.println(Thread.currentThread().getName() + &quot;==&gt;myUnlock&quot;); //è‡ªæ—‹é” atomicReference.compareAndSet(thread, null); &#125;&#125; æµ‹è¯•ï¼š 123456789101112131415161718192021222324252627282930313233343536public class TestSpinLock &#123; public static void main(String[] args) &#123; //ReentrantLock ReentrantLock reentrantLock = new ReentrantLock(); reentrantLock.lock(); reentrantLock.unlock(); // åº•å±‚ä½¿ç”¨çš„è‡ªæ—‹é”CAS SpinlockDemo lock = new SpinlockDemo(); new Thread(()-&gt;&#123; lock.myLock(); try &#123; TimeUnit.SECONDS.sleep(3); &#125; catch (Exception e) &#123; e.printStackTrace(); &#125; finally &#123; lock.myUnlock(); &#125; &#125;,&quot;T1&quot;).start(); new Thread(()-&gt;&#123; lock.myLock(); try &#123; TimeUnit.SECONDS.sleep(1); &#125; catch (Exception e) &#123; e.printStackTrace(); &#125; finally &#123; lock.myUnlock(); &#125; &#125;,&quot;T2&quot;).start(); &#125;&#125; è¿è¡Œç»“æœï¼š t2è¿›ç¨‹å¿…é¡»ç­‰å¾…t1è¿›ç¨‹Unlockåï¼Œæ‰èƒ½Unlockï¼Œåœ¨è¿™ä¹‹å‰è¿›è¡Œè‡ªæ—‹ç­‰å¾…ã€‚ã€‚ã€‚ã€‚ æ­»é” æ­»é”æ˜¯ä»€ä¹ˆ æ­»é”æµ‹è¯• 123456789101112131415161718192021222324252627282930313233343536public class DeadLockDemo &#123; public static void main(String[] args) &#123; String lockA = &quot;lockA&quot;; String lockB = &quot;lockB&quot;; new Thread(new MyThread(lockA, lockB), &quot;T1&quot;).start(); new Thread(new MyThread(lockB, lockA), &quot;T2&quot;).start(); &#125;&#125;class MyThread implements Runnable &#123; private String lockA; private String lockB; public MyThread(String lockA, String lockB) &#123; this.lockA = lockA; this.lockB = lockB; &#125; @Override public void run() &#123; synchronized (lockA) &#123; System.out.println(Thread.currentThread().getName() + &quot;lock:&quot; + lockA + &quot;=&gt;get&quot; + lockB); try &#123; TimeUnit.SECONDS.sleep(2); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; synchronized (lockB) &#123; System.out.println(Thread.currentThread().getName() + &quot;lock:&quot; + lockB + &quot;=&gt;get&quot; + lockA); &#125; &#125; &#125;&#125; è§£å†³é—®é¢˜ 1ã€ä½¿ç”¨jpså®šä½è¿›ç¨‹å·ï¼Œjdkçš„binç›®å½•ä¸‹ï¼š æœ‰ä¸€ä¸ªjps å‘½ä»¤ï¼šjps -l è¾“å…¥å‘½ä»¤çš„ä½ç½®ï¼š 2ã€ä½¿ç”¨jstack è¿›ç¨‹è¿›ç¨‹å· æ‰¾åˆ°æ­»é”ä¿¡æ¯ ä¸€èˆ¬æƒ…å†µä¿¡æ¯åœ¨æœ€åï¼š é¢è¯•ï¼šå·¥ä½œä¸­æ’æŸ¥é—®é¢˜ï¼š æŸ¥çœ‹æ—¥å¿— å †æ ˆä¿¡æ¯ï¼ï¼ï¼","categories":[],"tags":[]},{"title":"IDEAè°ƒè¯•æŠ€å·§","slug":"IDEAè°ƒè¯•æŠ€å·§","date":"2022-03-03T13:47:51.680Z","updated":"2022-03-04T03:38:48.091Z","comments":true,"path":"2022/03/03/IDEAè°ƒè¯•æŠ€å·§/","link":"","permalink":"https://blog.jiascu.top/2022/03/03/IDEA%E8%B0%83%E8%AF%95%E6%8A%80%E5%B7%A7/","excerpt":"","text":"IDEAè°ƒè¯•æŠ€å·§æ–­ç‚¹ç»Ÿä¸€å¼€å…³Mute Breakpoints æ¡ä»¶æ–­ç‚¹æ–­ç‚¹å¤„ç‚¹å‡»å³é”® å•æ­¥è°ƒè¯• Step Over (F8) ä¸‹ä¸€æ­¥ï¼ˆè¡Œï¼‰ Step Into (F7) è¿›å…¥æ–¹æ³•å†…éƒ¨ Force Step Into (Alt + Shift + F7) å¼ºåˆ¶è¿›å…¥æ–¹æ³•å†…éƒ¨ Step Out (Shift + F8) é€€å‡ºå½“å‰æ–¹æ³• è¡¨è¾¾å¼æ±‚å€¼Evaluate Expression (Alt + F8) è®¡ç®—è¡¨è¾¾å¼ åŸºæœ¬ç”¨æ³•æ€»ç»“ã€å¿«æ·é”®ç¬¬ä¸€ç»„æŒ‰é’®å…±8ä¸ªæŒ‰é’®ï¼Œä»å·¦åˆ°å³ä¾æ¬¡å¦‚ä¸‹ï¼š Show Execution Point (Alt + F10) å¦‚æœä½ çš„å…‰æ ‡åœ¨å…¶å®ƒè¡Œæˆ–å…¶å®ƒé¡µé¢ï¼Œç‚¹å‡»è¿™ä¸ªæŒ‰é’®å¯è·³è½¬åˆ°å½“å‰ä»£ç æ‰§è¡Œçš„è¡Œã€‚ Step Over (F8) ä¸‹ä¸€æ­¥ï¼ˆè¡Œï¼‰ æ­¥è¿‡ï¼Œä¸€è¡Œä¸€è¡Œåœ°å¾€ä¸‹èµ°ï¼Œå¦‚æœè¿™ä¸€è¡Œä¸Šæœ‰æ–¹æ³•ä¸ä¼šè¿›å…¥æ–¹æ³•ã€‚ Step Into (F7) è¿›å…¥æ–¹æ³•å†…éƒ¨ æ­¥å…¥ï¼Œå¦‚æœå½“å‰è¡Œæœ‰æ–¹æ³•ï¼Œå¯ä»¥è¿›å…¥æ–¹æ³•å†…éƒ¨ï¼Œä¸€èˆ¬ç”¨äºè¿›å…¥è‡ªå®šä¹‰æ–¹æ³•å†…ï¼Œä¸ä¼šè¿›å…¥å®˜æ–¹ç±»åº“çš„æ–¹æ³•ï¼Œå¦‚ç¬¬25è¡Œçš„putæ–¹æ³•ã€‚ Force Step Into (Alt + Shift + F7) å¼ºåˆ¶è¿›å…¥æ–¹æ³•å†…éƒ¨ å¼ºåˆ¶æ­¥å…¥ï¼Œèƒ½è¿›å…¥ä»»ä½•æ–¹æ³•ï¼ŒæŸ¥çœ‹åº•å±‚æºç çš„æ—¶å€™å¯ä»¥ç”¨è¿™ä¸ªè¿›å…¥å®˜æ–¹ç±»åº“çš„æ–¹æ³•ã€‚ Step Out (Shift + F8) é€€å‡ºå½“å‰æ–¹æ³• æ­¥å‡ºï¼Œä»æ­¥å…¥çš„æ–¹æ³•å†…é€€å‡ºåˆ°æ–¹æ³•è°ƒç”¨å¤„ï¼Œæ­¤æ—¶æ–¹æ³•å·²æ‰§è¡Œå®Œæ¯•ï¼Œåªæ˜¯è¿˜æ²¡æœ‰å®Œæˆèµ‹å€¼ã€‚ Drop Frame å›é€€æ–­ç‚¹ Run to Cursor (Alt + F9) è¿è¡Œåˆ°å…‰æ ‡å¤„ ä½ å¯ä»¥å°†å…‰æ ‡å®šä½åˆ°ä½ éœ€è¦æŸ¥çœ‹çš„é‚£ä¸€è¡Œï¼Œç„¶åä½¿ç”¨è¿™ä¸ªåŠŸèƒ½ï¼Œä»£ç ä¼šè¿è¡Œè‡³å…‰æ ‡è¡Œï¼Œè€Œä¸éœ€è¦æ‰“æ–­ç‚¹ã€‚ Evaluate Expression (Alt + F8) è®¡ç®—è¡¨è¾¾å¼ ç¬¬äºŒç»„æŒ‰é’®å…±7ä¸ªæŒ‰é’®ï¼Œä»ä¸Šåˆ°ä¸‹ä¾æ¬¡å¦‚ä¸‹ï¼š Rerun â€˜xxxxâ€™ é‡æ–°è¿è¡Œç¨‹åºï¼Œä¼šå…³é—­æœåŠ¡åé‡æ–°å¯åŠ¨ç¨‹åºã€‚ Update â€˜techâ€™ application (Ctrl + F5) æ›´æ–°ç¨‹åºï¼Œä¸€èˆ¬åœ¨ä½ çš„ä»£ç æœ‰æ”¹åŠ¨åå¯æ‰§è¡Œè¿™ä¸ªåŠŸèƒ½ã€‚è€Œè¿™ä¸ªåŠŸèƒ½å¯¹åº”çš„æ“ä½œåˆ™æ˜¯åœ¨æœåŠ¡é…ç½®é‡Œ Resume Program (F9) åªåœ¨æ–­ç‚¹åœç•™ æ¢å¤ç¨‹åºï¼Œæ¯”å¦‚ï¼Œä½ åœ¨ç¬¬20è¡Œå’Œ25è¡Œæœ‰ä¸¤ä¸ªæ–­ç‚¹ï¼Œå½“å‰è¿è¡Œè‡³ç¬¬20è¡Œï¼ŒæŒ‰F9ï¼Œåˆ™è¿è¡Œåˆ°ä¸‹ä¸€ä¸ªæ–­ç‚¹(å³ç¬¬25è¡Œ)ï¼Œå†æŒ‰F9ï¼Œåˆ™è¿è¡Œå®Œæ•´ä¸ªæµç¨‹ï¼Œå› ä¸ºåé¢å·²ç»æ²¡æœ‰æ–­ç‚¹äº† Pause Program æš‚åœç¨‹åºï¼Œå¯ç”¨Debugã€‚ Stop â€˜xxxâ€™ (Ctrl + F2) è¿ç»­æŒ‰ä¸¤ä¸‹ï¼Œå…³é—­ç¨‹åºã€‚æœ‰æ—¶å€™ä½ ä¼šå‘ç°å…³é—­æœåŠ¡å†å¯åŠ¨æ—¶ï¼ŒæŠ¥ç«¯å£è¢«å ç”¨ï¼Œè¿™æ˜¯å› ä¸ºæ²¡å®Œå…¨å…³é—­æœåŠ¡çš„åŸå› ï¼Œä½ å°±éœ€è¦æŸ¥æ€æ‰€æœ‰JVMè¿›ç¨‹äº†ã€‚ View Breakpoints (Ctrl + Shift + F8) æŸ¥çœ‹æ‰€æœ‰æ–­ç‚¹ Mute Breakpoints å…³é—­æ–­ç‚¹ å“‘çš„æ–­ç‚¹ï¼Œé€‰æ‹©è¿™ä¸ªåï¼Œæ‰€æœ‰æ–­ç‚¹å˜ä¸ºç°è‰²ï¼Œæ–­ç‚¹å¤±æ•ˆï¼ŒæŒ‰F9åˆ™å¯ä»¥ç›´æ¥è¿è¡Œå®Œç¨‹åºã€‚å†æ¬¡ç‚¹å‡»ï¼Œæ–­ç‚¹å˜ä¸ºçº¢è‰²ï¼Œæœ‰æ•ˆã€‚å¦‚æœåªæƒ³ä½¿æŸä¸€ä¸ªæ–­ç‚¹å¤±æ•ˆï¼Œå¯ä»¥åœ¨æ–­ç‚¹ä¸Šå³é”®å–æ¶ˆEnabledï¼Œå¦‚å›¾2.4ï¼Œåˆ™è¯¥è¡Œæ–­ç‚¹å¤±æ•ˆã€‚","categories":[],"tags":[]},{"title":"else","slug":"else","date":"2022-03-03T13:47:51.660Z","updated":"2022-03-04T03:33:08.463Z","comments":true,"path":"2022/03/03/else/","link":"","permalink":"https://blog.jiascu.top/2022/03/03/else/","excerpt":"","text":"getã€postè¯·æ±‚åŒºåˆ« getï¼šæŸ¥è¯¢ã€æœç´¢ postï¼š æ›´æ–° ç™»å½•æ³¨å†Œç­‰è¡¨å• å¯¹äºåšå®¢ã€è®ºå›ã€æ•°æ®çš„ä¸Šä¼ ä¸‹è½½ æŒ‚è½½åˆ°æœåŠ¡å™¨ä¸Š clean package æ•°æ®åº“ã€JDBCã€æ•°æ®åº“è¿æ¥æ± çš„åŒºåˆ« **&#x3D;&#x3D;JDBC(Java Database Connectivity)&#x3D;&#x3D;**ï¼š javaå’Œæ•°æ®åº“çš„è¿æ¥æŠ€æœ¯ï¼Œsunå…¬å¸æ¨å‡ºçš„ä¸€å¥—javaåº”ç”¨ç¨‹åºè®¿é—®æ•°æ®åº“çš„æŠ€æœ¯è§„èŒƒã€‚ æ•°æ®åº“è¿æ¥æ±  Druidã€hikariï¼šæ™®é€šçš„JDBCæ•°æ®åº“è¿æ¥ä½¿ç”¨ DriverManager æ¥è·å–,ä½†æ˜¯ä¼šå‡ºç°å¾ˆå¤šé—®é¢˜ã€‚ä¸ºäº†è§£å†³ä¼ ç»Ÿå¼€å‘ä¸­æ•°æ®åº“çš„è¿æ¥é—®é¢˜ï¼Œä½¿ç”¨&#x3D;&#x3D;æ•°æ®åº“è¿æ¥æ± è´Ÿè´£åˆ†é…ã€ç®¡ç†å’Œé‡Šæ”¾æ•°æ®åº“è¿æ¥&#x3D;&#x3D;","categories":[],"tags":[]},{"title":"IDEAå¿«æ·é”®","slug":"å¿«æ·é”®","date":"2022-03-03T13:47:51.624Z","updated":"2022-03-04T03:36:13.789Z","comments":true,"path":"2022/03/03/å¿«æ·é”®/","link":"","permalink":"https://blog.jiascu.top/2022/03/03/%E5%BF%AB%E6%8D%B7%E9%94%AE/","excerpt":"","text":"IDEAå¿«æ·é”® é‡å†™æ–¹æ³•ï¼š alt + insert ç„¶åç‚¹å‡»override ctrl + o alt + enter å¼•å…¥å±€éƒ¨å˜é‡ éå†å¿«æ·é”®ï¼šå˜é‡.for(i) ä¾‹å¦‚ï¼š 1Cookies.forio ifå¿«æ·é”®ï¼šå˜é‡.if mainå‡½æ•°å¿«æ·é”®ï¼špsvm 1public static void main(String[] args) &#123;&#125; å®šä¹‰ç±»æ—¶ï¼Œ è‡ªåŠ¨ç”Ÿæˆgetå’Œsetæ–¹æ³•ï¼šalt + insert ç„¶åç‚¹å‡»Getter and Setter è‡ªåŠ¨ç”Ÿæˆæ„é€ æ–¹æ³•ï¼šalt + insert ç„¶åç‚¹å‡»Constructor é‡å†™toSringæ–¹æ³•ï¼šalt + insert ç„¶åç‚¹å‡»tostring jspä»£ç æ³¨é‡Šä¸é¡¶å¤´å†™ï¼šctrl + shift + &#x2F; è¿è¡Œjavaæ–‡ä»¶å¿«æ·é”®ï¼šctrl + shift +F10 Tab &#x2F; Shift + Tab ï¼š ç¼©è¿›ä¸€æ¬¡æ‰€é€‰æ‹©çš„ä»£ç æ®µ Tab ï¼šå³ç¼©è¿› Shift + Tab ï¼š å·¦ç¼©è¿› å¿«é€Ÿæå–æ–¹æ³•ï¼šCtrl + Alt + M ï¼ˆé¼ æ ‡å³å‡» ã€‹Refactor ã€‹Extract ã€‹Methodï¼‰ soutç­‰ä»·äºï¼š 1System.out.println(); ä¹Ÿèƒ½é€šè¿‡ .sout ä½¿ç”¨ ctrl+f : æ–‡æ¡£ä¸­æœç´¢ ctrl+rï¼šæ–‡æ¡£ä¸­æ›¿æ¢ åŒå‡»shiftï¼šå…¨å±€æœç´¢ç±»ã€æ–‡ä»¶ç­‰ ctrl+shift+altï¼šå¤šè¡Œé€‰ä¸­ä¿®æ”¹ ideaæ ¼å¼åŒ–ä»£ç å¿«æ·é”®ï¼š å»æ‰ç©ºç™½ï¼š Ctrl + Shift + J æ ¼å¼åŒ–ä»£ç ï¼š Ctrl + Alt + Lï¼ˆä¸QQå¿«æ·é”®å†²çªï¼Œå»ºè®®ä¿®æ”¹ï¼Œæˆ–ä½¿ç”¨æ—¶å…³é—­QQï¼‰ åœ¨æŸä¸€æ–‡ä»¶å¤¹è¿…é€Ÿè¿è¡Œcmdå‘½ä»¤ï¼šè·¯å¾„ä¸Šæ“ä½œï¼šè·¯å¾„å‰é¢åŠ ä¸Šcmd ç›´æ¥è¿è¡Œ å¤§å°å†™è½¬æ¢ï¼šctr + shift + u å‡½æ•°æ–¹æ³•æ·»åŠ æ³¨é‡Šï¼šè‡ªåŠ¨ç»™IDEAç±»å’Œæ–¹æ³•æ·»åŠ æ³¨é‡Šï¼ˆå°ç™½å®Œç¾ç‰ˆï¼‰ - çŸ¥ä¹ (zhihu.com) ä½¿ç”¨æ–¹æ³•ï¼šé¦–å…ˆæ–°å»ºä¸€ä¸ªæ–¹æ³•ï¼Œç„¶ååœ¨æ–¹æ³•çš„ä¸Šæ–¹è¾“å…¥/**ï¼ŒæŒ‰å›è½¦Enterï¼Œå³å¯è‡ªåŠ¨ç”Ÿæˆæ³¨é‡Šä¿¡æ¯ try-catch-finallyå¿«æ·é”®ï¼š é»˜è®¤ï¼šctrl + alt +T(å†²çª) å»ºè®®ä¿®æ”¹ä¸ºalt +T","categories":[],"tags":[]},{"title":"æ³¨è§£","slug":"æ³¨è§£","date":"2022-03-03T13:47:43.108Z","updated":"2022-03-04T03:36:32.134Z","comments":true,"path":"2022/03/03/æ³¨è§£/","link":"","permalink":"https://blog.jiascu.top/2022/03/03/%E6%B3%A8%E8%A7%A3/","excerpt":"","text":"springmvc123456789101112@Controller : ä»£è¡¨è¿™ä¸ªç±»ä¼šè¢«Springæ¥ç®¡ è¢«è¿™ä¸ªæ³¨è§£çš„ç±»ä¸­æ‰€æœ‰æ–¹æ³•ï¼Œå¦‚æœè¿”å›å€¼æ˜¯Stringï¼Œå¹¶ä¸”æœ‰å…·ä½“é¡µé¢å¯ä»¥è·³è½¬ï¼Œé‚£ä¹ˆå°±ä¼šè¢«è§†å›¾è§£æå™¨è§£æ @RequestMapping(&quot;/t3&quot;)ï¼šè¯·æ±‚æ˜ å°„ @GetMappingï¼šgetæ–¹æ³• @PostMappingï¼špostæ–¹æ³• @PutMapping @DeleteMapping @PatchMapping@PathVariable : è®©æ–¹æ³•å‚æ•°çš„å€¼å¯¹åº”ç»‘åˆ°ä¸€ä¸ªURLæ¨¡æ¿å˜é‡ä¸Š@RequestParam(&quot;username&quot;)ï¼šå‰ç«¯è¯·æ±‚çš„å‚æ•°å@ResponseBody//å®ƒä¸ä¼šèµ°è§†å›¾è§£æå™¨ã€‚ä¼šç›´æ¥è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²@RestControllerï¼š@Controller + @ResponseBody spring @Autowiredï¼šè‡ªåŠ¨æ³¨å…¥ï¼Œé¦–å…ˆæŒ‰ç±»å‹æ³¨å…¥ï¼Œå¦‚æœåªæœ‰ä¸€ä¸ªåˆ™æˆåŠŸï¼›å¦‚æœæ˜¯å¤šä¸ªï¼Œå†æŒ‰ç…§åç§°ï¼ˆç±»é¦–å­—æ¯å°å†™ï¼‰æ³¨å…¥ï¼Œæ‰¾åˆ°äº†æˆåŠŸï¼Œå¦åˆ™å¤±è´¥ @Qualifierï¼š@Autowiredæ˜¯æ ¹æ®ç±»å‹è‡ªåŠ¨è£…é…çš„ï¼ŒåŠ ä¸Š@Qualifieråˆ™å¯ä»¥æ ¹æ®byNameçš„æ–¹å¼è‡ªåŠ¨è£…é… @Resourceï¼šè‡ªåŠ¨è£…é…é€šè¿‡åå­—ã€ç±»å‹ï¼Œä½¿ç”¨æ—¶éœ€å…ˆå¯¼åŒ… @Nullableï¼šæ ‡è®°å­—æ®µï¼Œè¯´æ˜è¯¥å­—æ®µå¯ä»¥ä¸ºnull beanæ³¨å…¥ï¼šæ”¾åœ¨ç±»ä¸Šï¼Œè¯´æ˜è¿™ä¸ªç±»è¢«Springç®¡ç†äº†ï¼Œå°±æ˜¯bean â€‹ ç›¸å½“äºï¼š @Componentï¼šç»„ä»¶ï¼Œæ”¾åœ¨pojoï¼ˆå®ä½“ç±»ä¸Šï¼‰ @Controllerï¼šwebå±‚ @Serviceï¼šserviceå±‚ @Repositoryï¼šdaoå±‚ @valueï¼šå±æ€§æ³¨å…¥ï¼Œå¯åœ¨å®šä¹‰å˜é‡ä¸Šæ–¹å’Œsetæ–¹æ³•ä¸Šæ–¹æ³¨å…¥ï¼Œè¡¨ç¤ºä¸ºè¯¥å±æ€§èµ‹å€¼ â€‹ ç›¸å½“äºï¼š @scopeï¼šä½œç”¨åŸŸï¼ŒåŒ…æ‹¬singletonå’Œprototypeç­‰ singletonï¼šé»˜è®¤çš„ï¼ŒSpringä¼šé‡‡ç”¨å•ä¾‹æ¨¡å¼åˆ›å»ºè¿™ä¸ªå¯¹è±¡ã€‚å…³é—­å·¥å‚ ï¼Œæ‰€æœ‰çš„å¯¹è±¡éƒ½ä¼šé”€æ¯ã€‚ prototypeï¼šå¤šä¾‹æ¨¡å¼ã€‚å…³é—­å·¥å‚ ï¼Œæ‰€æœ‰çš„å¯¹è±¡ä¸ä¼šé”€æ¯ã€‚å†…éƒ¨çš„åƒåœ¾å›æ”¶æœºåˆ¶ä¼šå›æ”¶ @Configuration: 12//è¿™ä¸ªä¹Ÿä¼šè¢«Springå®¹å™¨æ‰˜ç®¡ï¼Œæ³¨å†Œåˆ°å®¹å™¨ä¸­ï¼Œå› ä¸ºä»–æœ¬èº«å°±æ˜¯ä¸€ä¸ª@Componentï¼Œ// @Configurationä»£è¡¨è¿™æ˜¯ä¸€ä¸ªé…ç½®ç±» ï¼Œå°±å’Œæˆ‘ä»¬ä¹‹å‰çœ‹åˆ°çš„beans.xml @Import(KuangConfig2.class) 1å¯¼å…¥åˆ«çš„é…ç½®æ–‡ä»¶ï¼ˆä½¿ç”¨äº†æ³¨è§£@Configuration:ï¼‰ @ComponentScan(â€œcom.kuangâ€) 12//æ‰«æç»„ä»¶ï¼Œç›¸å½“äºxmlæ–‡ä»¶ä¸­çš„ &lt;context:component-scan base-package=&quot;com.kuang&quot;/&gt; @Bean: 123//æ³¨å†Œä¸€ä¸ªBeanï¼Œå°±åƒä½†ä¸æˆ‘ä»¬ä¹‹å‰å†™çš„ä¸€ä¸ªbeanæ ‡ç­¾//è¿™ä¸ªæ–¹æ³•çš„åå­—ï¼Œå°±ç›¸å½“äºbeanæ ‡ç­¾ä¸­çš„idå±æ€§//è¿™ä¸ªæ–¹æ³•çš„è¿”å›å€¼ï¼Œå°±ç›¸å½“äºbeanæ ‡ç­¾ä¸­çš„classå±æ€§ springboot @ConfigurationProperties(prefix = &quot;person&quot;) 123456789 å°†é…ç½®æ–‡ä»¶ä¸­é…ç½®çš„æ¯ä¸€ä¸ªå±æ€§çš„å€¼ï¼Œæ˜ å°„åˆ°è¿™ä¸ªç»„ä»¶ä¸­ï¼› å‘Šè¯‰SpringBootå°†æœ¬ç±»ä¸­çš„æ‰€æœ‰å±æ€§å’Œé…ç½®æ–‡ä»¶ä¸­ç›¸å…³çš„é…ç½®è¿›è¡Œç»‘å®š å‚æ•° prefix = â€œpersonâ€ : å°†é…ç½®æ–‡ä»¶ä¸­çš„personä¸‹é¢çš„æ‰€æœ‰å±æ€§ä¸€ä¸€å¯¹åº”- ```java @Validated //æ•°æ®æ ¡éªŒ @Email(message=&quot;é‚®ç®±æ ¼å¼é”™è¯¯&quot;) 1234567891011121314151617181920212223242526272829303132 é…åˆ@Validatedä½¿ç”¨ï¼Œåœ¨å­—æ®µä¸Šä½¿ç”¨ï¼Œè¦æ±‚å…¶å¿…é¡»ä¸ºé‚®ä»¶æ ¼å¼ï¼Œå¦åˆ™æŠ¥é”™ï¼ˆé‚®ç®±æ ¼å¼é”™è¯¯ï¼‰- jsr303æ£€éªŒ ```java @NotNull(message=&quot;åå­—ä¸èƒ½ä¸ºç©º&quot;) private String userName;get @Max(value=120,message=&quot;å¹´é¾„æœ€å¤§ä¸èƒ½æŸ¥è¿‡120&quot;) private int age; @Email(message=&quot;é‚®ç®±æ ¼å¼é”™è¯¯&quot;) private String email; ç©ºæ£€æŸ¥ @Null éªŒè¯å¯¹è±¡æ˜¯å¦ä¸ºnull @NotNull éªŒè¯å¯¹è±¡æ˜¯å¦ä¸ä¸ºnull, æ— æ³•æŸ¥æ£€é•¿åº¦ä¸º0çš„å­—ç¬¦ä¸² @NotBlank æ£€æŸ¥çº¦æŸå­—ç¬¦ä¸²æ˜¯ä¸æ˜¯Nullè¿˜æœ‰è¢«Trimçš„é•¿åº¦æ˜¯å¦å¤§äº0,åªå¯¹å­—ç¬¦ä¸²,ä¸”ä¼šå»æ‰å‰åç©ºæ ¼. @NotEmpty æ£€æŸ¥çº¦æŸå…ƒç´ æ˜¯å¦ä¸ºNULLæˆ–è€…æ˜¯EMPTY. Booelanæ£€æŸ¥ @AssertTrue éªŒè¯ Boolean å¯¹è±¡æ˜¯å¦ä¸º true @AssertFalse éªŒè¯ Boolean å¯¹è±¡æ˜¯å¦ä¸º false é•¿åº¦æ£€æŸ¥ @Size(min=, max=) éªŒè¯å¯¹è±¡ï¼ˆArray,Collection,Map,Stringï¼‰é•¿åº¦æ˜¯å¦åœ¨ç»™å®šçš„èŒƒå›´ä¹‹å†… @Length(min=, max=) string is between min and max included. æ—¥æœŸæ£€æŸ¥ @Past éªŒè¯ Date å’Œ Calendar å¯¹è±¡æ˜¯å¦åœ¨å½“å‰æ—¶é—´ä¹‹å‰ @Future éªŒè¯ Date å’Œ Calendar å¯¹è±¡æ˜¯å¦åœ¨å½“å‰æ—¶é—´ä¹‹å @Pattern(value) éªŒè¯ String å¯¹è±¡æ˜¯å¦ç¬¦åˆæ­£åˆ™è¡¨è¾¾å¼çš„è§„åˆ™ @Repository else å®ç°å¼‚æ­¥ @Asyncï¼šåœ¨æ–¹æ³•ä¸ŠåŠ ï¼Œå‘Šè¯‰springè¿™æ˜¯ä¸€ä¸ªå¼‚æ­¥çš„æ–¹æ³• @EnableAsyncï¼šåœ¨SpringbootApplicationä¸Šé¢åŠ ï¼Œå¼€å¯å¼‚æ­¥æ³¨è§£åŠŸèƒ½ å®šæ—¶æ‰§è¡Œä»»åŠ¡ @Scheduledï¼ˆï¼‰ï¼šåœ¨æ–¹æ³•ä¸ŠåŠ ï¼Œä½¿ç”¨cronè¡¨è¾¾å¼ cronè¡¨è¾¾å¼ï¼š ç§’ åˆ† æ—¶ æ—¥ æœˆ å‘¨å‡  @Scheduled(cron &#x3D; â€œ0 * * * * 0-7â€)ï¼šæ¯å¤©ä»»ä½•æ—¶å€™çš„ç¬¬0ç§’ å¯åœ¨çº¿ç”Ÿæˆ @EnableSchedulingï¼šåœ¨SpringbootApplicationä¸Šé¢åŠ ï¼Œå¼€å¯å®šæ—¶åŠŸèƒ½çš„æ³¨è§£","categories":[],"tags":[]},{"title":"Hello World","slug":"hello-world","date":"2022-03-03T12:52:23.253Z","updated":"2022-03-03T12:52:23.253Z","comments":true,"path":"2022/03/03/hello-world/","link":"","permalink":"https://blog.jiascu.top/2022/03/03/hello-world/","excerpt":"","text":"Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub. Quick StartCreate a new post1$ hexo new &quot;My New Post&quot; More info: Writing Run server1$ hexo server More info: Server Generate static files1$ hexo generate More info: Generating Deploy to remote sites1$ hexo deploy More info: Deployment","categories":[],"tags":[]}],"categories":[],"tags":[]}